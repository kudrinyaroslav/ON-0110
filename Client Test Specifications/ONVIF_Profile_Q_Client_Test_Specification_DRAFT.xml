<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- 
For online publishing use:
<?xml-stylesheet type="text/xsl" 
href="http://docs.oasis-open.org/templates/DocBook/spec-0.5/stylesheets/oasis-specification-html.xsl"?>
<!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" 

For offline publishing use:
<?xml-stylesheet type="text/xsl" 
href="file:///c:/oasis/spec-0.5/stylesheets/oasis-specification-html-offline.xsl"?>
<!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"file:///c:/oasis/spec-0.5/docbook/docbookx.dtd" 
-->
<?xml-stylesheet type="text/xsl" 
    href="http://docs.oasis-open.org/templates/DocBook/spec-0.5/stylesheets/oasis-specification-html.xsl"?>
<!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">

<article>
<articleinfo>
        <title>ONVIF Profile Q Client Test Specification</title>
        <subtitle>Version 16.01 January, 2016</subtitle>
        <productname>ONVIF Profile Q Client Test Specification</productname>
        <productnumber>Version 16.01 January, 2016</productnumber>
        <copyright>
            <year>2015</year>
            <holder>ONVIF, Inc. All rights reserved. www.onvif.org</holder>
        </copyright>
        <legalnotice role="notices">
            <para>Recipients of this document may copy, distribute, publish, or display this
                document so long as this copyright notice, license and disclaimer are retained with
                all copies of the document. No license is granted to modify this document.</para>
            <para>THIS DOCUMENT IS PROVIDED "AS IS," AND THE CORPORATION AND ITS MEMBERS AND THEIR
                AFFILIATES, MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT
                NOT LIMITED TO, WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
                NON-INFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THIS DOCUMENT ARE SUITABLE FOR ANY
                PURPOSE; OR THAT THE IMPLEMENTATION OF SUCH CONTENTS WILL NOT INFRINGE ANY PATENTS,
                COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS.</para>
            <para>IN NO EVENT WILL THE CORPORATION OR ITS MEMBERS OR THEIR AFFILIATES BE LIABLE FOR
                ANY DIRECT, INDIRECT, SPECIAL, INCIDENTAL, PUNITIVE OR CONSEQUENTIAL DAMAGES,
                ARISING OUT OF OR RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT, WHETHER OR
                NOT (1) THE CORPORATION, MEMBERS OR THEIR AFFILIATES HAVE BEEN ADVISED OF THE
                POSSIBILITY OF SUCH DAMAGES, OR (2) SUCH DAMAGES WERE REASONABLY FORESEEABLE, AND
                ARISING OUT OF OR RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT. THE
                FOREGOING DISCLAIMER AND LIMITATION ON LIABILITY DO NOT APPLY TO, INVALIDATE, OR
                LIMIT REPRESENTATIONS AND WARRANTIES MADE BY THE MEMBERS AND THEIR RESPECTIVE
                AFFILIATES TO THE CORPORATION AND OTHER MEMBERS IN CERTAIN WRITTEN POLICIES OF THE
                CORPORATION.</para>
        </legalnotice>
    </articleinfo>

<section id="s.intro">
<title>Introduction</title>

    <para>The goal of the ONVIF Test Specification set is to make it possible to realize fully
            interoperable IP physical security implementations from different vendors. This
            specification also acts as an input document to the development of a test tool which
            will be used to test the ONVIF Client implementation conformance towards ONVIF standard.
            This Client Test Tool analyzes network communications between ONVIF Devices and Clients
            being tested and determines whether a specific Client is ONVIF conformant (see ONVIF
            Conformance Process Specification).</para>
    <para>This particular document defines test cases required for testing Profile Q features of a
            Client application e.g. Transition to Operational State. It also describes the test framework, test setup,
            prerequisites, test policies needed for the execution of the described test
            cases.</para>

<section id="s.scope">
<title>Scope</title>
    
    <para>This ONVIF Profile Q Client Test Specification defines and regulates the conformance
                testing procedure for the ONVIF conformant Clients in the scope of Profile Q
                features. Conformance testing is meant to be black-box network traces analysis and
                verification. The objective of this specification is to provide the test cases to
                test individual requirements of ONVIF Clients in the scope of Profile Q features
                according to ONVIF Profile Specifications.</para>
    <para>The principal intended purposes are:<itemizedlist>
                    <listitem>
                        <para>Provide self-assessment tool for implementations.</para>
                    </listitem>
                    <listitem>
                        <para>Provide comprehensive test suite coverage for Profile Q
                            features.</para>
                    </listitem>
                </itemizedlist></para>
            <para>This specification <emphasis role="bold">does not</emphasis> address the following:<itemizedlist>
                    <listitem>
                        <para>3rd parties Client use cases</para>
                    </listitem>
                    <listitem>
                        <para>Non-functional (performance and regression) testing and
                            analysis.</para>
                    </listitem>
                    <listitem>
                        <para>SOAP Implementation Interoperability test i.e. Web Services
                            Interoperability Basic Profile version 2.0 (WS-I BP2.0).</para>
                    </listitem>
                    <listitem>
                        <para>Network protocol implementation Conformance test for HTTPS and HTTP
                            protocols.</para>
                    </listitem>
                </itemizedlist></para>
            <para>The following sections cover test cases needed for the verification of relevant
                features as mentioned in the ONVIF Profile Specifications.</para>
</section>

<section>
  <title>Transition to Operational State</title>
    <para>Transition to Operational State section specifies Client ability to transit an ONVIF Device from Factory Default State into Operational State.</para>
</section>
</section>
    <section id="s.docbook">
        <title>Normative references</title>
        <para>ONVIF Conformance Process Specification:</para>
        <para><ulink url="http://www.onvif.org/Documents/Specifications.aspx"/></para>
        <para>ONVIF Profile Policy:</para>
        <para><ulink url="http://www.onvif.org/Documents/Specifications.aspx"/></para>
        <para>ONVIF Core Specifications:</para>
        <para><ulink url="http://www.onvif.org/Documents/Specifications.aspx"/></para>
        <para>ONVIF Core Client Test Specification:</para>
        <para><ulink url="http://www.onvif.org/Documents/Specifications.aspx"/></para>
        <para>ONVIF Profile C Specification version 1.0, Dec 2013:</para>
        <para><ulink url="http://www.onvif.org/Documents/Specifications.aspx"/></para>
        <para>ONVIF Access Control Specification:</para>
        <para><ulink url="http://www.onvif.org/Documents/Specifications.aspx"/></para>
        <para>ONVIF Door Control Specification:</para>
        <para><ulink url="http://www.onvif.org/Documents/Specifications.aspx"/></para>
        <para>ISO/IEC Directives, Part 2:</para>
        <para><ulink url="www.iso.org/directives"/></para>
        <para>Rules for the structure and drafting of International Standards, Annex H: Verbal forms
            for the expression of provisions.</para>
    </section>
    <section id="additions">
        <title>Terms and Definitions</title>
        <section>
            <title>Conventions</title>
            <para>The key words "shall", "shall not", "should", "should not", "may", "need not",
                "can", "cannot" in this specification are to be interpreted as described in [ISO/IEC
                Directives Part 2].</para>
        </section>
        <section>
            <title>Definitions</title>
            <para>This section describes terms and definitions used in this document.</para>
            <variablelist>
                <varlistentry>
                    <term>Profile</term>
                    <listitem>
                        <para>See ONVIF Profile Policy.</para>
                    </listitem>
                </varlistentry>
            </variablelist>
            <variablelist>
                <varlistentry>
                    <term>Profile Q</term>
                    <listitem>
                        <para>The Profile Q Specification.</para>
                    </listitem>
                </varlistentry>
            </variablelist>
            <variablelist>
                <varlistentry>
                    <term>ONVIF Device</term>
                    <listitem>
                        <para>Computer appliance or software program that exposes one or multiple
                            ONVIF Web Services.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>ONVIF Client</term>
                    <listitem>
                        <para>Computer appliance or software program that uses ONVIF Web
                            Services.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Conversation</term>
                    <listitem>
                        <para>A Conversation is all exchanges between two MAC addresses that
                            contains SOAP request and response.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Network</term>
                    <listitem>
                        <para>A network is an interconnected group of devices communicating using
                            the Internet protocol.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Network Trace Capture file</term>
                    <listitem>
                        <para>Data file created by a network protocol analyzer software (such as
                            Wireshark). Contains network packets data recorded during a live network
                            communications.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>SOAP</term>
                    <listitem>
                        <para>SOAP is a lightweight protocol intended for exchanging structured
                            information in a decentralized, distributed environment. It uses XML
                            technologies to define an extensible messaging framework providing a
                            message construct that can be exchanged over a variety of underlying
                            protocols.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Client Test Tool</term>
                    <listitem>
                        <para>ONVIF Client Test Tool that tests ONVIF Client implementation towards
                            the ONVIF Test Specification set.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Factory Default State</term>
                    <listitem>
                        <para>The state of the Profile Q device prior to setting an Administrator 
                              password.</para>
                    </listitem>
                </varlistentry>
                 <varlistentry>
                    <term>Operational State</term>
                    <listitem>
                        <para>In this state, the device accepts any commands without authentication. 
                              The state of the Profile Q device after setting an Administrator password.
                              The device requires an authentication according to its access policy to 
                              accept commands.</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </section>
        <section>
            <title>Abbreviations</title>
            <para>This section describes abbreviations used in this document.</para>
            <variablelist>
                <varlistentry>
                    <term>HTTP</term>
                    <listitem>
                        <para>Hyper Text Transport Protocol.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>HTTPS</term>
                    <listitem>
                        <para>Hyper Text Transport Protocol over Secure Socket Layer.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>URI</term>
                    <listitem>
                        <para>Uniform Resource Identifier.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>WSDL</term>
                    <listitem>
                        <para>Web Services Description Language.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>XML</term>
                    <listitem>
                        <para>eXtensible Markup Language.</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </section>
    </section>
    <section>
        <title>Test Overview</title>
        <para>This section provides information for the test setup procedure and required
            prerequisites that should be followed during test case execution.</para>
        <para>An ONVIF Client conformant to Profile Q is an ONVIF Client that can move
              an ONVIF Device conformant to Profile Q into Operational State.
        </para>
        <para>An ONVIF Profile is described by a fixed set of functionalities through a number of
            services that are provided by the ONVIF standard. A number of services and
            functionalities are mandatory for each type of ONVIF Profile. An ONVIF Device and ONVIF
            Client may support any combination of Profiles and other optional services and
            functionalities.</para>
        <section>
            <title>Test Setup</title>
            <para>Collect Network Traces files required by the test cases.</para>
            <para>Collect Feature List XML files for Devices detected in the Network Trace
                files.</para>
            <para>Client shall support all mandatory and conditional features listed in the Device
                Feature List XML file supplied for the Profiles supported by the Client.</para>
            <para>For compatibility with the Profile C, the ONVIF Client shall follow the
                requirements of the conformance process. For details please see the latest ONVIF
                Conformance Process Specification.</para>
        </section>
        <section>
            <title>Prerequisites</title>
            <para>The pre-requisites for executing the test cases described in this Test
                Specification include:</para>
            <para>The Device shall be configured with an IPv4 address.</para>
            <para>The Device shall be able to be discovered by the Client.</para>
        </section>
    </section>
    <section id="s.conformance">
        <title>Transition to Operational State Test Cases</title>
        <section>
            <title>Expected Scenarios Under Test:</title>            
            <para>
                <orderedlist>
                    <listitem>
                        <para>Client connects to Device in Factory Default sate to move it into Operational State. </para>
                    </listitem>
                    <listitem>
                        <para>Client is considered as supporting Transition to Operational State if the
                            following conditions are met:<itemizedlist>
                                <listitem>
                                    <para>Client is able to move device into Operational State by using EITHER CreateUsers OR SetUser operations.</para>
                                </listitem>                                                                
                            </itemizedlist></para>
                    </listitem>
                    <listitem>
                        <para>Client is considered as NOT supporting Transition to Operational State if
                            ANY of the following is TRUE:<itemizedlist>
                                <listitem>
                                    <para>No valid response to CreateUsers request OR</para>
                                </listitem>                                
                                <listitem>
                                    <para>No valid response to SetUser request.</para>
                                </listitem>
                            </itemizedlist></para>
                    </listitem>
                </orderedlist>
            </para>
        </section>
        <section>
            <title><emphasis role="italic">TRANSITION TO OPERATIONAL STATE BY CREATEUSERS</emphasis></title>
            <para><emphasis role="bold">Test Label:</emphasis> Transition to Operational State by Create User</para>
            <para><emphasis role="bold">Test Case ID:</emphasis> TRANSITIONTOOPERATIONALSTATE-1</para>
            <para><emphasis role="bold">Profile Q Requirement:</emphasis> Mandatory</para>
            <para><emphasis role="bold">Feature Under Test:</emphasis> Transition to Operational State</para>
            <para><emphasis role="bold">Test Purpose:</emphasis> To verify that Client is able to move device into Operational State using the
                CreateUsers.</para>
            <para><emphasis role="bold">Pre-Requisite:</emphasis><itemizedlist>
                    <listitem>
                        <para>The Network Trace Capture files contains at least one Conversation
                            between Client and Device in Factory Default state with CreateUsers operation 
                            present.</para>
                    </listitem>
                </itemizedlist></para>
            <para><emphasis role="bold">Test Procedure (expected to be reflected in network trace
                    file):</emphasis><orderedlist>
                    <listitem>
                        <para>Client invokes CreateUsers request message with Administrator UserLevel without any authentication.</para>
                    </listitem>
                    <listitem>
                        <para>Device responses with code HTTP 200 OK and
                            CreateUsersResponse message.</para>
                    </listitem>
                </orderedlist></para>
            <para><emphasis role="bold">Test Result:</emphasis></para>
            <literallayout class="normal"><emphasis role="bold">PASS -</emphasis>
Client CreateUsers request message is a well-formed SOAP request (refer to onvif.xsd) AND
Client CreateUsers request message has a proper hierarchy (refer to devicemgmt.wsdl) AND
[S1] Client request does not contain digest authentication part AND
[S2] Client request does not contain WS-username token authentication part AND
[S3] Client request contains "&lt;CreateUsers>" tag after the "&lt;Body>" tag  AND
    [S4] "&lt;CreateUsers>" includes tag: "&lt;User>" AND
    [S5] "&lt;User>" includes tag: "&lt;Username>" with non-empty string value AND
    [S6] "&lt;User>" includes tag: "&lt;Password>" with non-empty string value AND
    [S7] "&lt;User>" includes tag: "&lt;UserLevel>" with value equals to "Administrator" AND
[S8] Device response contains "HTTP/* 200 OK" AND
[S9] Device response contains "&lt;CreateUsersResponse>" tag.</literallayout>
            <literallayout class="normal"><emphasis role="bold">FAIL -</emphasis>
The Client failed PASS criteria.</literallayout>
            <para><emphasis role="bold">Validated Feature List:
                </emphasis>TransitionToOperationalState_CreateUsers</para>
        </section>      
        <section>
            <title><emphasis role="italic">TRANSITION TO OPERATIONAL STATE BY SET USER</emphasis></title>
            <para><emphasis role="bold">Test Label:</emphasis> Transition to Operational State by Set User</para>
            <para><emphasis role="bold">Test Case ID:</emphasis> TRANSITIONTOOPERATIONALSTATE-2</para>
            <para><emphasis role="bold">Profile Q Requirement:</emphasis> Mandatory</para>
            <para><emphasis role="bold">Feature Under Test:</emphasis> Transition to Operational State</para>
            <para><emphasis role="bold">Test Purpose:</emphasis> To verify that Client is able to move device into Operational State using the
                SetUser.</para>
            <para><emphasis role="bold">Pre-Requisite:</emphasis><itemizedlist>
                    <listitem>
                        <para>The Network Trace Capture files contains at least one Conversation
                            between Client and Device in Factory Default state with SetUser operation 
                            present.</para>
                    </listitem>
                </itemizedlist></para>
            <para><emphasis role="bold">Test Procedure (expected to be reflected in network trace
                    file):</emphasis><orderedlist>
                    <listitem>
                        <para>Client invokes SetUser request message with Administrator UserLevel without any authentication.</para>
                    </listitem>                    
                    <listitem>
                        <para>Device responses with code HTTP 200 OK and
                            CreateUsersResponse message.</para>
                    </listitem>
                </orderedlist></para>
            <para><emphasis role="bold">Test Result:</emphasis></para>
            <literallayout class="normal"><emphasis role="bold">PASS -</emphasis>
Client SetUser request message is a well-formed SOAP request (refer to onvif.xsd) AND
Client SetUser request message has a proper hierarchy (refer to devicemgmt.wsdl) AND
[S1] Client request does not contain digest authentication part AND
[S2] Client request does not contain WS-username token authentication part AND
[S3] Client request contains "&lt;SetUser>" tag after the "&lt;Body>" tag  AND
    [S4] "&lt;SetUser>" includes tag: "&lt;User>" AND
    [S5] "&lt;User>" includes tag: "&lt;Username>" with non-empty string value AND
    [S6] "&lt;User>" includes tag: "&lt;Password>" with non-empty string value AND
    [S7] "&lt;User>" includes tag: "&lt;UserLevel>" with value equals to "Administrator" AND
[S8] Device response contains "HTTP/* 200 OK" AND
[S9] Device response contains "&lt;SetUserResponse>" tag.</literallayout>
            <literallayout class="normal"><emphasis role="bold">FAIL -</emphasis>
The Client failed PASS criteria.
</literallayout>
            <literallayout class="normal"><emphasis role="bold">FAIL -</emphasis>
The Client failed PASS criteria.</literallayout>
            <para><emphasis role="bold">Validated Feature List:
                </emphasis>TransitionToOperationalState_SetUser</para>
        </section>         
    </section>
    
    
	
	
  <appendix id="changes">
    <title>Revision History</title>
        <para><emphasis role="bold">September 25, 2016 Version 16.01</emphasis><itemizedlist>
                <listitem>
                    <para>Initial version.</para>
                </listitem>
            </itemizedlist></para>        
  </appendix>
</article>
