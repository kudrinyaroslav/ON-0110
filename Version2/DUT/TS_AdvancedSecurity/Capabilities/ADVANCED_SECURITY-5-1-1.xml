<?xml version="1.0" encoding="utf-8"?>
<TestSuit Name="Device Management" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>ADVANCED_SECURITY-5-1-1 Advanced Security Service Capabilities</Name>
    <Description>
      To verify >Advanced Security Service Capabilities of the DUT
    </Description>
  </Parameters>
  <!--General-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.010" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response</Name>
    <Description>

    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="12" MaximumNumberOfCertificates="12" MaximumNumberOfCertificationPaths="12" RSAKeyPairGeneration="true" PKCS8RSAKeyPairUpload="true" PKCS12CertificateWithRSAPrivateKeyUpload="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="1 3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0 2" MaximumNumberOfTLSCertificationPaths="12"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.011" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response</Name>
    <Description>
      PKCS8RSAKeyPairUpload="false"
      PKCS12CertificateWithRSAPrivateKeyUpload="false"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="12" MaximumNumberOfCertificates="12" MaximumNumberOfCertificationPaths="12" RSAKeyPairGeneration="true" PKCS8RSAKeyPairUpload="false" PKCS12CertificateWithRSAPrivateKeyUpload="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="1 3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0 2" MaximumNumberOfTLSCertificationPaths="12"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.012" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response</Name>
    <Description>

    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="12" MaximumNumberOfCertificates="12" MaximumNumberOfCertificationPaths="12" RSAKeyPairGeneration="false" PKCS8RSAKeyPairUpload="true" PKCS12CertificateWithRSAPrivateKeyUpload="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="1 3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0 2" MaximumNumberOfTLSCertificationPaths="12"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.013" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response</Name>
    <Description>

    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="12" MaximumNumberOfCertificates="12" MaximumNumberOfCertificationPaths="12" RSAKeyPairGeneration="false" PKCS8RSAKeyPairUpload="false" PKCS12CertificateWithRSAPrivateKeyUpload="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="1 3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0 2" MaximumNumberOfTLSCertificationPaths="12"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  
  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.02" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: skip all checks</Name>
    <Description>
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped
      RSAKeyPairGeneration = false
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.03" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities with skipped parameters</TestName>
    <Name>Correct response: skip all checks</Name>
    <Description>
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths  skipped
      RSAKeyPairGeneration  skipped
      PKCS10ExternalCertificationWithRSA  skipped
      SelfSignedCertificateCreationWithRSA  skipped
      TLSServerSupported  skipped
      MaximumNumberOfTLSCertificationPaths  skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--First check: cap.KeystoreCapabilities.MaximumNumberOfCertificates > 0-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.04" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: first check passed, other skipped</Name>
    <Description>
      MaximumNumberOfCertificates = 1
      MaximumNumberOfKeys = 1

      MaximumNumberOfCertificationPaths skipped
      RSAKeyPairGeneration = false
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.05" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: first check faild 1, other skipped</Name>
    <Description>
      MaximumNumberOfCertificates = 1
      MaximumNumberOfKeys skipped

      MaximumNumberOfCertificationPaths skipped
      RSAKeyPairGeneration = false
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificates="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Second check: cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths > 0-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.07" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: second check passed, next skipped</Name>
    <Description>
      
      MaximumNumberOfKeys = 2

      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1

      RSAKeyPairGeneration = false
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.08" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: second check failed 1, next skipped</Name>
    <Description>

      MaximumNumberOfKeys = 2

      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths = 1

      RSAKeyPairGeneration = false
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="1" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.09" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: second check failed 2, next skipped</Name>
    <Description>

      MaximumNumberOfKeys = 2

      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths = 1

      RSAKeyPairGeneration = false
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Third check: cap.KeystoreCapabilities.RSAKeyPairGeneration = true-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.10" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: third check passed, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1

      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 2

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1"
      MaximumNumberOfKeys = 1

      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="3" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="1" RSAKeyLengths="1" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.11" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: third check failed 1, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1

      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 2

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths=""
      MaximumNumberOfKeys = 1

      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="3" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="1" RSAKeyLengths="1" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.12" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: third check failed 2, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1

      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 2

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths skipped
      MaximumNumberOfKeys = 1

      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="3" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="1" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.13" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: third check failed 3, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys skipped

      2nd check:
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1"
      MaximumNumberOfKeys skipped

      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities RSAKeyPairGeneration="1" RSAKeyLengths="1" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Fourth check: cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = true-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.150" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check passed, next skipped (only RSAKeyPairGeneration = true)</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3
      
      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1
      
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.151" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check passed, next skipped (only PKCS8RSAKeyPairUpload = true)</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3

      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check (skipped)
      RSAKeyPairGeneration skipped
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      PKCS8RSAKeyPairUpload = true
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1

      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" PKCS8RSAKeyPairUpload="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.152" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check passed, next skipped (only PKCS12CertificateWithRSAPrivateKeyUpload = true)</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3

      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check (skipped)
      RSAKeyPairGeneration skipped
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      PKCS12CertificateWithRSAPrivateKeyUpload = true
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1

      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" PKCS12CertificateWithRSAPrivateKeyUpload="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.16" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 1, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3

      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = false
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = false
      PKCS8RSAKeyPairUpload="false" 
      PKCS12CertificateWithRSAPrivateKeyUpload="false"
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1

      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="0" PKCS8RSAKeyPairUpload="0" PKCS12CertificateWithRSAPrivateKeyUpload="0" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.17" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 2, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3

      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration skipped
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration skipped
      PKCS8RSAKeyPairUpload skipped 
      PKCS12CertificateWithRSAPrivateKeyUpload skipped
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1

      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths = 0
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.18" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 3, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3
      
      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths=""
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1
      
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.19" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 4, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3
      
      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths skipped
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1
      
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="1" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.20" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 5, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3
      
      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms skipped
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1
      
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.21" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 6, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 3
      
      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 1


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1
      
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.22" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 7, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys skipped
      MaximumNumberOfCertificates skipped

      2nd check:
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys skipped


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys skipped
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped

      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.23" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 8, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1

      2nd check:
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="1" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.24" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 9, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates skipped

      2nd check:
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped

      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.25" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fourth check failed 10, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2

      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths skipped

      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Fifth check: cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.260" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fifth check passed, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 1

      2nd check:
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      5th check:
      SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty

      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="1" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="true" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.261" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fifth check passed, next skipped (only PKCS8RSAKeyPairUpload  = true) </Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 1

      2nd check:
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      3rd check (skipped)
      RSAKeyPairGeneration skipped
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      PKCS8RSAKeyPairUpload = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      5th check:
      SelfSignedCertificateCreationWithRSA = true
      PKCS8RSAKeyPairUpload  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty

      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="1" PKCS8RSAKeyPairUpload="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="true" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.262" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fifth check passed, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 1

      2nd check:
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      3rd check (skipped)
      RSAKeyPairGeneration skipped
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      PKCS12CertificateWithRSAPrivateKeyUpload = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      5th check:
      SelfSignedCertificateCreationWithRSA = true
      PKCS12CertificateWithRSAPrivateKeyUpload  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty

      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="1" PKCS12CertificateWithRSAPrivateKeyUpload="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="true" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.27" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fifth check failed 1, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 1

      2nd check:
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = false
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = false
      PKCS8RSAKeyPairUpload=false
      PKCS12CertificateWithRSAPrivateKeyUpload=false
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      5th check:
      SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = false
      PKCS8RSAKeyPairUpload=false
      PKCS12CertificateWithRSAPrivateKeyUpload=false
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty

      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="1" RSAKeyPairGeneration="false" PKCS8RSAKeyPairUpload="false" PKCS12CertificateWithRSAPrivateKeyUpload="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="true" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.28" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fifth check failed 2, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 1

      2nd check:
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration skipped
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration skipped
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      5th check:
      SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = skipped
      PKCS8RSAKeyPairUpload=skipped
      PKCS12CertificateWithRSAPrivateKeyUpload=skipped
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty

      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="true" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.29" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fifth check failed 3, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates skipped

      2nd check:
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped

      5th check:
      SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  skipped
      SignatureAlgorithms not empty

      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="true" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.31" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: fifth check failed 5, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 1

      2nd check:
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped

      5th check:
      SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms empty

      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="2">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="1" RSAKeyPairGeneration="1" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="true" X509Versions="1">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Sixth check: TLSServerCapabilities.TLSServerSupported -->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.32" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: sixth check passed, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 2
      
      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 2

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths = 2
      
      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty
      
      6th check:
      TLSServerSupported not empty
      TLSServerSupported = "1.0"
      MaximumNumberOfCertificationPaths = 2
      MaximumNumberOfTLSCertificationPaths = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.33" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: sixth check failed 1, next skipped, TLSServerSupported = "1.1"</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 2
      
      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 2

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths = 2
      
      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty
      
      6th check:
      TLSServerSupported not empty
      TLSServerSupported = "1.1"
      MaximumNumberOfCertificationPaths = 2
      MaximumNumberOfTLSCertificationPaths = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.1" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.34" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: sixth check faled 2, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 2
      
      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths = 1
      
      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty
      
      6th check:
      TLSServerSupported not empty
      TLSServerSupported = "1.0"
      MaximumNumberOfCertificationPaths = 1
      MaximumNumberOfTLSCertificationPaths = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.35" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: sixth check faled 3, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 2
      
      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths skipped

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths skipped
      
      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty
      
      6th check:
      TLSServerSupported not empty
      TLSServerSupported = "1.0"
      MaximumNumberOfCertificationPaths skipped
      MaximumNumberOfTLSCertificationPaths = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="2" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.36" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: sixth check failed 4, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 1
      MaximumNumberOfCertificates = 2

      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 2

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 1
      MaximumNumberOfCertificationPaths = 2

      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 1
      SignatureAlgorithms not empty

      6th check:
      TLSServerSupported not empty
      TLSServerSupported = "1.0"
      MaximumNumberOfCertificationPaths = 2
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="0.0 1.0"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Seventh check: cap.TLSServerCapabilities.TLSServerSupported is not empty and cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = true -->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.37" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: sixth check passed, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3

      2nd check:
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 2

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 3
      MaximumNumberOfCertificationPaths = 2

      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 3
      SignatureAlgorithms not empty

      6th check:
      TLSServerSupported not empty
      TLSServerSupported = "1.0"
      MaximumNumberOfCertificationPaths = 2
      MaximumNumberOfTLSCertificationPaths = 1

      7th check:
      TLSServerSupported not empty
      PKCS10ExternalCertificationWithRSA = true
      MaximumNumberOfCertificates = 3

    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="3" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.38" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: sixth check failed 1, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2

      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 2

      3rd check:
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = true
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 2

      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 2
      SignatureAlgorithms not empty

      6th check:
      TLSServerSupported not empty
      TLSServerSupported = "1.0"
      MaximumNumberOfCertificationPaths = 2
      MaximumNumberOfTLSCertificationPaths = 1

      7th check:
      TLSServerSupported not empty
      PKCS10ExternalCertificationWithRSA = true
      MaximumNumberOfCertificates = 2

    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Last check: cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths > 0 -->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.39" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: last check passed, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2

      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = false
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 2

      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 2
      SignatureAlgorithms not empty

      6th check:
      TLSServerSupported empty
      TLSServerSupported = "1.0"
      MaximumNumberOfCertificationPaths = 2
      MaximumNumberOfTLSCertificationPaths = 1

      7th check:
      TLSServerSupported empty
      PKCS10ExternalCertificationWithRSA = true
      MaximumNumberOfCertificates = 2

      Last check:
      MaximumNumberOfTLSCertificationPaths = 1
      MaximumNumberOfCertificationPaths = 1

    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.40" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Correct response: last check faled, next skipped</Name>
    <Description>
      1st check:
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2

      2nd check:
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 1

      3rd check:
      RSAKeyPairGeneration = false
      RSAKeyLengths="1 2"
      MaximumNumberOfKeys = 2


      4th check:
      PKCS10ExternalCertificationWithRSA = false
      RSAKeyPairGeneration = true
      RSAKeyLengths="1 2"
      SignatureAlgorithms not empty
      MaximumNumberOfKeys = 2
      MaximumNumberOfCertificates = 2
      MaximumNumberOfCertificationPaths = 2

      5th check:
      SelfSignedCertificateCreationWithRSA = false
      RSAKeyPairGeneration  = true
      MaximumNumberOfCertificates  = 2
      SignatureAlgorithms not empty

      6th check:
      TLSServerSupported empty
      TLSServerSupported = "1.0"
      MaximumNumberOfCertificationPaths = 2
      MaximumNumberOfTLSCertificationPaths = 1

      7th check:
      TLSServerSupported empty
      PKCS10ExternalCertificationWithRSA = true
      MaximumNumberOfCertificates = 2

      Last check:
      MaximumNumberOfTLSCertificationPaths = 1
      MaximumNumberOfCertificationPaths skipped

    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1"/>
          <tas:TLSServerCapabilities TLSServerSupported="1.1 ver2" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.41" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Deserialization issue check</Name>
    <Description>
      MaximumNumberOfCertificates skipped
      MaximumNumberOfCertificationPaths skipped
      RSAKeyPairGeneration = false
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false
      TLSServerSupported empty
      MaximumNumberOfTLSCertificationPaths skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">


          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="3">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" RSAKeyPairGeneration="false" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="false" SelfSignedCertificateCreationWithRSA="false" X509Versions="1">
          </tas:KeystoreCapabilities> 
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--KeystoreCapabilities-->
  <!--MaximumNumberOfCertificates-->
  <!--SEE ABOVE FOR-->
  <!--MaximumNumberOfCertificationPaths-->
  <!--SEE ABOVE FOR -->
  <!--RSAKeyPairGeneration-->
  <!--SEE ABOVE FOR -->
  
  <!--PKCS8RSAKeyPairUpload-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: Correct response</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
          8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
          8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
          8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
          8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
          8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 1
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="1" MaximumNumberOfPassphrases="1" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1" PasswordBasedEncryptionAlgorithms="1 pbeWithSHAAnd3-KeyTripleDES-CBC"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: Correct response 2</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 10
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="10" MaximumNumberOfPassphrases="10" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1 2" PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_1_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response MaximumNumberOfPassphrases (less than 1)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 0
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 10
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="10" MaximumNumberOfPassphrases="0" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1 2" PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_1_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response MaximumNumberOfPassphrases (skipped)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases skipped
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 10
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="10" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1 2" PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_2_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response MaximumNumberOfKeys (less 1)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 0
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="0" MaximumNumberOfPassphrases="10" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1 2" PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_2_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response MaximumNumberOfKeys (skipped)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        cap.KeystoreCapabilities.MaximumNumberOfKeys skipped
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfPassphrases="10" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1 2" PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_3_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response RSAKeyLenghts (empty)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 10
        KeystoreCapabilities.RSAKeyLenghts empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="10" MaximumNumberOfPassphrases="10" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="" PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_3_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response RSAKeyLenghts (skipped)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 10
        KeystoreCapabilities.RSAKeyLenghts skipped
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="10" MaximumNumberOfPassphrases="10" PKCS8RSAKeyPairUpload="true" PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_4_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response PasswordBasedEncryptionAlgorithms (is empty)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 10
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="5">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="10" MaximumNumberOfPassphrases="10" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1 2" PasswordBasedEncryptionAlgorithms=""/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_4_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response PasswordBasedEncryptionAlgorithms (skipped)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 10
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms skipped
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="10" MaximumNumberOfPassphrases="10" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1 2"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.8_5_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS8RSAKeyPairUpload: invalid response PasswordBasedEncryptionAlgorithms (does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC”)</Name>
    <Description>
        8.	If cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = true:
        8.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        8.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 1 or skipped, FAIL the test.
        8.3. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        8.4. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        8.5. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.

        KeystoreCapabilities.PKCS8RSAKeyPairUpload = true
        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        cap.KeystoreCapabilities.MaximumNumberOfKeys = 10
        KeystoreCapabilities.RSAKeyLenghts not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="10" MaximumNumberOfPassphrases="10" PKCS8RSAKeyPairUpload="true" RSAKeyLengths="1 2" PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC1"/>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--PKCS12CertificateWithRSAPrivateKeyUpload-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: Correct response</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: Correct response 2</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 10
        KeystoreCapabilities.MaximumNumberOfKeys = 20
        KeystoreCapabilities.MaximumNumberOfCertificates = 20
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 10
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="20"
                                    MaximumNumberOfPassphrases="10"
                                    MaximumNumberOfCertificates="20"
                                    MaximumNumberOfCertificationPaths="10"
                                    RSAKeyLengths="1 2"
                                    PasswordBasedEncryptionAlgorithms="1 pbeWithSHAAnd3-KeyTripleDES-CBC 2"
                                    PasswordBasedMACAlgorithms="1 hmacWithSHA256 2"
                                    X509Versions="1 3 2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.0</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.9</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_1_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response MaximumNumberOfPassphrases (0)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 0
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="0"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_1_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response MaximumNumberOfPassphrases (skipped)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases skipped
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_2_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response MaximumNumberOfKeys (1)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 1
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_2_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response MaximumNumberOfKeys (skipped)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys skipped
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_3_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response MaximumNumberOfCertificates (1)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 1
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="1"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_3_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response MaximumNumberOfCertificates (skipped)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates skipped
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_4_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response MaximumNumberOfCertificationPaths (0)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 0
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="0"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_4_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response MaximumNumberOfCertificationPaths (skipped)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths skipped
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_5_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response SignatureAlgorithms(empty)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_6_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response RSAKeyLenghts (empty)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_6_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response RSAKeyLenghts (skipped)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is skipped
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_7_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response PasswordBasedEncryptionAlgorithms (empty)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="5">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_7_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response PasswordBasedEncryptionAlgorithms (skipped)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is skipped
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_8_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response PasswordBasedEncryptionAlgorithms (not contain “pbeWithSHAAnd3-KeyTripleDES-CBC”)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC1"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_9_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response PasswordBasedMACAlgorithms (empty)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="6">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_9_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response PasswordBasedMACAlgorithms (skipped)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is skipped
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_10_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response PasswordBasedMACAlgorithms (not contain “hmacWithSHA256”)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms does not contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA2561"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_11_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response X509Versions (empty)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters special="4">
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_11_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response X509Versions (skipped)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is skipped
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_12_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response X509Versions (not contain “3”)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions does not contain “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="1 2 4">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_13_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response SignatureAlgorithms(not contain “1.2.840.113549.1.1.5”)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.9_14_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload: invalid response SignatureAlgorithms(not contain “1.2.840.113549.1.1.11”)</Name>
    <Description>
      9.	If cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true: 
        9.1. If cap.KeystoreCapabilities.MaximumNumberOfPassphrases less 1 or skipped, FAIL the test.
        9.2. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        9.3. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        9.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        9.5. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        9.6. If cap.KeystoreCapabilities.RSAKeyLenghts is empty or skipped, FAIL the test.
        9.7. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is empty or skipped, FAIL the test.
        9.8. If cap.KeystoreCapabilities.PasswordBasedEncryptionAlgorithms does not contain “pbeWithSHAAnd3-KeyTripleDES-CBC” item, FAIL the test.
        9.9. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms is empty or skipped, FAIL the test.
        9.10. If cap.KeystoreCapabilities.PasswordBasedMACAlgorithms does not contain “hmacWithSHA256” item, FAIL the test.
        9.11. If cap.KeystoreCapabilities.X509Versions is empty or skipped, FAIL the test.
        9.12. If cap.KeystoreCapabilities.X509Versions does not contain “3” item, FAIL the test.
        9.13. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        9.14. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test.

        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  
  <!--PKCS10ExternalCertificationWithRSA -->
  <!--SEE ABOVE FOR 10.1-10.5 steps-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.10_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS10ExternalCertificationWithRSA: Correct response</Name>
    <Description>
      10.	If cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = true:
        10.1. If (cap.KeystoreCapabilities.RSAKeyPairGeneration = false or skipped) and (cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.
        10.2. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        10.3. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        10.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        10.5. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        10.6. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        10.7. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test. 

        KeystoreCapabilities.RSAKeyPairGeneration = true
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
        
        Additional:
        KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS10ExternalCertificationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.10_6_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS10ExternalCertificationWithRSA: invalid response SignatureAlgorithms(not contain “1.2.840.113549.1.1.5”)</Name>
    <Description>
      10.	If cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = true:
        10.1. If (cap.KeystoreCapabilities.RSAKeyPairGeneration = false or skipped) and (cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.
        10.2. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        10.3. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        10.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        10.5. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        10.6. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        10.7. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test. 

        KeystoreCapabilities.RSAKeyPairGeneration = true
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.SignatureAlgorithms does not contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
        
        Additional:
        KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS10ExternalCertificationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.2</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.10_7_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.PKCS10ExternalCertificationWithRSA: invalid response SignatureAlgorithms(not contain “1.2.840.113549.1.1.11”)</Name>
    <Description>
      10.	If cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = true:
        10.1. If (cap.KeystoreCapabilities.RSAKeyPairGeneration = false or skipped) and (cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.
        10.2. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        10.3. If cap.KeystoreCapabilities.MaximumNumberOfKeys less 2 or skipped, FAIL the test.
        10.4. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less 2 or skipped, FAIL the test.
        10.5. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less or equal 0 or skipped, FAIL the test.
        10.6. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        10.7. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test. 

        KeystoreCapabilities.RSAKeyPairGeneration = true
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
        
        Additional:
        KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities PKCS10ExternalCertificationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.112</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--SelfSignedCertificateCreationWithRSA-->
  <!--SEE ABOVE FOR 11.1-11.3-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.11_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.SelfSignedCertificateCreationWithRSA: Correct response</Name>
    <Description>
      11.	If cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true:
        11.1. If (cap.KeystoreCapabilities.RSAKeyPairGeneration = false or skipped) and (cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.
        11.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less or equal 0 or skipped, FAIL the test.
        11.3. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        11.4. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        11.5. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test. 

        KeystoreCapabilities.RSAKeyPairGeneration = true
        KeystoreCapabilities.MaximumNumberOfCertificates = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
        
        Additional:
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.MaximumNumberOfKeys = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities SelfSignedCertificateCreationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificates="1"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.11_4_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.SelfSignedCertificateCreationWithRSA: invalid response SignatureAlgorithms (not contain “1.2.840.113549.1.1.5”)</Name>
    <Description>
      11.	If cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true:
        11.1. If (cap.KeystoreCapabilities.RSAKeyPairGeneration = false or skipped) and (cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.
        11.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less or equal 0 or skipped, FAIL the test.
        11.3. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        11.4. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        11.5. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test. 

        KeystoreCapabilities.RSAKeyPairGeneration = true
        KeystoreCapabilities.MaximumNumberOfCertificates = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.SignatureAlgorithms does not contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
        
        Additional:
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.MaximumNumberOfKeys = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities SelfSignedCertificateCreationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificates="1"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.51</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.11_5_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.SelfSignedCertificateCreationWithRSA: invalid response SignatureAlgorithms (not contain “1.2.840.113549.1.1.5”)</Name>
    <Description>
      11.	If cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true:
        11.1. If (cap.KeystoreCapabilities.RSAKeyPairGeneration = false or skipped) and (cap.KeystoreCapabilities.PKCS8RSAKeyPairUpload = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.
        11.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificates less or equal 0 or skipped, FAIL the test.
        11.3. If cap.KeystoreCapabilities.SignatureAlgorithms list is empty, FAIL the test.
        11.4. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.5” (OID of SHA-1 with RSA Encryption algorithm), FAIL the test.
        11.5. If cap.KeystoreCapabilities.SignatureAlgorithms list does not contain item with algorithm = “1.2.840.113549.1.1.11” (OID of SHA-256 with RSA Encryption algorithm), FAIL the test. 

        KeystoreCapabilities.RSAKeyPairGeneration = true
        KeystoreCapabilities.MaximumNumberOfCertificates = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
        
        Additional:
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.MaximumNumberOfKeys = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities SelfSignedCertificateCreationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificates="1"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.111</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  
  <!--MaximumNumberOfCertificationPathValidationPolicies-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.12_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies: Correct response (SelfSignedCertificateCreationWithRSA)</Name>
    <Description>
      12.	If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies more 0:
      12.1. If (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.

      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true

      Additional:
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="1"
                                    MaximumNumberOfKeys="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.12_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies: Correct response (PKCS10ExternalCertificationWithRSA)</Name>
    <Description>
      12.	If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies more 0:
      12.1. If (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.

      KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = true

      Additional:
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 2
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="1"
                                    PKCS10ExternalCertificationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.12_2" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies: Correct response (PKCS12CertificateWithRSAPrivateKeyUpload)</Name>
    <Description>
      12.	If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies more 0:
        12.1. If (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.

        KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = true
        
        Additional:
        KeystoreCapabilities.MaximumNumberOfPassphrases = 1
        KeystoreCapabilities.MaximumNumberOfKeys = 2
        KeystoreCapabilities.MaximumNumberOfCertificates = 2
        KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
        KeystoreCapabilities.SignatureAlgorithms is not empty
        KeystoreCapabilities.RSAKeyLenghts is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedEncryptionAlgorithms contains “pbeWithSHAAnd3-KeyTripleDES-CBC”
        KeystoreCapabilities.PasswordBasedMACAlgorithms is not empty
        KeystoreCapabilities.PasswordBasedMACAlgorithms contains “hmacWithSHA256”
        KeystoreCapabilities.X509Versions is not empty
        KeystoreCapabilities.X509Versions contains “3”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
        KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="1"
                                    PKCS12CertificateWithRSAPrivateKeyUpload="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfPassphrases="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfCertificationPaths="1"
                                    RSAKeyLengths="1"
                                    PasswordBasedEncryptionAlgorithms="pbeWithSHAAnd3-KeyTripleDES-CBC"
                                    PasswordBasedMACAlgorithms="hmacWithSHA256"
                                    X509Versions="3">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.12_1_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies: invalid response (all false)</Name>
    <Description>
      12.	If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies more 0:
        12.1. If (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.

        KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false
        KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false
        KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false
        
        
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="1"
                                    SelfSignedCertificateCreationWithRSA="0"
                                    PKCS10ExternalCertificationWithRSA="false"
                                    PKCS12CertificateWithRSAPrivateKeyUpload="false">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.12_1_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies: invalid response (all skipped)</Name>
    <Description>
      12.	If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies more 0:
        12.1. If (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload = false or skipped), FAIL the test.

        KeystoreCapabilities.SelfSignedCertificateCreationWithRSA skipped
        KeystoreCapabilities.PKCS10ExternalCertificationWithRSA skipped
        KeystoreCapabilities.PKCS12CertificateWithRSAPrivateKeyUpload skipped
        
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="1">
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--TLSServerCapabilities-->
  <!--TLSServerSupported-->
  <!--SEE ABOVE FOR 13.1-13.3-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.13_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSServerSupported: Correct response (PKCS10ExternalCertificationWithRSA)</Name>
    <Description>
      13.	If cap.TLSServerCapabilities.TLSServerSupported is not empty:
      13.1. If cap.TLSServerCapabilities.TLSServerSupported does not contain the value 1.0, FAIL the test.
      13.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less 2 or skipped, FAIL the test.
      13.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths less or equal 0 or skipped, FAIL the test.
      13.4. If (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped), FAIL the test.


      TLSServerCapabilities.TLSServerSupported is not empty
      TLSServerCapabilities.TLSServerSupported contain 1.0
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      KeystoreCapabilities.MaximumNumberOfTLSCertificationPaths = 1
      PKCS10ExternalCertificationWithRSA = true
      SelfSignedCertificateCreationWithRSA = false

      Additional:
      KeystoreCapabilities.RSAKeyPairGeneration = true
      KeystoreCapabilities.MaximumNumberOfKeys = 2
      KeystoreCapabilities.MaximumNumberOfCertificates = 3
      KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
      KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities
                                    SelfSignedCertificateCreationWithRSA="false"
                                    PKCS10ExternalCertificationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="3"
                                    MaximumNumberOfCertificationPaths="2"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.13_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSServerSupported: Correct response (SelfSignedCertificateCreationWithRSA)</Name>
    <Description>
      13.	If cap.TLSServerCapabilities.TLSServerSupported is not empty:
      13.1. If cap.TLSServerCapabilities.TLSServerSupported does not contain the value 1.0, FAIL the test.
      13.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less 2 or skipped, FAIL the test.
      13.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths less or equal 0 or skipped, FAIL the test.
      13.4. If (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped), FAIL the test.


      TLSServerCapabilities.TLSServerSupported is not empty
      TLSServerCapabilities.TLSServerSupported contain 1.0
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      KeystoreCapabilities.MaximumNumberOfTLSCertificationPaths = 1
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = true

      Additional:
      KeystoreCapabilities.RSAKeyPairGeneration = true
      KeystoreCapabilities.MaximumNumberOfKeys = 2
      KeystoreCapabilities.MaximumNumberOfCertificates = 3
      KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
      KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities
                                    SelfSignedCertificateCreationWithRSA="true"
                                    PKCS10ExternalCertificationWithRSA="false"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="3"
                                    MaximumNumberOfCertificationPaths="2"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.13_2" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSServerSupported: Correct response (PKCS10ExternalCertificationWithRSA) 2</Name>
    <Description>
      13.	If cap.TLSServerCapabilities.TLSServerSupported is not empty:
      13.1. If cap.TLSServerCapabilities.TLSServerSupported does not contain the value 1.0, FAIL the test.
      13.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less 2 or skipped, FAIL the test.
      13.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths less or equal 0 or skipped, FAIL the test.
      13.4. If (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped), FAIL the test.


      TLSServerCapabilities.TLSServerSupported is not empty
      TLSServerCapabilities.TLSServerSupported contain 1.0
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      KeystoreCapabilities.MaximumNumberOfTLSCertificationPaths = 1
      PKCS10ExternalCertificationWithRSA = true
      SelfSignedCertificateCreationWithRSA skipped

      Additional:
      KeystoreCapabilities.RSAKeyPairGeneration = true
      KeystoreCapabilities.MaximumNumberOfKeys = 2
      KeystoreCapabilities.MaximumNumberOfCertificates = 3
      KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
      KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities
                                    
                                    PKCS10ExternalCertificationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="3"
                                    MaximumNumberOfCertificationPaths="2"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.13_3" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSServerSupported: Correct response (SelfSignedCertificateCreationWithRSA) 2</Name>
    <Description>
      13.	If cap.TLSServerCapabilities.TLSServerSupported is not empty:
      13.1. If cap.TLSServerCapabilities.TLSServerSupported does not contain the value 1.0, FAIL the test.
      13.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less 2 or skipped, FAIL the test.
      13.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths less or equal 0 or skipped, FAIL the test.
      13.4. If (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped), FAIL the test.


      TLSServerCapabilities.TLSServerSupported is not empty
      TLSServerCapabilities.TLSServerSupported contain 1.0
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      KeystoreCapabilities.MaximumNumberOfTLSCertificationPaths = 1
      PKCS10ExternalCertificationWithRSA skipped
      SelfSignedCertificateCreationWithRSA = true

      Additional:
      KeystoreCapabilities.RSAKeyPairGeneration = true
      KeystoreCapabilities.MaximumNumberOfKeys = 2
      KeystoreCapabilities.MaximumNumberOfCertificates = 3
      KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
      KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities
                                    SelfSignedCertificateCreationWithRSA="true"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="3"
                                    MaximumNumberOfCertificationPaths="2"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.13_4_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSServerSupported: Correct response (both false)</Name>
    <Description>
      13.	If cap.TLSServerCapabilities.TLSServerSupported is not empty:
      13.1. If cap.TLSServerCapabilities.TLSServerSupported does not contain the value 1.0, FAIL the test.
      13.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less 2 or skipped, FAIL the test.
      13.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths less or equal 0 or skipped, FAIL the test.
      13.4. If (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped), FAIL the test.


      TLSServerCapabilities.TLSServerSupported is not empty
      TLSServerCapabilities.TLSServerSupported contain 1.0
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      KeystoreCapabilities.MaximumNumberOfTLSCertificationPaths = 1
      PKCS10ExternalCertificationWithRSA = false
      SelfSignedCertificateCreationWithRSA = false

      Additional:
      KeystoreCapabilities.RSAKeyPairGeneration = true
      KeystoreCapabilities.MaximumNumberOfKeys = 2
      KeystoreCapabilities.MaximumNumberOfCertificates = 3
      KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
      KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities
                                    SelfSignedCertificateCreationWithRSA="false"
                                    PKCS10ExternalCertificationWithRSA="false"
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="3"
                                    MaximumNumberOfCertificationPaths="2"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.13_4_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSServerSupported: Correct response (both skipped)</Name>
    <Description>
      13.	If cap.TLSServerCapabilities.TLSServerSupported is not empty:
      13.1. If cap.TLSServerCapabilities.TLSServerSupported does not contain the value 1.0, FAIL the test.
      13.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPaths less 2 or skipped, FAIL the test.
      13.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths less or equal 0 or skipped, FAIL the test.
      13.4. If (cap.KeystoreCapabilities.PKCS10ExternalCertificationWithRSA = false or skipped) and (cap.KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = false or skipped), FAIL the test.


      TLSServerCapabilities.TLSServerSupported is not empty
      TLSServerCapabilities.TLSServerSupported contain 1.0
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      KeystoreCapabilities.MaximumNumberOfTLSCertificationPaths = 1
      PKCS10ExternalCertificationWithRSA skipped
      SelfSignedCertificateCreationWithRSA skipped

      Additional:
      KeystoreCapabilities.RSAKeyPairGeneration = true
      KeystoreCapabilities.MaximumNumberOfKeys = 2
      KeystoreCapabilities.MaximumNumberOfCertificates = 3
      KeystoreCapabilities.MaximumNumberOfCertificattionPaths = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.11”
      KeystoreCapabilities.RSAKeyLenghts is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities
                                    
                                    RSAKeyPairGeneration="1"
                                    MaximumNumberOfKeys="2"
                                    MaximumNumberOfCertificates="3"
                                    MaximumNumberOfCertificationPaths="2"
                                    RSAKeyLengths="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPaths="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--TLSClientAuthSupported-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.14_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSClientAuthSupported: Correct response</Name>
    <Description>
      14.	If cap.TLSServerCapabilities.TLSClientAuthSupported = true:
      14.1. If cap.TLSServerCapabilities.TLSServerSupported is empty, FAIL the test.
      14.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less 2 or skipped, FAIL the test.
      14.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.
      14.4. If cap.KeystoreCapabilities.MaximumNumberOfCRLs less or equal 0 or skipped, FAIL the test.

      TLSClientAuthSupported=true

      TLSServerCapabilities.TLSServerSupported is not empty
      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 2
      KeystoreCapabilities.MaximumNumberOfCRLs = 1

      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths = 2
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="2"
                                    MaximumNumberOfCRLs="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="true" TLSServerSupported="2.0 1.0" MaximumNumberOfTLSCertificationPathValidationPolicies="2" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.14_1_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSClientAuthSupported: invalid response TLSServerSupported (empty)</Name>
    <Description>
      14.	If cap.TLSServerCapabilities.TLSClientAuthSupported = true:
      14.1. If cap.TLSServerCapabilities.TLSServerSupported is empty, FAIL the test.
      14.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less 2 or skipped, FAIL the test.
      14.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.
      14.4. If cap.KeystoreCapabilities.MaximumNumberOfCRLs less or equal 0 or skipped, FAIL the test.

      TLSClientAuthSupported=true

      TLSServerCapabilities.TLSServerSupported is empty
      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 2
      KeystoreCapabilities.MaximumNumberOfCRLs = 1

      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths = 2
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="2"
                                    MaximumNumberOfCRLs="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="true" TLSServerSupported="" MaximumNumberOfTLSCertificationPathValidationPolicies="2" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.14_2_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSClientAuthSupported: invalid response MaximumNumberOfCertificationPathValidationPolicies (0)</Name>
    <Description>
      14.	If cap.TLSServerCapabilities.TLSClientAuthSupported = true:
      14.1. If cap.TLSServerCapabilities.TLSServerSupported is empty, FAIL the test.
      14.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less 2 or skipped, FAIL the test.
      14.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.
      14.4. If cap.KeystoreCapabilities.MaximumNumberOfCRLs less or equal 0 or skipped, FAIL the test.

      TLSClientAuthSupported=true

      TLSServerCapabilities.TLSServerSupported is empty
      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 0
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 2
      KeystoreCapabilities.MaximumNumberOfCRLs = 1

      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths = 2
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="0"
                                    MaximumNumberOfCRLs="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="true" TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPathValidationPolicies="2" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.14_2_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSClientAuthSupported: invalid response MaximumNumberOfCertificationPathValidationPolicies (skipped)</Name>
    <Description>
      14.	If cap.TLSServerCapabilities.TLSClientAuthSupported = true:
      14.1. If cap.TLSServerCapabilities.TLSServerSupported is empty, FAIL the test.
      14.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less 2 or skipped, FAIL the test.
      14.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.
      14.4. If cap.KeystoreCapabilities.MaximumNumberOfCRLs less or equal 0 or skipped, FAIL the test.

      TLSClientAuthSupported=true

      TLSServerCapabilities.TLSServerSupported is empty
      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies skipped
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 2
      KeystoreCapabilities.MaximumNumberOfCRLs = 1

      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths = 2
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities 
                                    MaximumNumberOfCRLs="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="true" TLSServerSupported="1.0" MaximumNumberOfTLSCertificationPathValidationPolicies="2" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.14_3_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSClientAuthSupported: invalid response MaximumNumberOfTLSCertificationPathValidationPolicies (0)</Name>
    <Description>
      14.	If cap.TLSServerCapabilities.TLSClientAuthSupported = true:
      14.1. If cap.TLSServerCapabilities.TLSServerSupported is empty, FAIL the test.
      14.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less 2 or skipped, FAIL the test.
      14.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.
      14.4. If cap.KeystoreCapabilities.MaximumNumberOfCRLs less or equal 0 or skipped, FAIL the test.

      TLSClientAuthSupported=true

      TLSServerCapabilities.TLSServerSupported is not empty
      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 0
      KeystoreCapabilities.MaximumNumberOfCRLs = 1

      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths = 2
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="2"
                                    MaximumNumberOfCRLs="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="true" TLSServerSupported="2.0 1.0" MaximumNumberOfTLSCertificationPathValidationPolicies="0" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.14_3_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSClientAuthSupported: invalid response MaximumNumberOfTLSCertificationPathValidationPolicies (skipped)</Name>
    <Description>
      14.	If cap.TLSServerCapabilities.TLSClientAuthSupported = true:
      14.1. If cap.TLSServerCapabilities.TLSServerSupported is empty, FAIL the test.
      14.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less 2 or skipped, FAIL the test.
      14.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.
      14.4. If cap.KeystoreCapabilities.MaximumNumberOfCRLs less or equal 0 or skipped, FAIL the test.

      TLSClientAuthSupported=true

      TLSServerCapabilities.TLSServerSupported is not empty
      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies skipped
      KeystoreCapabilities.MaximumNumberOfCRLs = 1

      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths = 2
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="2"
                                    MaximumNumberOfCRLs="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="true" TLSServerSupported="2.0 1.0"  MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.14_4_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSClientAuthSupported: invalid response MaximumNumberOfCRLs</Name>
    <Description>
      14.	If cap.TLSServerCapabilities.TLSClientAuthSupported = true:
      14.1. If cap.TLSServerCapabilities.TLSServerSupported is empty, FAIL the test.
      14.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less 2 or skipped, FAIL the test.
      14.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.
      14.4. If cap.KeystoreCapabilities.MaximumNumberOfCRLs less or equal 0 or skipped, FAIL the test.

      TLSClientAuthSupported=true

      TLSServerCapabilities.TLSServerSupported is not empty
      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 2
      KeystoreCapabilities.MaximumNumberOfCRLs = 0

      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths = 2
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="2"
                                    MaximumNumberOfCRLs="0"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="true" TLSServerSupported="2.0 1.0" MaximumNumberOfTLSCertificationPathValidationPolicies="2" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.14_4_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.TLSClientAuthSupported: invalid response MaximumNumberOfCRLs</Name>
    <Description>
      14.	If cap.TLSServerCapabilities.TLSClientAuthSupported = true:
      14.1. If cap.TLSServerCapabilities.TLSServerSupported is empty, FAIL the test.
      14.2. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less 2 or skipped, FAIL the test.
      14.3. If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.
      14.4. If cap.KeystoreCapabilities.MaximumNumberOfCRLs less or equal 0 or skipped, FAIL the test.

      TLSClientAuthSupported=true

      TLSServerCapabilities.TLSServerSupported is not empty
      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 2
      KeystoreCapabilities.MaximumNumberOfCRLs skipped

      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 2
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
      KeystoreCapabilities.MaximumNumberOfCertificationPaths = 2
      TLSServerCapabilities.MaximumNumberOfTLSCertificationPaths = 2
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="2"
                                    
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="true" TLSServerSupported="2.0 1.0" MaximumNumberOfTLSCertificationPathValidationPolicies="2" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <!--MaximumNumberOfTLSCertificationPathValidationPolicies-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.15_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies: Correct response</Name>
    <Description>
      15.	If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies > 0:
      15.1. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test.

      TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 1

      KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 1



      Additional:
      KeystoreCapabilities.SelfSignedCertificateCreationWithRSA = true
      RSAKeyPairGeneration = true
      KeystoreCapabilities.RSAKeyLenghts is not empty
      KeystoreCapabilities.MaximumNumberOfKeys = 1
      KeystoreCapabilities.MaximumNumberOfCertificates = 1
      KeystoreCapabilities.SignatureAlgorithms is not empty
      KeystoreCapabilities.SignatureAlgorithms contains “1.2.840.113549.1.1.5”
      KeystoreCapabilities.SignatureAlgorithms does not contain “1.2.840.113549.1.1.11”
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="1"
                                    MaximumNumberOfKeys="1">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>
          
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities MaximumNumberOfTLSCertificationPathValidationPolicies="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.15_1_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies: invalid response MaximumNumberOfCertificationPathValidationPolicies(0)</Name>
    <Description>
       15.	If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies > 0:
         15.1. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test. 

        TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 1
        
        KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies = 0
    
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="0"/>
          <tas:TLSServerCapabilities MaximumNumberOfTLSCertificationPathValidationPolicies="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.15_1_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies: invalid response MaximumNumberOfCertificationPathValidationPolicies(skipped)</Name>
    <Description>
       15.	If cap.TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies > 0:
         15.1. If cap.KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies less or equal 0 or skipped, FAIL the test. 

        TLSServerCapabilities.MaximumNumberOfTLSCertificationPathValidationPolicies = 1
        
        KeystoreCapabilities.MaximumNumberOfCertificationPathValidationPolicies skipped

    
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities MaximumNumberOfTLSCertificationPathValidationPolicies="1"/>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--TLSServerSupported AND PKCS10ExternalCertificationWithRSA-->
  <!--SEE ABOVE FOR 16-->
  
  <!--MaximumNumberOfTLSCertificationPaths-->
  <!--SEE ABOVE FOR 17-->
  
  <!--Dot1XCapabilities-->
  <!--MaximumNumberOfDot1XConfigurations-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.18_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Dot1XCapabilities.MaximumNumberOfDot1XConfigurations: Correct response</Name>
    <Description>
        18.	If cap.Dot1XCapabilities.MaximumNumberOfDot1XConfigurations > 0:
          18.1. If cap.Dot1XCapabilities.Dot1XMethods list is empty, FAIL the test.


        Dot1XCapabilities.Dot1XMethods is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
          <tas:Dot1XCapabilities MaximumNumberOfDot1XConfigurations="1">
            <tas:Dot1XMethods>EAP-PEAP MSCHAPv2</tas:Dot1XMethods>
          </tas:Dot1XCapabilities>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.18_1_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Dot1XCapabilities.MaximumNumberOfDot1XConfigurations: invalid response</Name>
    <Description>
        18.	If cap.Dot1XCapabilities.MaximumNumberOfDot1XConfigurations > 0:
          18.1. If cap.Dot1XCapabilities.Dot1XMethods list is empty, FAIL the test.


        Dot1XCapabilities.Dot1XMethods is empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
          <tas:Dot1XCapabilities MaximumNumberOfDot1XConfigurations="1">
          </tas:Dot1XCapabilities>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <!--Dot1XMethods-->
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.19_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Dot1XCapabilities.MaximumNumberOfDot1XConfigurations: Correct response</Name>
    <Description>
      19.	If cap.Dot1XCapabilities.Dot1XMethods list is not empty:
        19.1. If cap.Dot1XCapabilities.Dot1XMethods list does not contain “EAP-PEAP MSCHAPv2”, FAIL the test.
        19.2. If cap.Dot1XCapabilities.MaximumNumberOfDot1XConfigurations less or equal 0 or skipped, FAIL the test. 

        Dot1XCapabilities.Dot1XMethods contains “EAP-PEAP MSCHAPv2”
        Dot1XCapabilities.MaximumNumberOfDot1XConfigurations = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
          <tas:Dot1XCapabilities MaximumNumberOfDot1XConfigurations="1">
            <tas:Dot1XMethods>EAP-PEAP</tas:Dot1XMethods>
            <tas:Dot1XMethods>EAP-PEAP MSCHAPv2</tas:Dot1XMethods>
            <tas:Dot1XMethods>MSCHAPv2</tas:Dot1XMethods>
          </tas:Dot1XCapabilities>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.19_1_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Dot1XCapabilities.MaximumNumberOfDot1XConfigurations: invalid response Dot1XMethods (no “EAP-PEAP MSCHAPv2”)</Name>
    <Description>
      19.	If cap.Dot1XCapabilities.Dot1XMethods list is not empty:
        19.1. If cap.Dot1XCapabilities.Dot1XMethods list does not contain “EAP-PEAP MSCHAPv2”, FAIL the test.
        19.2. If cap.Dot1XCapabilities.MaximumNumberOfDot1XConfigurations less or equal 0 or skipped, FAIL the test. 

        Dot1XCapabilities.Dot1XMethods no “EAP-PEAP MSCHAPv2”
        Dot1XCapabilities.MaximumNumberOfDot1XConfigurations = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
          <tas:Dot1XCapabilities MaximumNumberOfDot1XConfigurations="1">
            <tas:Dot1XMethods>EAP-PEAP</tas:Dot1XMethods>
            <tas:Dot1XMethods>EAP-PEAP1 MSCHAPv2</tas:Dot1XMethods>
            <tas:Dot1XMethods>MSCHAPv2</tas:Dot1XMethods>
          </tas:Dot1XCapabilities>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.19_1_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Dot1XCapabilities.MaximumNumberOfDot1XConfigurations: invalid response Dot1XMethods (empty line)</Name>
    <Description>
      19.	If cap.Dot1XCapabilities.Dot1XMethods list is not empty:
        19.1. If cap.Dot1XCapabilities.Dot1XMethods list does not contain “EAP-PEAP MSCHAPv2”, FAIL the test.
        19.2. If cap.Dot1XCapabilities.MaximumNumberOfDot1XConfigurations less or equal 0 or skipped, FAIL the test. 

        Dot1XCapabilities.Dot1XMethods empty line
        Dot1XCapabilities.MaximumNumberOfDot1XConfigurations = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
          <tas:Dot1XCapabilities MaximumNumberOfDot1XConfigurations="1">
            <tas:Dot1XMethods/>
          </tas:Dot1XCapabilities>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.19_1_2" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Dot1XCapabilities.MaximumNumberOfDot1XConfigurations: invalid response Dot1XMethods (skipped)</Name>
    <Description>
      19.	If cap.Dot1XCapabilities.Dot1XMethods list is not empty:
        19.1. If cap.Dot1XCapabilities.Dot1XMethods list does not contain “EAP-PEAP MSCHAPv2”, FAIL the test.
        19.2. If cap.Dot1XCapabilities.MaximumNumberOfDot1XConfigurations less or equal 0 or skipped, FAIL the test. 

        Dot1XCapabilities.Dot1XMethods empty line
        Dot1XCapabilities.MaximumNumberOfDot1XConfigurations = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
          <tas:Dot1XCapabilities MaximumNumberOfDot1XConfigurations="1">
          </tas:Dot1XCapabilities>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.19_2_0" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Dot1XCapabilities.MaximumNumberOfDot1XConfigurations: invalid response MaximumNumberOfDot1XConfigurations (0)</Name>
    <Description>
      19.	If cap.Dot1XCapabilities.Dot1XMethods list is not empty:
        19.1. If cap.Dot1XCapabilities.Dot1XMethods list does not contain “EAP-PEAP MSCHAPv2”, FAIL the test.
        19.2. If cap.Dot1XCapabilities.MaximumNumberOfDot1XConfigurations less or equal 0 or skipped, FAIL the test. 

        Dot1XCapabilities.Dot1XMethods contains “EAP-PEAP MSCHAPv2”
        Dot1XCapabilities.MaximumNumberOfDot1XConfigurations = 0
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
          <tas:Dot1XCapabilities MaximumNumberOfDot1XConfigurations="0">
            <tas:Dot1XMethods>EAP-PEAP</tas:Dot1XMethods>
            <tas:Dot1XMethods>EAP-PEAP MSCHAPv2</tas:Dot1XMethods>
            <tas:Dot1XMethods>MSCHAPv2</tas:Dot1XMethods>
          </tas:Dot1XCapabilities>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>  
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.19_2_1" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>Dot1XCapabilities.MaximumNumberOfDot1XConfigurations: invalid response MaximumNumberOfDot1XConfigurations (skipped)</Name>
    <Description>
      19.	If cap.Dot1XCapabilities.Dot1XMethods list is not empty:
        19.1. If cap.Dot1XCapabilities.Dot1XMethods list does not contain “EAP-PEAP MSCHAPv2”, FAIL the test.
        19.2. If cap.Dot1XCapabilities.MaximumNumberOfDot1XConfigurations less or equal 0 or skipped, FAIL the test. 

        Dot1XCapabilities.Dot1XMethods contains “EAP-PEAP MSCHAPv2”
        Dot1XCapabilities.MaximumNumberOfDot1XConfigurations skipped
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities/>
          <tas:TLSServerCapabilities/>
          <tas:Dot1XCapabilities>
            <tas:Dot1XMethods>EAP-PEAP</tas:Dot1XMethods>
            <tas:Dot1XMethods>EAP-PEAP MSCHAPv2</tas:Dot1XMethods>
            <tas:Dot1XMethods>MSCHAPv2</tas:Dot1XMethods>
          </tas:Dot1XCapabilities>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.42" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>#1594: TLSServerSupported not empty and does not contain 1.0 value</Name>
    <Description>
      
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="2"
                                    MaximumNumberOfCRLs="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="false" TLSServerSupported="2.0" MaximumNumberOfTLSCertificationPathValidationPolicies="0" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-5-1-1.43" ONVIFTestID="ADVANCED_SECURITY-5-1-1" Enabled="true">
    <TestName>Advanced Security Service Capabilities</TestName>
    <Name>#1594: TLSServerSupported contains space as value (negative test)</Name>
    <Description>
      STEP 22 - Validating of TLSServerSupported value   
      Wrong value: TLSServerSupported doesn't contain at least one value when TLSServerSupported is not empty
      STEP FAILED

    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfCertificationPathValidationPolicies="2"
                                    MaximumNumberOfCRLs="1"
                                    SelfSignedCertificateCreationWithRSA="1"
                                    RSAKeyPairGeneration="true"
                                    RSAKeyLengths="1"
                                    MaximumNumberOfCertificates="2"
                                    MaximumNumberOfKeys="1"
                                    MaximumNumberOfCertificationPaths="2">
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.5</tas:algorithm>
            </tas:SignatureAlgorithms>
            <tas:SignatureAlgorithms>
              <tas:algorithm>1.2.840.113549.1.1.11</tas:algorithm>
            </tas:SignatureAlgorithms>

          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSClientAuthSupported="false" TLSServerSupported=" " MaximumNumberOfTLSCertificationPathValidationPolicies="0" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
</TestSuit>

