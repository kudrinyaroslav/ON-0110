<?xml version="1.0" encoding="utf-8"?>
<TestSuit Name="Device Management" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>Create RSA Key Pair - Status Using Polling</Name>
    <Description>
      TODO:
      - empty 
      - no 
    </Description>
  </Parameters>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.01" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Incorrect CreateRSAKeyPair structure</Name>
    <Description>
      Simulator sends not valid response to CreateRSAKeyPair command: EstimatedCreationTime element is upsent.

    </Description>
    <ExpectedResult>
      <TestSummary><![CDATA[
        ADVANCED_SECURITY-1-1-1 Create RSA Key Pair - Status Using Polling

   STEP 1 - Get Advanced Security service address
      Transmit done
      Receive done
      http://localhost:17934/ServiceAdvancedSecurity10/AdvancedSecurityService.asmx
   STEP PASSED

   STEP 2 - Check that the DUT returned Advanced Security service address
   STEP PASSED

   STEP 3 - Get Keystore Client service address
      Transmit done
      Receive done
      http://localhost:17934/ServiceAdvancedSecurity10/AdvancedSecurityService.asmx
   STEP PASSED

   STEP 4 - Check that the DUT returned Keystore Client service address
   STEP PASSED

   STEP 5 - Check that Advance Security Service is accessible
   STEP PASSED

   STEP 6 - Get Advanced Security Capabilities
      Transmit done
      Receive done
   STEP PASSED

   STEP 7 - Create RSA Key Pair of size '1' and with alias = 'TestKeyIDOfSize1'
      Transmit done
      Receive done
   STEP PASSED

   STEP 8 - Validate Estimated Creation Time format
      Estimated Creation Time is invalid: The string '' is not a valid TimeSpan value.
   STEP FAILED

TEST FAILED
]]></TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <!--<EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>-->
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <GetKeyStatusResponse xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeyStatus>ok</tas:KeyStatus>
        </GetKeyStatusResponse>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.02" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Correct response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>2</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID67</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="7">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID67</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID67</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.03" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Incorrect EstimatedCreationTime value</Name>
    <Description>
Simulator sends not valid EstimatedCreationTime value: PT0Y0M0DT0H0M30S instead of P0Y0M0DT0H0M30S
    </Description>
    <ExpectedResult>
      <TestSummary><![CDATA[
ADVANCED_SECURITY-1-1-1 Create RSA Key Pair - Status Using Polling

   STEP 1 - Get Advanced Security service address
      Transmit done
      Receive done
      http://localhost:17934/ServiceAdvancedSecurity10/AdvancedSecurityService.asmx
   STEP PASSED

   STEP 2 - Check that the DUT returned Advanced Security service address
   STEP PASSED

   STEP 3 - Get Keystore Client service address
      Transmit done
      Receive done
      http://localhost:17934/ServiceAdvancedSecurity10/AdvancedSecurityService.asmx
   STEP PASSED

   STEP 4 - Check that the DUT returned Keystore Client service address
   STEP PASSED

   STEP 5 - Check that Advance Security Service is accessible
   STEP PASSED

   STEP 6 - Get Advanced Security Capabilities
      Transmit done
      Receive done
   STEP PASSED

   STEP 7 - Create RSA Key Pair of size '1' and with alias = 'TestKeyIDOfSize1'
      Transmit done
      Receive done
   STEP PASSED

   STEP 8 - Validate Estimated Creation Time format
      Estimated Creation Time is invalid: The string 'PT0Y0M0DT0H0M30S' is not a valid TimeSpan value.
   STEP FAILED

TEST FAILED
]]></TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>PT0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.04" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>RSAKeyLengths is absent</Name>
    <Description>
      DUT sends incorrect response:
      GetServiceCapabilities with RSAKeyPairGeneration="true" and without RSAKeyLengths attribute
      (see https://wush.net/trac/onvif-ext/ticket/362)
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.05" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Empty RSAKeyLengths list</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths=""  PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.06" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Fault to GetServiceCapabilities</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.07" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>No response to GetServiceCapabilities</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.08" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Optional elements in GetServiceCapabilities are absent</Name>
    <Description>
      DUT sends correct GetServiceCapabilities response without optional elements and atributes:
      SignatureAlgorithms element is absent      
      Only RSAKeyPairGeneration and RSAKeyLengths attributes are presented


    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities RSAKeyPairGeneration="true" RSAKeyLengths="1">
            <!--<tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              -->
            <!--Optional:-->
            <!--
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              -->
            <!--Optional:-->
            <!--

            </tas:SignatureAlgorithms>-->
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities/>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.09" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>CreateRSAKeyPair: KeyID is absent</Name>
    <Description>
      DUT sends incorrect CreateRSAKeyPair response message: there is not KeyID  element
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <!--<string></string>-->
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.10" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>CreateRSAKeyPair: KeyID is absent</TestName>
    <Name>EstimatedCreationTime is empty</Name>
    <Description>
      DUT sends incorrect CreateRSAKeyPair response message: EstimatedCreationTime is empty
    </Description>
    <ExpectedResult>
      <TestSummary><![CDATA[
ADVANCED_SECURITY-1-1-1 Create RSA Key Pair - Status Using Polling

   STEP 1 - Get Advanced Security service address
      Transmit done
      Receive done
      http://localhost:17934/ServiceAdvancedSecurity10/AdvancedSecurityService.asmx
   STEP PASSED

   STEP 2 - Check that the DUT returned Advanced Security service address
   STEP PASSED

   STEP 3 - Get Keystore Client service address
      Transmit done
      Receive done
      http://localhost:17934/ServiceAdvancedSecurity10/AdvancedSecurityService.asmx
   STEP PASSED

   STEP 4 - Check that the DUT returned Keystore Client service address
   STEP PASSED

   STEP 5 - Check that Advance Security Service is accessible
   STEP PASSED

   STEP 6 - Get Advanced Security Capabilities
      Transmit done
      Receive done
   STEP PASSED

   STEP 7 - Create RSA Key Pair of size '1' and with alias = 'TestKeyIDOfSize1'
      Transmit done
      Receive done
   STEP PASSED

   STEP 8 - Validate Estimated Creation Time format
      Estimated Creation Time is invalid: The string '' is not a valid TimeSpan value.
   STEP FAILED

TEST FAILED
]]></TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>I:D1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>
        </EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.11" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>EstimatedCreationTime=0</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M0S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.12" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Fault to CreateRSAKeyPair</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <Subcode>Action</Subcode>
      <Subcode>MaximumNumberOfKeysReached</Subcode>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>T0H0M10S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.13" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>No response to CreateRSAKeyPair</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>NoResponse</Response>
      <Code>Receiver</Code>
      <Subcode>Action</Subcode>
      <Subcode>MaximumNumberOfKeysReached</Subcode>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>T0H0M10S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.14" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Incorrect GetKeyStatus sructure: keyStatus element is absent</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>ok</string>-->
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.15" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Fault to GetKeyStatus request</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M5S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>KeyID</Subcode>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.16" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>No response to GetKeyStatus request</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M5S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.17" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Corrupt key status</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M5S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>corrupt</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.18" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>No Ok status during operation dely time</Name>
    <Description>
Set operation delay time to 30s
Check that TT will wait for Ok status og key during opration delai time
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M0S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>other</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.19" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Ok status is received at second attempt</Name>
    <Description>
      Set operation delay time to 30s
      Check that TT will wait for Ok status og key during opration delai time
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M5S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>other</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.20" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Long EstimatedCreationTime</Name>
    <Description>
      Set OperationDelay time to 15s
      EstimatedCreationTime &gt; Operation delay time
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT1H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.21" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Fault to DeleteKey</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M5S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.22" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>No response to DeleteKey</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M5S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.23" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>EstimatedCreationTime with ms</Name>
    <Description>
      EstimatedCreationTime = P0Y0M0DT0H0M0.005S
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID12345</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M0.005S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID12345</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>2</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID67</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="7">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID67</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID67</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.24" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>Incorrect ID value</Name>
    <Description>
      According to xml schema: xs:ID type derives from NCName type:
      NCName	   ::=   	Name - (Char* ':' Char*)	/* An XML Name, minus the ":" */
      
      DUT returns key ID with ':' char

    </Description>
    <ExpectedResult>
      <TestSummary>
        <![CDATA[
      ADVANCED_SECURITY-1-1-1 Create RSA Key Pair - Status Using Polling

   STEP 1 - Get Advanced Security service address
      Transmit done
      Receive done
      http://localhost:17934/ServiceAdvancedSecurity10/AdvancedSecurityService.asmx
   STEP PASSED

   STEP 2 - Check that the DUT returned Advanced Security service address
   STEP PASSED

   STEP 3 - Get Keystore Client service address
      Transmit done
      Receive done
      http://localhost:17934/ServiceAdvancedSecurity10/AdvancedSecurityService.asmx
   STEP PASSED

   STEP 4 - Check that the DUT returned Keystore Client service address
   STEP PASSED

   STEP 5 - Check that Advance Security Service is accessible
   STEP PASSED

   STEP 6 - Get Advanced Security Capabilities
      Transmit done
      Receive done
   STEP PASSED

   STEP 7 - Check the set of supported RSA key's length isn't empty
   STEP PASSED

   STEP 8 - Create RSA Key Pair of size '1' and without alias
      Transmit done
      Receive done
      The 'http://www.onvif.org/ver10/advancedsecurity/wsdl:KeyID' element is invalid - The value 'I:D1' is invalid according to its datatype 'http://www.onvif.org/ver10/advancedsecurity/wsdl:KeyID' - The ':' character, hexadecimal value 0x3A, cannot be included in a name.
   STEP FAILED

TEST FAILED

]]>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1 2" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>I:D1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M0.6S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="7">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID67</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID67</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID="TC.ADVANCED_SECURITY-1-1-1.25" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>[Ticket 486] Correct response with RSAKeyLengths less or equal to 4096</Name>
    <Description>
      There's RSAKeyLengths = 1024, 2048, 4096, 4097, 5120
      4097 and 5120 should not be used
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="1024 2048 4096 4097 5120" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>1024</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID1024</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID1024</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID1024</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>2048</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID2048</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="7">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID2048</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID2048</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>4096</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID4096</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="10">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID4096</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID4096</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.ADVANCED_SECURITY-1-1-1.26" ONVIFTestID="ADVANCED_SECURITY-1-1-1" Enabled="true">
    <TestName>Create RSA Key Pair - Status Using Polling</TestName>
    <Name>[Ticket 486] Correct response with RSAKeyLengths more than 4096</Name>
    <Description>
      There's RSAKeyLengths = 6144, 7168, 5120
      only 5120 should be used
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>AdvancedSecurity10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:KeystoreCapabilities MaximumNumberOfKeys="2" MaximumNumberOfCertificates="2" MaximumNumberOfCertificationPaths="2" RSAKeyPairGeneration="true" RSAKeyLengths="6144 7168 5120" PKCS10ExternalCertificationWithRSA="true" SelfSignedCertificateCreationWithRSA="true" X509Versions="3 4 5">
            <tas:SignatureAlgorithms>
              <tas:algorithm>9</tas:algorithm>
              <!--Optional:-->
              <tas:parameters>AEIMQUYcgkosw048</tas:parameters>
              <!--Optional:-->
            </tas:SignatureAlgorithms>
          </tas:KeystoreCapabilities>
          <tas:TLSServerCapabilities TLSServerSupported="true" MaximumNumberOfTLSCertificationPaths="2" />
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.CreateRSAKeyPair</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyLength>5120</KeyLength>
      </RequestParameters>
      <ResponseParameters>
        <string>KeyID5120</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <EstimatedCreationTime>P0Y0M0DT0H0M30S</EstimatedCreationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AdvancedSecurity10.GetKeyStatus</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID5120</KeyID>
      </RequestParameters>
      <ResponseParameters>
        <string>ok</string>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>KeyID5120</KeyID>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
</TestSuit>