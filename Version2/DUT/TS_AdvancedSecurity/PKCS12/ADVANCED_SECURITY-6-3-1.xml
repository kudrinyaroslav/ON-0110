<?xml version="1.0" encoding="utf-8"?>
<TestSuit Name="Device Management" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</Name>
    <Description>
      TODO:
      - empty
      - no
    </Description>
  </Parameters>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.01" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>Correct response</Name>
    <Description>
      The DUT sends all correct responses
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>  
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
    </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.GetCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>
        <X509Certificate xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:KeyID>keyID1</tas:KeyID>
          <tas:Alias>Alias</tas:Alias>
          <tas:CertificateContent>MIICvjCCAaagAwIBAgICA64wDQYJKoZIhvcNAQELBQAwITESMBAGA1UEAwwJMTI3LjAuMC4xMQswCQYDVQQGEwJVUzAgFw0xMzA5MTIxNDIxMTBaGA8zMDEzMDkxMzE0MjExMFowITESMBAGA1UEAwwJMTI3LjAuMC4xMQswCQYDVQQGEwJVUzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKt1aK/wnJuQEYRfn53ji+F1DQpcX6rgZefGI2DeYdDw1YvyuVEnhk9lXESXYf2c1Kj9hYooMTNd0dwXdeBRWkbVop6+ojY03vfcRV3VlWRZ34mTmdyzuqRC0V3UrNko6CdHMhJ64UxpzzdsAsluszmasZBTxK0eP57qiFwXMPW+rREF++V1WfQ6BmrJBphzTHjAF4dZAuJ9SXv90PSFyuvg0UKI6S7WpW4LU8DixlOb4f/Keb4CYIAe73rO5hbLLgT5TrNvqhmMoZll1mu5HmWRDD/N76AWr6j+AjTrIRQnUwHaCi4C1HhLIBesvfRqiXUjFbgmRtjQgW5txKYSencCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAb7JeA7H4ZgV208ElhklbopvrAf2Z5dRptJS0/DAub4yoL+b3Asx1tR2/169YTaYiI1hzZ4yY+eeda67Z0rcdJ7/dSUOyk5c7dMZCKEzcX6HP0zXAHy8huQB5y6FBznCmcUTTbJgOiOFNjkLzsKBXVCJ8P1cqJiXcnX4kxDg+RPATHQogdjXLt4VclZJ2Sd8oUlAqbVv3WxjDg5c88PjR05qWo12+7x4dVmhx3MlVQjprsvi0GzO1V20HnzHNJA77+UqP9ENe+IIRWebrIs6xpGRmdpz7oQAWW6KT85P8GuwnPeWXglNPXoPvlFIyRkCbkxZxfb63Ayjgopwc0uueqQ==</tas:CertificateContent>

        </X509Certificate>
      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.02" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetServices - no Advanced Security service</Name>
    <Description>
      The DUT do not support Advanced Security Service
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

        </ArrayOfService>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.03" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetServices - no response</Name>
    <Description>
      The DUT did not send GetServicesResponse message
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.04" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>UploadCertificateWithPrivateKeyInPKCS12 - empty CertificationPathID</Name>
    <Description>
      The DUT sends empty CertificationPathID field at
      UploadCertificateWithPrivateKeyInPKCS12Response message
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string></string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.05" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>UploadCertificateWithPrivateKeyInPKCS12 - empty KeyID</Name>
    <Description>
      The DUT sends empty KeyID field at
      UploadCertificateWithPrivateKeyInPKCS12Response message
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>CertificationPathID</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID> </KeyID>
      </ResponseParametersAdditional>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.06" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>UploadCertificateWithPrivateKeyInPKCS12 - no response</Name>
    <Description>
      The DUT do not send UploadCertificateWithPrivateKeyInPKCS12Response message
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>CertificationPathID</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID></KeyID>
      </ResponseParametersAdditional>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.07" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>UploadCertificateWithPrivateKeyInPKCS12 - SOAP 1.2 fault message</Name>
    <Description>
      The DUT sends sends SOAP 1.2 fault message to
      UploadCertificateWithPrivateKeyInPKCS12 request
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>BadPCKS12File</Subcode>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>CertificationPathID</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID></KeyID>
      </ResponseParametersAdditional>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.08" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - no expected key ID in list</Name>
    <Description>
      The DUT does not send expexted Key ID at GetAllKeysResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.09" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - wrong Alias</Name>
    <Description>
      The DUT sends wrong Alias to expexted Key ID
      at GetAllKeysResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test1</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.10" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - no Alias</Name>
    <Description>
      The DUT does not send Alias to expexted Key ID
      at GetAllKeysResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.11" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - wrong hasPrivateKey</Name>
    <Description>
      The DUT sends hasPrivateKey="false" to expexted Key ID
      at GetAllKeysResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>false</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.12" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - no hasPrivateKey</Name>
    <Description>
      The DUT does not send hasPrivateKey attribute to expexted Key ID
      at GetAllKeysResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.13" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - KeyStatus="corrupt"</Name>
    <Description>
      The DUT sends KeyStatus="corrupt" to expexted Key ID
      at GetAllKeysResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>corrupt</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.14" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - KeyStatus="generating"</Name>
    <Description>
      The DUT sends KeyStatus="generating" to expexted Key ID
      at GetAllKeysResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>generating</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.15" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - no response</Name>
    <Description>
      The DUT does not send GetAllKeysResponse message
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>generating</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.16" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllKeys - SOAP 1.2 Fault message</Name>
    <Description>
      The DUT sends SOAP 1.2 Fault message to GetAllKeys request
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.17" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllCertificationPaths - no expected Certification Path ID</Name>
    <Description>
      The DUT does not send expexted Certification Path ID
      at GetAllCertificationPathsResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <!--<Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>-->
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.18" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllCertificationPaths - no response</Name>
    <Description>
      The DUT does not send GetAllCertificationPathsResponse message
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <!--<Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>-->
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.19" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetAllCertificationPaths - fault</Name>
    <Description>
      The DUT sends fault to GetAllCertificationPaths message
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <!--<Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>-->
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.20" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetCertificationPath - 2 certificate IDs</Name>
    <Description>
      The DUT sends GetCertificationPath response with 2 certificate IDs
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:CertificateID>certificateID2</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.21" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetCertificationPath - 3 certificate IDs</Name>
    <Description>
      The DUT sends GetCertificationPath response with 3 certificate IDs
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:CertificateID>certificateID2</tas:CertificateID>
          <tas:CertificateID>certificateID3</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.22" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetCertificationPath - wrong Alias</Name>
    <Description>
      The DUT sends GetCertificationPath response with unexpected Alias
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test1</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.23" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetCertificationPath - no Alias</Name>
    <Description>
      The DUT sends GetCertificationPath response without expected Alias
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>

        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.24" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetCertificationPath - no response</Name>
    <Description>
      The DUT does not send GetCertificationPathResponse mesage
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>

        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.25" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>GetCertificationPath - fault</Name>
    <Description>
      The DUT sends SOAP 1.2 Fault message to GetCertificationPath
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>CertificationPathID</Subcode>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>

        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.26" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>DeleteCertificationPath - no response</Name>
    <Description>
      The DUT sends no DeleteCertificationPathResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.27" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>DeleteCertificationPath - Fault message</Name>
    <Description>
      
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <Subcode>Action</Subcode>
      <Subcode>NotSupported</Subcode>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.28" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>DeleteCertificate - no response</Name>
    <Description>
      The DUT sends no DeleteCertificateResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.29" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>DeleteCertificate - Fault message</Name>
    <Description>

    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <Subcode>Action</Subcode>
      <Subcode>NotSupported</Subcode>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.30" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>DeleteKey - no response</Name>
    <Description>
      The DUT sends no DeleteKeyResponse
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.31" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>DeleteKey - Fault message</Name>
    <Description>

    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>T123</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>T1</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <tas:any>any</tas:any>
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID</tas:KeyID>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <Subcode>Action</Subcode>
      <Subcode>NotSupported</Subcode>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.S01" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>Shema check for KeyAttributes - externallyGenerated</Name>
    <Description>
      The DUT sends GetAllKeysResponse:
      KeyAttribute does not contain 'externallyGenerated' field
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <!--<tas:externallyGenerated>true</tas:externallyGenerated>-->
            <tas:securelyStored>false</tas:securelyStored>
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.ADVANCED_SECURITY-6-3-1.S02" ONVIFTestID="ADVANCED_SECURITY-6-3-1" Enabled="true">
    <TestName>ADVANCED_SECURITY-6-3-1 Upload PKCS12 - no key pair exists</TestName>
    <Name>Shema check for KeyAttributes - securelyStored</Name>
    <Description>
      The DUT sends GetAllKeysResponse:
      KeyAttribute does not contain 'securelyStored' field
    </Description>
    <ExpectedResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>

          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/advancedsecurity/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>AdvancedSecurity10.UploadCertificateWithPrivateKeyInPKCS12</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertWithPrivateKey></CertWithPrivateKey>
        <CertificationPathAlias>ONVIF_Certification_Path_Test</CertificationPathAlias>
        <KeyAlias>ONVIF_Key_Test</KeyAlias>
        <IgnoreAdditionalCertificates>true</IgnoreAdditionalCertificates>
      </RequestParameters>
      <ResponseParameters>
        <string>certPathID1</string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <KeyID>keyID1</KeyID>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>AdvancedSecurity10.GetAllKeys</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfKeyAttribute xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <KeyAttribute>
            <tas:KeyID>keyID1</tas:KeyID>
            <tas:Alias>ONVIF_Key_Test</tas:Alias>
            <tas:hasPrivateKey>true</tas:hasPrivateKey>
            <tas:KeyStatus>ok</tas:KeyStatus>
            <tas:externallyGenerated>true</tas:externallyGenerated>
            <!--<tas:securelyStored>false</tas:securelyStored>-->
            <!--<tas:any>any</tas:any>-->
          </KeyAttribute>
        </ArrayOfKeyAttribute>
      </ResponseParameters>
    </Step>
    <Step id ="4">
      <Command>AdvancedSecurity10.GetAllCertificationPaths</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfString xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <string>certPathID1</string>
          <string>newPathID</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="5">
      <Command>AdvancedSecurity10.GetCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>
        <CertificationPath xmlns:tas="http://www.onvif.org/ver10/advancedsecurity/wsdl">
          <tas:CertificateID>certificateID1</tas:CertificateID>
          <tas:Alias>ONVIF_Certification_Path_Test</tas:Alias>
        </CertificationPath>
      </ResponseParameters>
    </Step>
    <Step id ="6">
      <Command>AdvancedSecurity10.DeleteCertificationPath</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificationPathID>certPathID1</CertificationPathID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="7">
      <Command>AdvancedSecurity10.DeleteCertificate</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CertificateID>certificateID1</CertificateID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
    <Step id ="8">
      <Command>AdvancedSecurity10.DeleteKey</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <KeyID>keyID1</KeyID>
      </RequestParameters>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
</TestSuit>

