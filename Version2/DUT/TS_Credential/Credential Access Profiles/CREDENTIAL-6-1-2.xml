<?xml version="1.0" encoding="utf-8"?>
<TestSuit Name="Draft Capabilities" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</Name>
    <Description>

      
    </Description>
  </Parameters>
  <!--CredentialAccessProfileValiditySupported="false"-->
  <Test ID="TC.CREDENTIAL-6-1-2.01" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.02" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.02_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>AccessControl is not supported
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>AccessProfile1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--CredentialAccessProfileValiditySupported="true"-->
  <Test ID="TC.CREDENTIAL-6-1-2.03" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response</Name>
    <Description>
      ValiditySupportsTimeValue="true"
      CredentialAccessProfileValiditySupported="true"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.04" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
      ValiditySupportsTimeValue="true"
      CredentialAccessProfileValiditySupported="true"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.04_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response</Name>
    <Description>
      ValiditySupportsTimeValue="false" (only date in fields ValidFrom and ValidTo is compared)
      CredentialAccessProfileValiditySupported="true"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="10">
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.04_3" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
      ValiditySupportsTimeValue="false" (only date in fields ValidFrom and ValidTo is compared)
      CredentialAccessProfileValiditySupported="true"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="10">
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.04_4" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>
      accesscontrol is not supported
      CredentialAccessProfileValiditySupported="true"
      ValiditySupportsTimeValue="false"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>AccessProfile1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Annex A.3-->
  <!--A.3: GetCredentialList fails-->
  <Test ID="TC.CREDENTIAL-6-1-2.05" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>GetCredentialList fails</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>

  </Test>
  <!--Annex A.7-->
  <!--A.7: GetServiceCapabilities fails-->
  <Test ID="TC.CREDENTIAL-6-1-2.06" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>GetServiceCapabilities fails</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>

  </Test>
  <!--A.7: no response to GetServiceCapabilities-->
  <Test ID="TC.CREDENTIAL-6-1-2.07" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>no response to GetServiceCapabilities</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>

  </Test>
  <!--A.7: no response to GetCredentials 8 -->
  <Test ID="TC.CREDENTIAL-6-1-2.08" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
      GetCredentials: no response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--A.7: Fail to GetCredentials 9 -->
  <Test ID="TC.CREDENTIAL-6-1-2.09" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
      GetCredentials: fails
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--A.7: no response to DeleteCredential 10-->
  <Test ID="TC.CREDENTIAL-6-1-2.10" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
      DeleteCredential 1: no response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--A.7: fail to DeleteCredential 11-->
  <Test ID="TC.CREDENTIAL-6-1-2.11" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
      DeleteCredential 1: fail
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--A7: fail to GetCredentialState-->
  <Test ID="TC.CREDENTIAL-6-1-2.12" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
      GetCredentialState: fails
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.12_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response (with deleting of credential)</Name>
    <Description>
      GetCredentialState: no response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Annex A.5-->
  <!--A.5: no response to GetAccessProfileList-->
  <Test ID="TC.CREDENTIAL-6-1-2.13" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>A.5: no response to GetAccessProfileList</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <!--A.5: fault to GetAccessProfileList-->
  <Test ID="TC.CREDENTIAL-6-1-2.14" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>A.5: fault to GetAccessProfileList</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <!--CreatePullPointSubscription-->
  <Test ID="TC.CREDENTIAL-6-1-2.15" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>CreatePullPointSubscription: no response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.15_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>CreatePullPointSubscription: fails</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  
  <!--PullMessage-->
  <Test ID="TC.CREDENTIAL-6-1-2.16" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>no response to PullMessage</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.17" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name> PullMessage fails</Name>
  <Description>
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Fault</Response>
    <Code>Sender</Code>
    <Subcode>InvalidArgVal</Subcode>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.18" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>PullMessage: message is null, in the second message is ok</Name>
  <Description>
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>PASSED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
    <Step id="14">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.19" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>PullMessage: TopicExpression is not equal to “tns1:Configuration/Credential/Changed”</Name>
  <Description>
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Created</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.20" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>PullMessage: no Source.SimpleItem item with Name =: "CredentialToken"</Name>
  <Description>
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken1" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.21" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>PullMessage: Source.SimpleItem item with Name =: "CredentialToken" has wrong Value</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  
  <!--GetCredentialAccessProfiles failure and no response-->
  <Test ID="TC.CREDENTIAL-6-1-2.22" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>GetCredentialAccessProfiles fails</Name>
  <Description>
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Fault</Response>
    <Code>Sender</Code>
    <Subcode>InvalidArgVal</Subcode>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.23" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>GetCredentialAccessProfiles no response</Name>
  <Description>
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>NoResponse</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>

  <!--Test-->
  <Test ID="TC.CREDENTIAL-6-1-2.24" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>GetCredentialAccessProfilesResponse contains other AccessProfile token</Name>
  <Description>
    CredentialAccessProfileValiditySupported="false"
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile2</tac:AccessProfileToken>
          <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.25" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>credentialAccessProfileList contains more than one CredentialAccessProfile</Name>
    <Description>
      CredentialAccessProfileValiditySupported="false"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile2</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.26" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name> credentialAccessProfileList contains less than one CredentialAccessProfile (empty)</Name>
    <Description>
      CredentialAccessProfileValiditySupported="false"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.27" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>GetCredentialAccessProfilesResponse validTo and validFrom are inconsistent (are present, while in Set... were not)</Name>
  <Description>
    CredentialAccessProfileValiditySupported="false"
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.28" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>GetCredentialAccessProfilesResponse validTo and validFrom are inconsistent (are not present, while in Set... were)</Name>
  <Description>
    CredentialAccessProfileValiditySupported="true"
    ValiditySupportsTimeValue="true"
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
        <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
        <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.29" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>GetCredentialAccessProfilesResponse validTo and validFrom are inconsistent (are not present, while in Set... were)</Name>
    <Description>
      CredentialAccessProfileValiditySupported="true"
      ValiditySupportsTimeValue="false"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.30" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
  <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
  <Name>GetCredentialAccessProfilesResponse validTo and validFrom are inconsistent (other values than in Set)</Name>
  <Description>
    both ValidFrom and ValidTo are inconsistent
    CredentialAccessProfileValiditySupported="true" 
    ValiditySupportsTimeValue="true"
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>
    </TestSummary>
  </ExpectedResult>
  <Step id="1">
    <Command>Device10.GetCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Category>Events</Category>
    </RequestParameters>
    <ResponseParameters special="1">
      <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        <tt:Events>
          <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
          <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
          <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
          <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
        </tt:Events>
      </Capabilities>
    </ResponseParameters>
  </Step>
  <Step id="2">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>
  <Step id="3">
    <Command>AccessRules10.GetAccessProfileList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        <AccessProfile token="AccessProfile1">
          <tar:Name>Access Profile 1</tar:Name>
          <tar:Description>Access Profile 1 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile2">
          <tar:Name>Access Profile 2</tar:Name>
          <tar:Description>Access Profile 2 Description</tar:Description>
        </AccessProfile>
        <AccessProfile token="AccessProfile3">
          <tar:Name>Access Profile 3</tar:Name>
          <tar:Description>Access Profile 3 Description</tar:Description>
        </AccessProfile>
      </ArrayOfAccessProfile>
    </ResponseParametersAdditional>
  </Step>
  <Step id="4">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
        <Credential token="Credential3">
          <tac:Name>Credential 3</tac:Name>
          <tac:Description>Credential 3 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND26</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>1234</tac:Value>
          </tac:CredentialIdentifier>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>
  <Step id="5">
    <Command>Credential10.GetServiceCapabilities</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
        <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
        <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
      </ServiceCapabilities>
    </ResponseParameters>
  </Step>
  <Step id="6">
    <Command>Credential10.GetCredentials</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          <tac:CredentialIdentifier>
            <tac:Type>
              <tac:Name>ONVIFCard</tac:Name>
              <tac:FormatType>WIEGAND37</tac:FormatType>
            </tac:Type>
            <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
            <tac:Value>123434</tac:Value>
          </tac:CredentialIdentifier>
          <tac:CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          </tac:CredentialAccessProfile>
          <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
      </ArrayOfCredential>
    </ResponseParameters>
  </Step>
  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>true</tac:Enabled>
        <tac:Reason>Credential 1 Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>
  <Step id="8">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="9">
    <Command>Credential10.GetSupportedFormatTypes</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND26</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
        <CredentialIdentifierFormatTypeInfo>
          <tac:FormatType>WIEGAND37</tac:FormatType>
          <tac:Description>Description</tac:Description>
        </CredentialIdentifierFormatTypeInfo>
      </ArrayOfCredentialIdentifierFormatTypeInfo>
    </ResponseParameters>
  </Step>
  <Step id="10">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="TestToken">
        <Description>Test Description</Description>
        <CredentialHolderReference>TestUser</CredentialHolderReference>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>TestToken</string>
    </ResponseParameters>
  </Step>
  <Step id="11">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2">
      <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters />
        <wsa:Metadata />
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>
  <Step id="12">
    <Command>Credential10.SetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <CredentialToken>TestToken</CredentialToken>
      <CredentialAccessProfile>
        <AccessProfileToken>AccessProfile1</AccessProfileToken>
        <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
        <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
      </CredentialAccessProfile>
    </RequestParameters>
    <ResponseParameters>
      <!--<string>TestToken</string>-->
    </ResponseParameters>
  </Step>
  <Step id="13">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now">
      </CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
              </tt:Source>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>
  <Step id="14">
    <Command>Credential10.GetCredentialAccessProfiles</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
      <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <CredentialAccessProfile>
          <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
          <tac:ValidFrom>2015-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
          <tac:ValidTo>2016-12-08T15:49:28.3611347+07:00</tac:ValidTo>
        </CredentialAccessProfile>
      </ArrayOfCredentialAccessProfile>
    </ResponseParameters>
  </Step>
  <Step id="15">
    <Command>Credential10.DeleteCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>TestToken</Token>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
  <Step id="16">
    <Command>Credential10.CreateCredential</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Credential token="">
        <Description>Credential 1 Description</Description>
        <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
        <CredentialIdentifier>
          <Type>
            <Name>ONVIFCard</Name>
          </Type>
          <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
        </CredentialIdentifier>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
        <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
      </Credential>
      <State>
        <Enabled>true</Enabled>
        <Reason>Test Reason</Reason>
        <AntipassbackState>
          <AntipassbackViolated>false</AntipassbackViolated>
        </AntipassbackState>
      </State>
    </RequestParameters>
    <ResponseParameters>
      <string>Credential1</string>
    </ResponseParameters>
  </Step>
  <Step id="17">
    <Command>SMSUnsubscribe</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
    </ResponseParameters>
  </Step>
</Test>
  <Test ID="TC.CREDENTIAL-6-1-2.31" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>GetCredentialAccessProfilesResponse validTo and validFrom are inconsistent (other values than in Set)</Name>
    <Description>
      ValidTo is inconsistent
      CredentialAccessProfileValiditySupported="true"
      ValiditySupportsTimeValue="true"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="2">
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2015-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2016-12-08T15:49:28.3611347+07:00</tac:ValidTo>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.32" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>GetCredentialAccessProfilesResponse validTo and validFrom are inconsistent (other values than in Set)</Name>
    <Description>
      ValidTo is inconsistent
      CredentialAccessProfileValiditySupported="true"
      ValiditySupportsTimeValue="false" (only Date is compared)
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="20">
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2015-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2016-12-08T15:49:28.3611347+07:00</tac:ValidTo>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.33" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>GetCredentialAccessProfilesResponse contains other AccessProfile token</Name>
    <Description>
      CredentialAccessProfileValiditySupported="true"
      ValiditySupportsTimeValue="false"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile2</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.34" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>credentialAccessProfileList contains more than one CredentialAccessProfile</Name>
    <Description>
      CredentialAccessProfileValiditySupported="true"
      ValiditySupportsTimeValue="false"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile2</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.35" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name> credentialAccessProfileList contains less than one CredentialAccessProfile (empty)</Name>
    <Description>
      CredentialAccessProfileValiditySupported="true"
      ValiditySupportsTimeValue="false"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="false" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>123434</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>Credential1</string>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.36" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>ValidFrom and ValidTo - difference in milliseconds</Name>
    <Description>
      ValiditySupportsTimeValue="true"
      CredentialAccessProfileValiditySupported="true"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" ValiditySupportsTimeValue="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
          <ValidFrom>2014-12-08T15:49:28.3611347+07:00</ValidFrom>
          <ValidTo>2015-12-08T15:49:28.3611347+07:00</ValidTo>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="10">
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--GetSupportedFormatTypes-->
  <Test ID="TC.CREDENTIAL-6-1-2.37" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>GetSupportedFormatTypes: no response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.37_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>GetSupportedFormatTypes: fails</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--CreateAccessProfile-->
  <Test ID="TC.CREDENTIAL-6-1-2.38_1" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Empty access profile list, +create accessprofile</Name>
    <Description>
      CreateAccessProfile: no response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>NoResponse</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.38_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Empty access profile list, +create accessprofile</Name>
    <Description>
      CreateAccessProfile: fails
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--CreateCredential-->
  <Test ID="TC.CREDENTIAL-6-1-2.39_1" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>CreateCredential: no response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.39_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>CreateCredential: fails</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--SetCredentialAccessProfiles-->
  <Test ID="TC.CREDENTIAL-6-1-2.40_1" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>SetCredentialAccessProfiles: no response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.40_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>SetCredentialAccessProfiles: fails</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--Check DeleteAccessProfile-->
  <Test ID="TC.CREDENTIAL-6-1-2.41_1" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>
      DeleteAccessProfile: no response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>AccessProfile1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.41_2" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>
      DeleteAccessProfile: fails
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <RequestParameters>
        <Token>AccessProfile1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.41_3" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>
      GetAccessProfileList - fails
      DeleteAccessProfile is absent (there should be no DeleteAccessProfile command in test)
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <!--<Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>AccessProfile1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>-->
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.41_4" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>
      CreateAccessProfile - no response
      DeleteAccessProfile is absent (there should be no DeleteAccessProfile command in test)
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>

    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>NoResponse</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <!--<Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>AccessProfile1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>-->
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.41_5" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>
      GetCredentialList - no response
      DeleteAccessProfile is absent (there should BE a DeleteAccessProfile command in test)
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>

    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>testProfile</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>testProfile</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--zorba: check additional fields in PullMessageResponse-->
  <Test ID="TC.CREDENTIAL-6-1-2.500" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response</Name>
    <Description>
      check additional fields in PullMessageResponse
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                  <tt:ElementItem Name="TestItem">
                    <element xmlns="new">any</element>
                  </tt:ElementItem>
                </tt:Source>
                <tt:Key>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                  <tt:Extension>
                    <element xmlns="new">element1</element>
                  </tt:Extension>
                </tt:Key>
                <tt:Data>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--#978 AccessControl service is not supported-->
  <Test ID="TC.CREDENTIAL-6-1-2.600" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>
      accesscontrol is supported, schedule list is empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accesscontrol/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Schedule10.GetScheduleList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfSchedule xmlns:tsc="http://www.onvif.org/ver10/schedule/wsdl">

        </ArrayOfSchedule>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PACS12.GetAccessPointInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Limit>1</Limit>
      </RequestParameters>
      <ResponseParameters>
        <string></string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessPointInfo xmlns:tac="http://www.onvif.org/ver10/accesscontrol/wsdl">
          <AccessPointInfo token="tokenAccess1">
            <tac:Name>Access1 Name</tac:Name>
            <tac:Description>Access1 Description</tac:Description>
            <tac:Entity>Door</tac:Entity>
            <tac:Capabilities DisableAccessPoint="true" Duress="true" AccessTaken="true" ExternalAuthorization="true" Tamper="true" AnonymousAccess="true"></tac:Capabilities>
          </AccessPointInfo>
        </ArrayOfAccessPointInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:Name>Test Access Profile</tac:Name>
            <tac:Description>Test Description</tac:Description>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>AccessProfile1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-6-1-2.601" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response: Empty access profile list, +create accessprofile</Name>
    <Description>
      accesscontrol is supported, schedule list is not empty
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accesscontrol/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <!--<AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>-->
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Schedule10.GetScheduleList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfSchedule xmlns:tsc="http://www.onvif.org/ver10/schedule/wsdl">
          <Schedule token="Schedule1">
            <tsc:Name>Name1</tsc:Name>
            <tsc:Description>Description1</tsc:Description>
            <tsc:Standard>schedule standard</tsc:Standard>
            <tsc:SpecialDays>
              <tsc:GroupToken>specialdaygroup1</tsc:GroupToken>
              <tsc:TimeRange>
                <tsc:From>10:06:34.3266666+03:00</tsc:From>
              </tsc:TimeRange>
              <tsc:TimeRange>
                <tsc:From>10:06:34.3266666+03:00</tsc:From>
              </tsc:TimeRange>
            </tsc:SpecialDays>
            <tsc:SpecialDays>
              <tsc:GroupToken>specialdaygroup2</tsc:GroupToken>
              <tsc:TimeRange>
                <tsc:From>12:12:12.0000000+03:00</tsc:From>
              </tsc:TimeRange>
              <tsc:TimeRange>
                <tsc:From>11:11:11.0000000+03:00</tsc:From>
              </tsc:TimeRange>
            </tsc:SpecialDays>
          </Schedule>
        </ArrayOfSchedule>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PACS12.GetAccessPointInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Limit>1</Limit>
      </RequestParameters>
      <ResponseParameters>
        <string></string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessPointInfo xmlns:tac="http://www.onvif.org/ver10/accesscontrol/wsdl">
          <AccessPointInfo token="tokenAccess1">
            <tac:Name>Access1 Name</tac:Name>
            <tac:Description>Access1 Description</tac:Description>
            <tac:Entity>Door</tac:Entity>
            <tac:Capabilities DisableAccessPoint="true" Duress="true" AccessTaken="true" ExternalAuthorization="true" Tamper="true" AnonymousAccess="true"></tac:Capabilities>
          </AccessPointInfo>
        </ArrayOfAccessPointInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>AccessRules10.CreateAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>

      </RequestParameters>
      <ResponseParameters>

        <string>AccessProfile1</string>

      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <tac:Name>Test Access Profile</tac:Name>
            <tac:Description>Test Description</tac:Description>
            <tac:AccessPolicy>
              <tac:ScheduleToken>Schedule1</tac:ScheduleToken>
              <tac:Entity>tokenAccess1</tac:Entity>
            </tac:AccessPolicy>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="15">
      <Command>AccessRules10.DeleteAccessProfile</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>AccessProfile1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--#975 antipassback not supported-->
  <Test ID="TC.CREDENTIAL-6-1-2.700" ONVIFTestID="CREDENTIAL-6-1-2" Enabled="true">
    <TestName>CREDENTIAL-6-1-2 SET CREDENTIAL ACCESS PROFILES – ADDING NEW ACCESS PROFILE</TestName>
    <Name>Correct response</Name>
    <Description>
      antipassback not supported
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="5">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="false" MaxCredentials="10" 
                             MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="false" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>

        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.SetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialToken>TestToken</CredentialToken>
        <CredentialAccessProfile>
          <AccessProfileToken>AccessProfile1</AccessProfileToken>
        </CredentialAccessProfile>
      </RequestParameters>
      <ResponseParameters>
        <!--<string>TestToken</string>-->
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialAccessProfiles</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialAccessProfile xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialAccessProfile>
            <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            <!--<tac:ValidFrom>2014-12-08T15:49:28.3611347+07:00</tac:ValidFrom>
            <tac:ValidTo>2015-12-08T15:49:28.3611347+07:00</tac:ValidTo>-->
          </CredentialAccessProfile>
        </ArrayOfCredentialAccessProfile>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
</TestSuit>

<!--<Response>Fault</Response>
<Code>Sender</Code>
<Subcode>InvalidArgVal</Subcode>-->