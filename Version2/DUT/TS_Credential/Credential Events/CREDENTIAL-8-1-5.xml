<?xml version="1.0" encoding="utf-8" ?>
<TestSuit Name="Recording service" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</Name>
    <Description>

    </Description>
  </Parameters>
  <Test ID = "TC.CREDENTIAL-8-1-5.F00" ONVIFTestID="Features" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 Features detection</TestName>
    <Name>GetServices and Digest suported</Name>
    <Description>
      GetServices - supported.
      Digest - supported.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/doorcontrol/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDoor12/DoorService.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <!--namespace pt, xs-->
  <Test ID = "TC.CREDENTIAL-8-1-5.01" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Correct response: namespase is defined in ApbViolation element</Name>
    <Description>
      Check CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT test when
      DUT sends correct response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
       
  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.02" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Correct response: namespase is defined in MessageDescription element</Name>
    <Description>
      Check CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT test when
      DUT sends correct response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                  
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true">
                <tt:MessageDescription IsProperty="false" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.03" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Correct response: namespase is defined in State element</Name>
    <Description>
      Check CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT test when
      DUT sends correct response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
              <ApbViolation wstop:topic="true">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.04" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Correct response: namespase is defined in tns1:Credential element</Name>
    <Description>
      Check CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT test when
      DUT sends correct response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
            <State>
              <ApbViolation wstop:topic="true">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    

  </Test>
  
  <!--topic ApbViolation-->
  <Test ID = "TC.CREDENTIAL-8-1-5.05" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: topic ApbViolation is omitted</Name>
    <Description>
      Check CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT test when
      DUT sends correct response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  
  <!--isProperty-->
  <Test ID = "TC.CREDENTIAL-8-1-5.06" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: isProperty = true</Name>
    <Description>
     
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.07" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Correct response: isProperty is skipped</Name>
    <Description>
      
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.28" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Correct response: IsProperty=0</Name>
    <Description>
      Check CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT test when
      DUT sends correct response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="0">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    
  </Test>
  
  <!--SimpleItemDescription-->
  <Test ID = "TC.CREDENTIAL-8-1-5.08" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
  <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
  <Name>Incorrect response: no element SimpleItemDescription item with Name=CredentialToken</Name>
  <Description>
    6.2. If ApbViolationTopic does not contain 
    MessageDescription.Source.SimpleItemDescription item with 
    Name =: “CredentialToken”, FAIL the test and skip other steps.
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>

    </TestSummary>
  </ExpectedResult>
  <Step id ="1">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>


  <Step id ="2">
    <Command>GetEventProperties</Command>
    <Response>Normal</Response>
    <ResponseParameters name="TopicNamespaceLocation">
      <ArrayOfString>
        <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
      </ArrayOfString>
    </ResponseParameters>
    <ResponseParameters name="FixedTopicSet">
      <boolean>true</boolean>
    </ResponseParameters>
    <ResponseParameters name="TopicSet">
      <TopicSetType
                    xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                    xmlns:tt="http://www.onvif.org/ver10/schema"
                    xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                    xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                    xmlns:xs="http://www.w3.org/2001/XMLSchema">
        <!--tns1:RecordingConfig/RecordingJobConfiguration-->
        <tns1:RecordingConfig>
          <RecordingJobConfiguration wstop:topic="true">
            <tt:MessageDescription IsProperty="false">
              <tt:Source>
                <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
              </tt:Source>
              <tt:Data>
                <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
              </tt:Data>
            </tt:MessageDescription>
          </RecordingJobConfiguration>
        </tns1:RecordingConfig>
        <tns1:Monitoring>
          <ProcessorUsage wstop:topic="true">
            <tt:MessageDescription IsProperty="true">
              <tt:Source>
                <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
              </tt:Source>
              <tt:Data>
                <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
              </tt:Data>
            </tt:MessageDescription>
          </ProcessorUsage>
        </tns1:Monitoring>
        <tns1:Credential>
          <State>
            <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="CredentialToken11" Type="pt:ReferenceToken"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                </tt:Data>
              </tt:MessageDescription>
            </ApbViolation>
          </State>
        </tns1:Credential>
      </TopicSetType>
    </ResponseParameters>
    <ResponseParameters name="TopicExpressionDialect">
      <ArrayOfString>
        <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
        <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
      </ArrayOfString>
    </ResponseParameters>
    <ResponseParameters name="MessageContentFilterDialect">
      <ArrayOfString>
        <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
      </ArrayOfString>
    </ResponseParameters>
    <ResponseParameters name="MessageContentSchemaLocation">
      <ArrayOfString>
        <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
      </ArrayOfString>
    </ResponseParameters>
  </Step>

  

</Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.09" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: SimpleItemDescription with Name=CredentialToken does not have Typ =pt:ReferenceToken</Name>
    <Description>
      6.3. If ApbViolationTopic.MessageDescription.Source.SimpleItemDescription with Name =: “CredentialToken” 
      does not have Type =: “pt:ReferenceToken”, FAIL the test and skip other steps.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken11"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.10" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: no element SimpleItemDescription item with Name =ApbViolation</Name>
    <Description>
      6.4. If ApbViolationTopic does not contain MessageDescription.Data.SimpleItemDescription 
      item with Name =: “ApbViolation”, FAIL the test and skip other steps.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation11" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.11" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: element SimpleItemDescription item with Name =CredentialToken doesn't have Type=xs:boolean</Name>
    <Description>
      6.5. If ApbViolationTopic.MessageDescription.Data.SimpleItemDescription 
      with Name =: “ApbViolation” does not have Type =: “xs:boolean”, 
      FAIL the test and skip other steps.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean11"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    

  </Test>
  
  <Test ID = "TC.CREDENTIAL-8-1-5.12" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: SimpleItemDescription with Name=ClientUpdated is skipped</Name>
    <Description>
      
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          
          
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                   
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
       
  </Test>
  
  <Test ID = "TC.CREDENTIAL-8-1-5.13" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect type for SimpleItemDescription with Name=ClientUpdated</Name>
    <Description>
      
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          
          
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:string"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
       
  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.14" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: wstop:topic=false</Name>
    <Description>
      
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          
          
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="false" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
       
  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.15" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: wstop:topic is skipped</Name>
    <Description>
      
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <!--tns1:RecordingConfig/RecordingJobConfiguration-->
          
          
          <tns1:Credential>
            <State>
              <ApbViolation xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="false">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                    <tt:SimpleItemDescription Name= "ClientUpdated" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
       
  </Test>
  <!--Depricated test cases (service spec was changed)-->
  <!--empty PullMessageResponse - positive test-->
  <!--<Test ID = "TC.CREDENTIAL-8-1-5.12" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Correct response: no notification message in PullMessageResponse</Name>
    <Description>
      no notification message in PullMessageResponse
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="9">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="10">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  
  --><!--PullMessageResponse - negative tests--><!--
  <Test ID = "TC.CREDENTIAL-8-1-5.13" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: TopicExpression item != tns1:Credential/State/ ApbViolation </Name>
    <Description>
      10.4. If m is not null and the TopicExpression item in m is not equal 
      to “tns1:Credential/State/ ApbViolation”, FAIL the test and go to the step 14.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/Enabled</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.14" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: PropertyOperation = Changed</Name>
    <Description>
      10.5. If m is not null and the PropertyOperation item in m 
      is not equal to “Initialized”, FAIL the test and go to the step 14.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Changed">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.15" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: CredentialToken is not from credentialCompleteList</Name>
    <Description>
      10.6. If m is not null and the CredentialToken source simple item in m 
      is not equal to any credential token from credentialCompleteList, 
      FAIL the test and go to the step 14.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential12"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  
  <Test ID = "TC.CREDENTIAL-8-1-5.16" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Correct response: SimpleItem Name="ApbViolation" Value="0"</Name>
    <Description>
      10.7. If m is not null and does not contain Data.SimpleItem item with 
      Name =: "ApbViolation" and Value with type is equal to xs:boolean, 
      FAIL the test and go to the step 14.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="0"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  
  <Test ID = "TC.CREDENTIAL-8-1-5.17" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: SimpleItem Name="ApbViolation" Value="False"</Name>
    <Description>
      10.7. If m is not null and does not contain Data.SimpleItem item with
      Name =: " ApbViolation" and Value with type is equal to xs:boolean,
      FAIL the test and go to the step 14.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>

    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="False"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.18" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: SimpleItem Name="ApbViolation" Value="notBool"</Name>
    <Description>
      10.7. If m is not null and does not contain Data.SimpleItem item with
      Name =: " ApbViolation" and Value with type is equal to xs:boolean,
      FAIL the test and go to the step 14.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="notBool"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.19" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: SimpleItem Name="ApbViolation11"</Name>
    <Description>
      10.7. If m is not null and does not contain Data.SimpleItem item with
      Name =: " ApbViolation" and Value with type is equal to xs:boolean,
      FAIL the test and go to the step 14.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>

    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation11" Value="0"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>

  --><!--No response with notification - timeout --><!--
  <Test ID = "TC.CREDENTIAL-8-1-5.20" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: No response with notification</Name>
    <Description>
      11.	If timeout1 timeout expires for step 10 without 
      Notification with TopicExpression := “tns1:Credential/State/ ApbViolation”, FAIL the test.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>

    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.21" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: Notifications not for all credential tokens</Name>
    <Description>
      12.	If the DUT sent Notifications not for all credential 
      tokens from credentialCompleteList, FAIL the test and go to step.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <Timeout>10000</Timeout>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  
  --><!--CredentialState--><!--
  <Test ID = "TC.CREDENTIAL-8-1-5.22" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: CredentialState is not equal to value in notification</Name>
    <Description>
      13.3. If credentialState.AntipassbackState.AntipassbackViolated is not equal to 
      ApbViolation data simple item value from notification with 
      CredentialToken =: token, FAIL the test and go to step 14.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>

    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  
  --><!--No response--><!--
  <Test ID = "TC.CREDENTIAL-8-1-5.23" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
  <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
  <Name>Incorrect response: No unsubscribe response</Name>
  <Description>
    FAIL if The DUT did not send UnsubscribeResponse message.
  </Description>
  <ExpectedResult>
    <ONVIFTestResult>FAILED</ONVIFTestResult>
    <TestSummary>

    </TestSummary>
  </ExpectedResult>
  <Step id ="1">
    <Command>Device10.GetServices</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <IncludeCapability>False</IncludeCapability>
    </RequestParameters>
    <ResponseParameters special="1">
      <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
        <Service>
          <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
          <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
          <tds:Version>
            <tt:Major>2</tt:Major>
            <tt:Minor>1</tt:Minor>
          </tds:Version>
        </Service>
      </ArrayOfService>
    </ResponseParameters>
  </Step>

  <Step id ="2">
    <Command>GetEventProperties</Command>
    <Response>Normal</Response>
    <ResponseParameters name="TopicNamespaceLocation">
      <ArrayOfString>
        <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
      </ArrayOfString>
    </ResponseParameters>
    <ResponseParameters name="FixedTopicSet">
      <boolean>true</boolean>
    </ResponseParameters>
    <ResponseParameters name="TopicSet">
      <TopicSetType
                    xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                    xmlns:tt="http://www.onvif.org/ver10/schema"
                    xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                    xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                    xmlns:xs="http://www.w3.org/2001/XMLSchema">
        --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
        <tns1:RecordingConfig>
          <RecordingJobConfiguration wstop:topic="true">
            <tt:MessageDescription IsProperty="false">
              <tt:Source>
                <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
              </tt:Source>
              <tt:Data>
                <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
              </tt:Data>
            </tt:MessageDescription>
          </RecordingJobConfiguration>
        </tns1:RecordingConfig>
        <tns1:Monitoring>
          <ProcessorUsage wstop:topic="true">
            <tt:MessageDescription IsProperty="true">
              <tt:Source>
                <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
              </tt:Source>
              <tt:Data>
                <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
              </tt:Data>
            </tt:MessageDescription>
          </ProcessorUsage>
        </tns1:Monitoring>
        <tns1:Credential>
          <State>
            <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                </tt:Data>
              </tt:MessageDescription>
            </ApbViolation>
          </State>
        </tns1:Credential>
      </TopicSetType>
    </ResponseParameters>
    <ResponseParameters name="TopicExpressionDialect">
      <ArrayOfString>
        <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
        <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
      </ArrayOfString>
    </ResponseParameters>
    <ResponseParameters name="MessageContentFilterDialect">
      <ArrayOfString>
        <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
      </ArrayOfString>
    </ResponseParameters>
    <ResponseParameters name="MessageContentSchemaLocation">
      <ArrayOfString>
        <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
      </ArrayOfString>
    </ResponseParameters>
  </Step>

  <Step id="3">
    <Command>Credential10.GetCredentialList</Command>
    <Response>Normal</Response>
    <RequestParameters>
    </RequestParameters>
    <ResponseParameters>
      <string>
      </string>
    </ResponseParameters>
    <ResponseParametersAdditional>
      <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <Credential token="Credential1">
          <tac:Name>Credential 1</tac:Name>
          <tac:Description>Credential 1 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
        </Credential>
        <Credential token="Credential2">
          <tac:Name>Credential 2</tac:Name>
          <tac:Description>Credential 2 Description</tac:Description>
          <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
        </Credential>
      </ArrayOfCredential>
    </ResponseParametersAdditional>
  </Step>

  <Step id ="4">
    <Command>CreatePullPointSubscription</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Filter>
        <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
      </Filter>
    </RequestParameters>
    <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
      <EndpointReferenceType>
        <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
        <wsa:ReferenceParameters/>
        <wsa:Metadata/>
      </EndpointReferenceType>
    </ResponseParameters>
    <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
      <SubscriptionReference>
        <wsa:Address>
          http://localhost:2634/Subscription?Idx=0
        </wsa:Address>
      </SubscriptionReference>
      <CurrentTime type="now"></CurrentTime>
      <TerminationTime differance="true">60</TerminationTime>
    </ResponseParametersAdditional>
  </Step>

  <Step id ="5">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now"></CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
              </tt:Source>
              <tt:Data>
                <tt:SimpleItem Name="ApbViolation" Value="false"/>
              </tt:Data>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>

  <Step id ="6">
    <Command>PMSPullMessages</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Timeout>PT60S</Timeout>
      <MessageLimit>1</MessageLimit>
    </RequestParameters>
    <ResponseParametersAdditional>
      <CurrentTime type="now"></CurrentTime>
      <TerminationTime differance="true">65</TerminationTime>
    </ResponseParametersAdditional>
    <ResponseParameters>
      <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
        <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
          <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
          <wsnt:Message>
            <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
              <tt:Source>
                <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
              </tt:Source>
              <tt:Data>
                <tt:SimpleItem Name="ApbViolation" Value="true"/>
              </tt:Data>
            </tt:Message>
          </wsnt:Message>
        </NotificationMessageHolderType>
      </ArrayOfNotificationMessageHolderType>
    </ResponseParameters>
  </Step>

  <Step id="7">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential1</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>false</tac:Enabled>
        <tac:Reason>Test Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>

  <Step id="8">
    <Command>Credential10.GetCredentialState</Command>
    <Response>Normal</Response>
    <RequestParameters>
      <Token>Credential2</Token>
    </RequestParameters>
    <ResponseParameters>
      <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        <tac:Enabled>false</tac:Enabled>
        <tac:Reason>Test Reason</tac:Reason>
        <tac:AntipassbackState>
          <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
        </tac:AntipassbackState>
      </CredentialState>
    </ResponseParameters>
  </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

</Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.24" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: No PullMessagesResponse message</Name>
    <Description>
      FAIL if The DUT did not send PullMessagesResponse message.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>

    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="9">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="10">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.25" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: No CreatePullPointSubscriptionResponse message</Name>
    <Description>
      FAIL if The DUT did not send CreatePullPointSubscriptionResponse message.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>

    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
        <Response>NoResponse</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.26" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: No GetCredentialStateResponse message</Name>
    <Description>
      FAIL if The DUT did not send GetCredentialStateResponse message.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>

    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="9">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="10">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>
  <Test ID = "TC.CREDENTIAL-8-1-5.27" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="true">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: No GetEventPropertiesResponse message</Name>
    <Description>
      FAIL if The DUT did not send GetEventPropertiesResponse message.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>NoResponse</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          --><!--tns1:RecordingConfig/RecordingJobConfiguration--><!--
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>-->
  
  
  
  
  <!--Template for FAILED tests-->
  <!--<Test ID = "TC.CREDENTIAL-8-1-5.01" ONVIFTestID="CREDENTIAL-8-1-5" Enabled="false">
    <TestName>CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT</TestName>
    <Name>Incorrect response: namespase is defined in ApbViolation element</Name>
    <Description>
      Check CREDENTIAL-8-1-5 CREDENTIAL STATE ANTIPASSBACK VIOLATION EVENT test when
      DUT sends correct response
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceEvents10/EventService.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>


    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1"
                      xmlns:tns1="http://www.onvif.org/ver10/topics"
                     
                      xmlns:xs="http://www.w3.org/2001/XMLSchema">
          <tns1:RecordingConfig>
            <RecordingJobConfiguration wstop:topic="true">
              <tt:MessageDescription IsProperty="false">
                <tt:Source>
                  <tt:SimpleItemDescription Name="RecordingJobToken" Type="tt:RecordingJobReference" />
                </tt:Source>
                <tt:Data>
                  <tt:ElementItemDescription Name="Configuration" Type="tt:RecordingJobConfiguration" />
                </tt:Data>
              </tt:MessageDescription>
            </RecordingJobConfiguration>
          </tns1:RecordingConfig>
          <tns1:Monitoring>
            <ProcessorUsage wstop:topic="true">
              <tt:MessageDescription IsProperty="true">
                <tt:Source>
                  <tt:SimpleItemDescription Name="Token" Type="tt:ReferenceToken" />
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItemDescription xmlns:xs="http://www.w3.org/2001/XMLSchema" Name="Value" Type="xs:float" />
                </tt:Data>
              </tt:MessageDescription>
            </ProcessorUsage>
          </tns1:Monitoring>
          <tns1:Credential>
            <State>
              <ApbViolation wstop:topic="true" xmlns:pt="http://www.onvif.org/ver10/pacs" xmlns:xs="http://www.w3.org/2001/XMLSchema">
                <tt:MessageDescription IsProperty="true">
                  <tt:Source>
                    <tt:SimpleItemDescription Name="CredentialToken" Type="pt:ReferenceToken"/>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItemDescription Name="ApbViolation" Type="xs:boolean"/>
                  </tt:Data>
                </tt:MessageDescription>
              </ApbViolation>
            </State>
          </tns1:Credential>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>

    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="4">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2"  xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <EndpointReferenceType>
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters/>
          <wsa:Metadata/>
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:wsa="http://www.w3.org/2005/08/addressing">
        <SubscriptionReference>
          <wsa:Address>
            http://localhost:2634/Subscription?Idx=0
          </wsa:Address>
        </SubscriptionReference>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>

    <Step id ="5">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential1"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="false"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id ="6">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Credential/State/ApbViolation</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321" PropertyOperation="Initialized">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="Credential2"/>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="ApbViolation" Value="true"/>
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>

    <Step id="7">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id="8">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential2</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>true</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>

    <Step id ="9">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>

  </Test>-->
</TestSuit>