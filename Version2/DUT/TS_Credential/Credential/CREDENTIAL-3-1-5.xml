<?xml version="1.0" encoding="utf-8"?>
<TestSuit Name="Draft Capabilities" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</Name>
    <Description>
      TODO:
      
    </Description>
  </Parameters>
  <Test ID="TC.CREDENTIAL-3-1-5.01" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: WIEGAND26</Name>
    <Description>
      ResetAntipassbackSupported="true"
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" 
                             MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.02" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: number of credentials = MaxCredentials</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Annex A.3-->
  <Test ID="TC.CREDENTIAL-3-1-5.03" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.3: GetCredentialList fails</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
  </Test>
  <!--Annex A.7-->
  <Test ID="TC.CREDENTIAL-3-1-5.04" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.7: GetServiceCapabilities fails</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.05" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.7: no response to GetServiceCapabilities</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.06" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.7: no response to GetCredentials</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.07" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.7: Fail to GetCredentials</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.08" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.7: no response to GetCredentialState</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.GetCredentialState</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.09" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.7: fail to GetCredentialState</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.10" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.7: no response to DeleteCredential</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          
            <Credential token="Credential1">
              <tac:Name>Credential 1</tac:Name>
              <tac:Description>Credential 1 Description</tac:Description>
              <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
              <tac:CredentialIdentifier>
                <tac:Type>
                  <tac:Name>pt:Card</tac:Name>
                  <tac:FormatType>WIEGAND26</tac:FormatType>
                </tac:Type>
                <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
                <tac:Value>45028C01</tac:Value>
              </tac:CredentialIdentifier>
            </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.11" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.7: fail to DeleteCredential</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidToken</Subcode>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Annex A.5-->
  <Test ID="TC.CREDENTIAL-3-1-5.12" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.5: empty AccessProfile List</Name>
    <Description>
      DUT should create Credential without CredentialAccessProfile field
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <!--<tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>-->
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <!--<tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>-->
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.13" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.5: empty AccessProfile List (check for GetCredentials)</Name>
    <Description>
      DUT should create Credential without CredentialAccessProfile field
      GetCredentialsResponse has filled CredentialAccessProfile field
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
         STEP 31 - Checking received Credential item
      The Credential item sent in CreateCredential command is inconsistent with received one through GetCredentials command:
          CredentialAccessProfile lists are inconsistent.
              CredentialAccessProfile lists has different number of items
   STEP FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <!--<tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>-->
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.14" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.5: empty AccessProfile List (check for GetCredentialList)</Name>
    <Description>
      DUT should create Credential without CredentialAccessProfile field
      GetCredentialListResponse has filled CredentialAccessProfile field for created Token
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <!--<tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>-->
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.15" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.5: no response to GetAccessProfileList</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.16" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>A.5: fault to GetAccessProfileList</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <Subcode>Fault</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
  </Test>
  <!--Test-->
  <Test ID="TC.CREDENTIAL-3-1-5.17" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreatePullPointSubscription - fault</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Fault</Response>
      <Code>Receiver</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.18" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreatePullPointSubscription - no response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.19" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - different credential token in response</Name>
    <Description>
      The DUT sends token with CreateCredential, that differs from requested token.
      UPD: request CreateCredential shall send empty token
      
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken1</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.20" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - different credential token in response (PullMessage check)</Name>
    <Description>
      The DUT sends token with CreateCredential, that differs from requested token.
      PullMessagesResponse send CredentialToken = "TestToken"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken1</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.21" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - different credential token in response (GetCredentials check)</Name>
    <Description>
      The DUT sends token with CreateCredential, that differs from requested token.
      GetCredentialsResponse send Credential.token = "TestToken"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken1</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.22" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - different credential token in response (GetCredentialInfo check)</Name>
    <Description>
      The DUT sends token with CreateCredential, that differs from requested token.
      GetCredentialInfoResponse send Credential.token = "TestToken"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken1</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.23" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - different credential token in response (GetCredentialInfoList check)</Name>
    <Description>
      The DUT sends token with CreateCredential, that differs from requested token.
      GetCredentialInfoListResponse send Credential.token = "TestToken"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken1</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.24" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - different credential token in response (GetCredentialList check)</Name>
    <Description>
      The DUT sends token with CreateCredential, that differs from requested token.
      GetCredentialListResponse send Credential.token = "TestToken"
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken1</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="14">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="15">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="16">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="17">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="18">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.25" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - empty credential token in response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.26" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - no response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.27" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>CreateCredential - SOAP 1.2 fault</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.28" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>PullMessages: wrong Topic</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Created</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.29" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>PullMessages: wrong SimpleItem name</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken1" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.30" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>PullMessages: no expected token</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.31" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>PullMessages: no response</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>NoResponse</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.32" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>PullMessages: SOAP 1.2 Fault</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidSomething</Subcode>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.33" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetCredentials: wrong token</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken1">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.34" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetCredentials: wrong test description</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Wrong Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.35" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetCredentials: wrong credential holder</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser1</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--ticket 880 - custom FormatType-->
  <Test ID="TC.CREDENTIAL-3-1-5.36" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetSupportedFormatTypes: unsupported format</Name>
    <Description>
      custom format type
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>FACILITY16_CARD32</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.37" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Custom Format Type</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>Custom</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>Custom</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>Custom</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>Custom</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.360" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetSupportedFormatTypes: unsupported format</Name>
    <Description>
      custom format type
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>

    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>custom1</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:PIN</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>FACILITY16_CARD32</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <!--ticket 873 FormatType is mandatory-->
  <Test ID="TC.CREDENTIAL-3-1-5.38" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetSupportedFormatTypes: empty format</Name>
    <Description>
      ticket 873 - FormatType is mandatory
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.39" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetCredentials: wrong fields</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description1</tac:Description>
            <tac:CredentialHolderReference>TestUser1</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:PIN</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>true</tac:ExemptedFromAuthentication>
              <tac:Value>2831869440</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile2</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.40" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetCredentials: wrong CredentialIdentifier.Value</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="3" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="4">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Credential 1 Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="6">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>Credential1</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="8">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="9">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>2831869441</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="12">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="Credential1">
          <Description>Credential 1 Description</Description>
          <CredentialHolderReference>CredentialHolderReference</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.41" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>GetCredentialState: wrong state</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>false</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.42" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>TestToken is already exist on the device</Name>
    <Description>
      Credential Service Capabilities was returned
      (request should be with empty token, so not applicable)
      
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="TestToken">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>TestToken</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>TestToken</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>1234</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>TestToken</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--ticket 855 ONVIF (old)-->
  <Test ID="TC.CREDENTIAL-3-1-5.43" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: ONVIF prefix</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>ONVIFCard</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFPIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFFace</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFIris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>ONVIFVein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>ONVIFCard</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>ONVIFCard</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>ONVIFCard</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--ticket 977-->
  <Test ID="TC.CREDENTIAL-3-1-5.44" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FASC_N</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FASC_N_BCD</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.45" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>SIMPLE_NUMBER32</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>SIMPLE_NUMBER32</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>31343031</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.46" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>WIEGAND37</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>6268606200</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.400" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: WIEGAND37_FACILITY</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND37_FACILITY</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>6268606200</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND37_FACILITY</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>6268606200</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.401" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: FACILITY16_CARD32</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>62686062607002</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>62686062607002</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>62686062607002</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>FACILITY16_CARD32</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>62686062607002</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>62686062607002</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>62686062607002</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>62686062607002</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>62686062607002</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY16_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>62686062607002</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.402" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: FACILITY32_CARD32</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>636860626070686400</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>636860626070686400</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>636860626070686400</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>FACILITY32_CARD32</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>636860626070686400</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>636860626070686400</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>636860626070686400</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>636860626070686400</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>636860626070686400</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FACILITY32_CARD32</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>636860626070686400</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.403" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: FASC_N</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FASC_N</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>FASC_N</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>0201040331343031</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.404" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: FASC_N_BCD</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FASC_N_BCD</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>FASC_N_BCD</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>34127856411080</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.405" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: FASC_N_LARGE</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>02010403313430310101010203040501020101</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>02010403313430310101010203040501020101</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>02010403313430310101010203040501020101</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FASC_N_LARGE</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>FASC_N_LARGE</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>02010403313430310101010203040501020101</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>02010403313430310101010203040501020101</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>02010403313430310101010203040501020101</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>02010403313430310101010203040501020101</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>02010403313430310101010203040501020101</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>02010403313430310101010203040501020101</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.406" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: FASC_N_LARGE_BCD</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080112143153254412311</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080112143153254412311</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080112143153254412311</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>FASC_N_LARGE_BCD</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>34127856411080112143153254412311</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080112143153254412311</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080112143153254412311</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080112143153254412311</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080112143153254412311</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>FASC_N_LARGE_BCD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>34127856411080112143153254412311</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.407" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: GSA75</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GSA75</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GSA75</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GSA75</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>GSA75</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>GSA75</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>0201040331343031730717FF</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GSA75</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031730717FF</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional special="1">
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GSA75</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GSA75</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GSA75</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GSA75</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031730717FF</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.408" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: GUID</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834323633000000000000</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834323633000000000000</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834323633000000000000</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>GUID</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>GUID</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>31343031303834323633000000000000</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834323633000000000000</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834323633000000000000</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834323633000000000000</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834323633000000000000</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>GUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834323633000000000000</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.409" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: CHUID</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>CHUID</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>CHUID</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional special="1">
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0201040331343031040302010403020101020304050607080931343031303834323633000000000000730717FF</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.410" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: CHUID_FULL</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID_FULL</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID_FULL</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID_FULL</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>CHUID_FULL</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>CHUID_FULL</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID_FULL</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional special="1">
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID_FULL</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID_FULL</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID_FULL</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CHUID_FULL</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.411" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: CBEFF_A</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_A</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_A</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_A</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>CBEFF_A</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>CBEFF_A</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_A</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_A</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_A</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_A</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_A</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.412" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: CBEFF_B</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_B</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_B</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_B</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>CBEFF_B</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>CBEFF_B</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_B</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_B</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_B</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_B</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_B</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.413" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: CBEFF_C</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_C</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_C</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_C</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>CBEFF_C</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>CBEFF_C</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_C</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_C</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_C</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_C</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>CBEFF_C</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.414" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: USER_PASSWORD</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>USER_PASSWORD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B00313430313038343236330B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>USER_PASSWORD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B00313430313038343236330B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>USER_PASSWORD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B00313430313038343236330B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>USER_PASSWORD</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>USER_PASSWORD</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>0B00313430313038343236330B0031343031303834323633</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>USER_PASSWORD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B00313430313038343236330B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>USER_PASSWORD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B00313430313038343236330B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>USER_PASSWORD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B00313430313038343236330B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>USER_PASSWORD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B00313430313038343236330B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>USER_PASSWORD</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B00313430313038343236330B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.415" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: SIMPLE_NUMBER16</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>3134</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>3134</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>3134</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>SIMPLE_NUMBER16</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>3134</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>3134</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>3134</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>3134</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>3134</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER16</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>3134</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.416" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: SIMPLE_NUMBER56</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>SIMPLE_NUMBER56</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>31343031303834</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_NUMBER56</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>31343031303834</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.417" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: SIMPLE_ALPHA_NUMERIC</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>SIMPLE_ALPHA_NUMERIC</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>0B0031343031303834323633</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>SIMPLE_ALPHA_NUMERIC</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>0B0031343031303834323633</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.418" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: ABA_TRACK2</Name>
    <Description>
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>ABA_TRACK2</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>ABA_TRACK2</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>ABA_TRACK2</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>ABA_TRACK2</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>ABA_TRACK2</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>ABA_TRACK2</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional special="1">
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>ABA_TRACK2</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>ABA_TRACK2</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>ABA_TRACK2</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>ABA_TRACK2</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--zorba - check additional fields in PullMessage-->
  <Test ID="TC.CREDENTIAL-3-1-5.500" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: WIEGAND26</Name>
    <Description>
      additional fields in PullMessage
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                  <tt:ElementItem Name="TestItem"><element xmlns="new">any</element></tt:ElementItem>
                </tt:Source>
                <tt:Key>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                  <tt:Extension>
                    <element xmlns="new">element1</element>
                  </tt:Extension>
                </tt:Key>
                <tt:Data>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken1" />
                </tt:Data>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--ticket 975 -  ResetAntipassbackSupported=true/false -->
  <Test ID="TC.CREDENTIAL-3-1-5.600" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: no AntipassbackState returned </Name>
    <Description>
      WIEGAND26
      ResetAntipassbackSupported="false"
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="false" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.601" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: AntipassbackState returned </Name>
    <Description>
      WIEGAND26
      ResetAntipassbackSupported="false"
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="false" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.602" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Correct response: no Antipassback state returned</Name>
    <Description>
      ResetAntipassbackSupported="true"
      Credential Service Capabilities was returned
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="10" CredentialValiditySupported="true" CredentialAccessProfileValiditySupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" ResetAntipassbackSupported="true" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl" xmlns:pt="http://www.onvif.org/ver10/pacs">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>false</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  
  <!--ticket 1385-->  
  <Test ID="TC.CREDENTIAL-3-1-5.700" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>ExemptedFromAuthentication is supported</Name>
    <Description>
      ExemptedFromAuthentication: supported,
      ExemptedFromAuthentication = true
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" ValiditySupportsTimeValue="true" CredentialAccessProfileValiditySupported="true" ResetAntipassbackSupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
          <tcr:Extension>
            <tcr:SupportedExemptionType>pt:ExemptFromAuthentication</tcr:SupportedExemptionType>
          </tcr:Extension>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>true</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>true</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>true</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.701" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>ExemptedFromAuthentication is supported</Name>
    <Description>
      ExemptedFromAuthentication: supported,
      ExemptedFromAuthentication = 1
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" ValiditySupportsTimeValue="true" CredentialAccessProfileValiditySupported="true" ResetAntipassbackSupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
          <tcr:Extension>
            <tcr:SupportedExemptionType>pt:ExemptFromAuthentication</tcr:SupportedExemptionType>
          </tcr:Extension>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>true</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>1</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>1</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.702" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Incorrect response: GetCredentials: ExemptedFromAuthentication = false</Name>
    <Description>
      ExemptedFromAuthentication: supported,
      GetCredentials: ExemptedFromAuthentication = false
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" ValiditySupportsTimeValue="true" CredentialAccessProfileValiditySupported="true" ResetAntipassbackSupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
          <tcr:Extension>
            <tcr:SupportedExemptionType>pt:ExemptFromAuthentication</tcr:SupportedExemptionType>
          </tcr:Extension>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>true</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>true</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID="TC.CREDENTIAL-3-1-5.703" ONVIFTestID="CREDENTIAL-3-1-5" Enabled="true">
    <TestName>CREDENTIAL-3-1-5 CREATE CREDENTIAL (ENABLED)</TestName>
    <Name>Incorrect response: GetCredentialList: ExemptedFromAuthentication = false</Name>
    <Description>
      ExemptedFromAuthentication: supported,
      GetCredentialList: ExemptedFromAuthentication = false
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
      </TestSummary>
    </ExpectedResult>
    <Step id="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://CAMERA_IP/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id="1">
      <Command>Device10.GetServices</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <IncludeCapability>False</IncludeCapability>
      </RequestParameters>
      <ResponseParameters special="1">
        <ArrayOfService xmlns:tds="http://www.onvif.org/ver10/device/wsdl" xmlns:tt="http://www.onvif.org/ver10/schema">
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/device/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/media/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/events/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/ptz/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver20/imaging/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/ver20/analytics/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/accessrules/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost/onvif/ServiceDevice10/DeviceServiceFake.asmx </tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
          <Service>
            <tds:Namespace>http://www.onvif.org/ver10/credential/wsdl</tds:Namespace>
            <tds:XAddr>http://localhost:17934/ServiceDevice10/DeviceServiceFake.asmx</tds:XAddr>
            <tds:Version>
              <tt:Major>2</tt:Major>
              <tt:Minor>1</tt:Minor>
            </tds:Version>
          </Service>
        </ArrayOfService>
      </ResponseParameters>
    </Step>
    <Step id="2">
      <Command>Credential10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <ServiceCapabilities MaxLimit="3" CredentialValiditySupported="true" ValiditySupportsTimeValue="true" CredentialAccessProfileValiditySupported="true" ResetAntipassbackSupported="true" MaxCredentials="10" MaxAccessProfilesPerCredential="5" xmlns:tcr="http://www.onvif.org/ver10/credential/wsdl">
          <tcr:SupportedIdentifierType>pt:Card</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:PIN</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Fingerprint</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Face</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Iris</tcr:SupportedIdentifierType>
          <tcr:SupportedIdentifierType>pt:Vein</tcr:SupportedIdentifierType>
          <tcr:Extension>
            <tcr:SupportedExemptionType>pt:ExemptFromAuthentication</tcr:SupportedExemptionType>
          </tcr:Extension>
        </ServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id="3">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="4">
      <Command>AccessRules10.GetAccessProfileList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfAccessProfile xmlns:tar="http://www.onvif.org/ver10/accessrules/wsdl">
          <AccessProfile token="AccessProfile1">
            <tar:Name>Access Profile 1</tar:Name>
            <tar:Description>Access Profile 1 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile2">
            <tar:Name>Access Profile 2</tar:Name>
            <tar:Description>Access Profile 2 Description</tar:Description>
          </AccessProfile>
          <AccessProfile token="AccessProfile3">
            <tar:Name>Access Profile 3</tar:Name>
            <tar:Description>Access Profile 3 Description</tar:Description>
          </AccessProfile>
        </ArrayOfAccessProfile>
      </ResponseParametersAdditional>
    </Step>
    <Step id="3">
      <Command>Credential10.GetSupportedFormatTypes</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <CredentialIdentifierTypeName>pt:Card</CredentialIdentifierTypeName>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialIdentifierFormatTypeInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND26</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
          <CredentialIdentifierFormatTypeInfo>
            <tac:FormatType>WIEGAND37</tac:FormatType>
            <tac:Description>Description</tac:Description>
          </CredentialIdentifierFormatTypeInfo>
        </ArrayOfCredentialIdentifierFormatTypeInfo>
      </ResponseParameters>
    </Step>
    <Step id="5">
      <Command>CreatePullPointSubscription</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Filter>
          <wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:TopicExpression>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="2">
        <EndpointReferenceType xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <wsa:Address>http://localhost:2634/SubscriptionManagerService.asmx</wsa:Address>
          <wsa:ReferenceParameters />
          <wsa:Metadata />
        </EndpointReferenceType>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">60</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id="6">
      <Command>Credential10.CreateCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Credential token="TestToken">
          <Description>Test Description</Description>
          <CredentialHolderReference>TestUser</CredentialHolderReference>
          <CredentialIdentifier>
            <Type>
              <Name>pt:Card</Name>
              <FormatType>WIEGAND26</FormatType>
            </Type>
            <ExemptedFromAuthentication>true</ExemptedFromAuthentication>
            <Value>45028C01</Value>
          </CredentialIdentifier>
          <CredentialAccessProfile>
            <AccessProfileToken>AccessProfile1</AccessProfileToken>
          </CredentialAccessProfile>
          <Attribute Name="TestAttributeName" Value="TestAttributeValue" />
        </Credential>
        <State>
          <Enabled>true</Enabled>
          <Reason>Test Reason</Reason>
          <AntipassbackState>
            <AntipassbackViolated>false</AntipassbackViolated>
          </AntipassbackState>
        </State>
      </RequestParameters>
      <ResponseParameters>
        <string>TestToken</string>
      </ResponseParameters>
    </Step>
    <Step id="7">
      <Command>PMSPullMessages</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Timeout>PT60S</Timeout>
        <MessageLimit>1</MessageLimit>
      </RequestParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now">
        </CurrentTime>
        <TerminationTime differance="true">65</TerminationTime>
      </ResponseParametersAdditional>
      <ResponseParameters>
        <ArrayOfNotificationMessageHolderType xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tt="http://www.onvif.org/ver10/schema" xmlns:tns1="http://www.onvif.org/ver10/topics">
          <NotificationMessageHolderType xmlns:tns1="http://www.onvif.org/ver10/topics">
            <wsnt:Topic Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:tns1="http://www.onvif.org/ver10/topics">tns1:Configuration/Credential/Changed</wsnt:Topic>
            <wsnt:Message>
              <tt:Message UtcTime="2008-10-10T12:24:57.321">
                <tt:Source>
                  <tt:SimpleItem Name="CredentialToken" Value="TestToken" />
                </tt:Source>
              </tt:Message>
            </wsnt:Message>
          </NotificationMessageHolderType>
        </ArrayOfNotificationMessageHolderType>
      </ResponseParameters>
    </Step>
    <Step id="8">
      <Command>Credential10.GetCredentials</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>true</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParameters>
    </Step>
    <Step id="9">
      <Command>Credential10.GetCredentialInfo</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParameters>
    </Step>
    <Step id="10">
      <Command>Credential10.GetCredentialInfoList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredentialInfo xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <CredentialInfo token="Credential1">
            <tac:Description>Credential1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential2">
            <tac:Description>Credential2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="Credential3">
            <tac:Description>Credential3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
          </CredentialInfo>
          <CredentialInfo token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
          </CredentialInfo>
        </ArrayOfCredentialInfo>
      </ResponseParametersAdditional>
    </Step>
    <Step id="11">
      <Command>Credential10.GetCredentialList</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <string>
        </string>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <ArrayOfCredential xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <Credential token="Credential1">
            <tac:Name>Credential 1</tac:Name>
            <tac:Description>Credential 1 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential2">
            <tac:Name>Credential 2</tac:Name>
            <tac:Description>Credential 2 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="Credential3">
            <tac:Name>Credential 3</tac:Name>
            <tac:Description>Credential 3 Description</tac:Description>
            <tac:CredentialHolderReference>CredentialHolderReference</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
          </Credential>
          <Credential token="TestToken">
            <tac:Description>Test Description</tac:Description>
            <tac:CredentialHolderReference>TestUser</tac:CredentialHolderReference>
            <tac:CredentialIdentifier>
              <tac:Type>
                <tac:Name>pt:Card</tac:Name>
                <tac:FormatType>WIEGAND26</tac:FormatType>
              </tac:Type>
              <tac:ExemptedFromAuthentication>false</tac:ExemptedFromAuthentication>
              <tac:Value>45028C01</tac:Value>
            </tac:CredentialIdentifier>
            <tac:CredentialAccessProfile>
              <tac:AccessProfileToken>AccessProfile1</tac:AccessProfileToken>
            </tac:CredentialAccessProfile>
            <tac:Attribute Name="TestAttributeName" Value="TestAttributeValue" />
          </Credential>
        </ArrayOfCredential>
      </ResponseParametersAdditional>
    </Step>
    <Step id="12">
      <Command>Credential10.GetCredentialState</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
        <CredentialState xmlns:tac="http://www.onvif.org/ver10/credential/wsdl">
          <tac:Enabled>true</tac:Enabled>
          <tac:Reason>Test Reason</tac:Reason>
          <tac:AntipassbackState>
            <tac:AntipassbackViolated>false</tac:AntipassbackViolated>
          </tac:AntipassbackState>
        </CredentialState>
      </ResponseParameters>
    </Step>
    <Step id="13">
      <Command>Credential10.DeleteCredential</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Token>TestToken</Token>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
    <Step id="14">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
</TestSuit>