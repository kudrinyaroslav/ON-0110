<?xml version="1.0" encoding="utf-8"?>
<TestSuit Name="Device Management" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>1.1.15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</Name>
    <Description>
      TODO:
      - empty 
      - no 
    </Description>
  </Parameters>
  <Test ID = "TC.DM.CAP.1_1_15.01" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>Correct response, all elements are true in the both responses</Name>
    <Description>
      GetServiceCapabilities(All elements are true)
      GetCapabilities (Device, all elements are true)
      <ExpectedResult>
      <TestSummary>
        DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

        STEP 1 - Get capabilities
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned Device capabilities
        STEP PASSED

        STEP 3 - Get service capabilities
        Transmit done
        Receive done
        STEP PASSED

        STEP 4 - Compare Capabilities
        STEP PASSED

        TEST PASSED
      </TestSummary>
      </ExpectedResult>
    </Description>
    <!--Features.xml/Features01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>true</tt:IPFilter>
              <tt:ZeroConfiguration>true</tt:ZeroConfiguration>
              <tt:IPVersion6>true</tt:IPVersion6>
              <tt:DynDNS>true</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>true</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>true</tt:DiscoveryResolve>
              <tt:DiscoveryBye>true</tt:DiscoveryBye>
              <tt:RemoteDiscovery>true</tt:RemoteDiscovery>
              <tt:SystemBackup>true</tt:SystemBackup>
              <tt:SystemLogging>true</tt:SystemLogging>
              <tt:FirmwareUpgrade>true</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>true</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>true</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>true</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>true</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>true</tt:TLS1.1>
              <tt:TLS1.2>true</tt:TLS1.2>
              <tt:OnboardKeyGeneration>true</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>true</tt:AccessPolicyConfig>
              <tt:X.509Token>true</tt:X.509Token>
              <tt:SAMLToken>true</tt:SAMLToken>
              <tt:KerberosToken>true</tt:KerberosToken>
              <tt:RELToken>true</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>true</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>true</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>true</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  
   <Test ID = "TC.DM.CAP.1_1_15.02" ONVIFTestID="1.1.2" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>Correct response - all elements are false in the both responses</Name>
    <Description>
      GetServiceCapabilities(All elements are false)
      GetCapabilities (Device, all elements are false)
      <ExpectedResult>
      <TestSummary>
        DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

        STEP 1 - Get capabilities
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned Device capabilities
        STEP PASSED

        STEP 3 - Get service capabilities
        Transmit done
        Receive done
        STEP PASSED

        STEP 4 - Compare Capabilities
        STEP PASSED

        TEST PASSED

      </TestSummary>
     </ExpectedResult>
    </Description>
    <!--Features.xml/Features01-->
    <!--Test-->
     <Step id ="1">
       <Command>Device10.GetServiceCapabilities</Command>
       <Response>Normal</Response>
       <RequestParameters>
       </RequestParameters>
       <ResponseParameters>
         <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
           <tds:Network IPFilter="false" ZeroConfiguration="false" IPVersion6="false" DynDNS="false" Dot11Configuration="false" HostnameFromDHCP="false" NTP="0"/>
           <tds:Security TLS1.0="false" TLS1.1="false" TLS1.2="false" OnboardKeyGeneration="false" AccessPolicyConfig="false" Dot1X="false" RemoteUserHandling="false" X.509Token="false" SAMLToken="false" KerberosToken="false" UsernameToken="false" HttpDigest="false" RELToken="false" SupportedEAPMethods="1 2 3"/>
           <tds:System DiscoveryResolve="false" DiscoveryBye="false" RemoteDiscovery="false" SystemBackup="false" SystemLogging="false" FirmwareUpgrade="false" HttpFirmwareUpgrade="false" HttpSystemBackup="false" HttpSystemLogging="false" HttpSupportInformation="false"/>
         </DeviceServiceCapabilities>
       </ResponseParameters>
     </Step>
     <Step id ="2">
       <Command>Device10.GetCapabilities</Command>
       <Response>Normal</Response>
       <RequestParameters>
         <Category>Device</Category>
       </RequestParameters>
       <ResponseParameters>
         <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
           <tt:Device>
             <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
             <tt:Network>
               <tt:IPFilter>false</tt:IPFilter>
               <tt:ZeroConfiguration>false</tt:ZeroConfiguration>
               <tt:IPVersion6>false</tt:IPVersion6>
               <tt:DynDNS>false</tt:DynDNS>
               <tt:Extension>
                 <tt:Dot11Configuration>false</tt:Dot11Configuration>
               </tt:Extension>
             </tt:Network>
             <tt:System>
               <tt:DiscoveryResolve>false</tt:DiscoveryResolve>
               <tt:DiscoveryBye>false</tt:DiscoveryBye>
               <tt:RemoteDiscovery>false</tt:RemoteDiscovery>
               <tt:SystemBackup>false</tt:SystemBackup>
               <tt:SystemLogging>false</tt:SystemLogging>
               <tt:FirmwareUpgrade>false</tt:FirmwareUpgrade>
               <tt:SupportedVersions>
                 <tt:Major>1</tt:Major>
                 <tt:Minor>1</tt:Minor>
               </tt:SupportedVersions>
               <tt:Extension>
                 <tt:HttpFirmwareUpgrade>false</tt:HttpFirmwareUpgrade>
                 <tt:HttpSystemBackup>false</tt:HttpSystemBackup>
                 <tt:HttpSystemLogging>false</tt:HttpSystemLogging>
                 <tt:HttpSupportInformation>false</tt:HttpSupportInformation>
               </tt:Extension>
             </tt:System>
             <tt:IO>
               <tt:InputConnectors>0</tt:InputConnectors>
               <tt:RelayOutputs>0</tt:RelayOutputs>
             </tt:IO>
             <tt:Security>
               <tt:TLS1.1>false</tt:TLS1.1>
               <tt:TLS1.2>false</tt:TLS1.2>
               <tt:OnboardKeyGeneration>false</tt:OnboardKeyGeneration>
               <tt:AccessPolicyConfig>false</tt:AccessPolicyConfig>
               <tt:X.509Token>false</tt:X.509Token>
               <tt:SAMLToken>false</tt:SAMLToken>
               <tt:KerberosToken>false</tt:KerberosToken>
               <tt:RELToken>false</tt:RELToken>
               <tt:Extension>
                 <tt:TLS1.0>false</tt:TLS1.0>
                 <tt:Extension>
                   <tt:Dot1X>false</tt:Dot1X>
                   <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                   <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                   <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                   <tt:RemoteUserHandling>false</tt:RemoteUserHandling>
                 </tt:Extension>
               </tt:Extension>
             </tt:Security>
           </tt:Device>
         </Capabilities>
       </ResponseParameters>
     </Step>
  </Test>

  <Test ID = "TC.DM.CAP.1_1_15.03" ONVIFTestID="1.1.2" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>Correct response - All elements are not included in both responses</Name>
    <Description>
      Check CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY test
      when DUT return correct response.
      GetServiceCapabilities(no logical elements)
      GetCapabilities (Device, no logical elements)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 2 - Check that the DUT returned Device capabilities
          STEP PASSED

          STEP 3 - Get service capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 4 - Compare Capabilities
          STEP PASSED

          TEST PASSED

        </TestSummary>
      </ExpectedResult>

    </Description>
    <!--Feature defining Features.01-->   
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network NTP="0"/>
          <tds:Security/>
          <tds:System/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:Extension>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:Extension>
                <tt:Extension>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.CAP.1_1_15.04" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>No elements in GetServiceCapabilities and true values in GetCapabilities</Name>
    <Description>
      GetServiceCapabilities(all true)
      GetCapabilities (Device, no logical elements)
      <ExpectedResult>
      <TestSummary>

      </TestSummary>
      </ExpectedResult>
    </Description>
    <!--Features.xml/Features01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network NTP="0"/>
          <tds:Security/>
          <tds:System/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>true</tt:IPFilter>
              <tt:ZeroConfiguration>true</tt:ZeroConfiguration>
              <tt:IPVersion6>true</tt:IPVersion6>
              <tt:DynDNS>true</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>true</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>true</tt:DiscoveryResolve>
              <tt:DiscoveryBye>true</tt:DiscoveryBye>
              <tt:RemoteDiscovery>true</tt:RemoteDiscovery>
              <tt:SystemBackup>true</tt:SystemBackup>
              <tt:SystemLogging>true</tt:SystemLogging>
              <tt:FirmwareUpgrade>true</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>true</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>true</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>true</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>true</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>true</tt:TLS1.1>
              <tt:TLS1.2>true</tt:TLS1.2>
              <tt:OnboardKeyGeneration>true</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>true</tt:AccessPolicyConfig>
              <tt:X.509Token>true</tt:X.509Token>
              <tt:SAMLToken>true</tt:SAMLToken>
              <tt:KerberosToken>true</tt:KerberosToken>
              <tt:RELToken>true</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>true</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>true</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>true</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
      
  <Test ID = "TC.DM.CAP.1_1_15.05" ONVIFTestID="1.1.2" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>No elements in GetCapabilities and all true elements in GetServiceCapabilities </Name>
    <Description>
      GetServiceCapabilities(no logical elements)
      GetCapabilities (Device, All true)
      <ExpectedResult>
      <TestSummary>
        DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

        STEP 1 - Get capabilities
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned Device capabilities
        STEP PASSED

        STEP 3 - Get service capabilities
        Transmit done
        Receive done
        STEP PASSED

        STEP 4 - Compare Capabilities
        IPFilter field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        ZeroConfiguration field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        IPVersion6 field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        DynDNS field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        Dot11Configuration field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        DiscoveryResolve field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        DiscoveryBye field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        RemoteDiscovery field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        SystemBackup field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        SystemLogging field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        FirmwareUpgrade field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        HttpSystemBackup field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        HttpSystemLogging field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        HttpFirmwareUpgrade field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        TLS11 field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        TLS12 field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        OnBoardKeyGeneration field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        AccessPolicyconfig field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        X509Token field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        SAMLToken field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        KerberosToken field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        RELToken field does not match (GetServiceCapabilities: True, GetCapabilities: False)
        TLS10 field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        Dot1X field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        SupportedEAPMethod field is empty in the structure got via GetCapabilities
        RemoteUserHandling field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
        Settings don't match
        STEP FAILED

        TEST FAILED
      </TestSummary>
     </ExpectedResult>
    </Description>
    <!--Features.xml/Features01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:Extension>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:Extension>
                <tt:Extension>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>              
 
  <Test ID = "TC.DM.CAP.1_1_15.06" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>No elements in GetServiceCapabilities and all false elements in GetCapabilities</Name>
    <Description>
      GetServiceCapabilities(no logical elements)
      GetCapabilities (Device, All false)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 2 - Check that the DUT returned Device capabilities
          STEP PASSED

          STEP 3 - Get service capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 4 - Compare Capabilities
          STEP PASSED

          TEST PASSED

        </TestSummary>
      </ExpectedResult>

    </Description>
    <!--Features.xml/Feature01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network NTP="0"/>
          <tds:Security/>
          <tds:System/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>false</tt:IPFilter>
              <tt:ZeroConfiguration>false</tt:ZeroConfiguration>
              <tt:IPVersion6>false</tt:IPVersion6>
              <tt:DynDNS>false</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>false</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>false</tt:DiscoveryResolve>
              <tt:DiscoveryBye>false</tt:DiscoveryBye>
              <tt:RemoteDiscovery>false</tt:RemoteDiscovery>
              <tt:SystemBackup>false</tt:SystemBackup>
              <tt:SystemLogging>false</tt:SystemLogging>
              <tt:FirmwareUpgrade>false</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>false</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>false</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>false</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>false</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>false</tt:TLS1.1>
              <tt:TLS1.2>false</tt:TLS1.2>
              <tt:OnboardKeyGeneration>false</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>false</tt:AccessPolicyConfig>
              <tt:X.509Token>false</tt:X.509Token>
              <tt:SAMLToken>false</tt:SAMLToken>
              <tt:KerberosToken>false</tt:KerberosToken>
              <tt:RELToken>false</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>false</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>false</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>false</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.CAP.1_1_15.07" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>No elements in GetCapabilities and all false elements in GetServiceCapabilities</Name>
    <Description>
      GetServiceCapabilities(all false)
      GetCapabilities (Device, no elements)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 2 - Check that the DUT returned Device capabilities
          STEP PASSED

          STEP 3 - Get service capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 4 - Compare Capabilities
          STEP PASSED

          TEST PASSED

        </TestSummary>
      </ExpectedResult>

    </Description>
    <!--Features.xml/Feature01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="false" ZeroConfiguration="false" IPVersion6="false" DynDNS="false" Dot11Configuration="false" HostnameFromDHCP="false" NTP="0"/>
          <tds:Security TLS1.0="false" TLS1.1="false" TLS1.2="false" OnboardKeyGeneration="false" AccessPolicyConfig="false" Dot1X="false" RemoteUserHandling="false" X.509Token="false" SAMLToken="false" KerberosToken="false" UsernameToken="false" HttpDigest="false" RELToken="false" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="false" DiscoveryBye="false" RemoteDiscovery="false" SystemBackup="false" SystemLogging="false" FirmwareUpgrade="false" HttpFirmwareUpgrade="false" HttpSystemBackup="false" HttpSystemLogging="false" HttpSupportInformation="false"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:Extension>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:Extension>
                <tt:Extension>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>   
  </Test>
  <Test ID = "TC.DM.CAP.1_1_15.08" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>All elements are true for GetCapabilities and false for GetServiceCapabilities</Name>
    <Description>
      GetServiceCapabilities(all false)
      GetCapabilities (Device, All true)
      <ExpectedResult>
        <TestSummary>
          
        </TestSummary>
      </ExpectedResult>

    </Description>
    <!--Features.xml/Feature01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="false" ZeroConfiguration="false" IPVersion6="false" DynDNS="false" Dot11Configuration="false" HostnameFromDHCP="false" NTP="0"/>
          <tds:Security TLS1.0="false" TLS1.1="false" TLS1.2="false" OnboardKeyGeneration="false" AccessPolicyConfig="false" Dot1X="false" RemoteUserHandling="false" X.509Token="false" SAMLToken="false" KerberosToken="false" UsernameToken="false" HttpDigest="false" RELToken="false" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="false" DiscoveryBye="false" RemoteDiscovery="false" SystemBackup="false" SystemLogging="false" FirmwareUpgrade="false" HttpFirmwareUpgrade="false" HttpSystemBackup="false" HttpSystemLogging="false" HttpSupportInformation="false"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>true</tt:IPFilter>
              <tt:ZeroConfiguration>true</tt:ZeroConfiguration>
              <tt:IPVersion6>true</tt:IPVersion6>
              <tt:DynDNS>true</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>true</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>true</tt:DiscoveryResolve>
              <tt:DiscoveryBye>true</tt:DiscoveryBye>
              <tt:RemoteDiscovery>true</tt:RemoteDiscovery>
              <tt:SystemBackup>true</tt:SystemBackup>
              <tt:SystemLogging>true</tt:SystemLogging>
              <tt:FirmwareUpgrade>true</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>true</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>true</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>true</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>true</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>true</tt:TLS1.1>
              <tt:TLS1.2>true</tt:TLS1.2>
              <tt:OnboardKeyGeneration>true</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>true</tt:AccessPolicyConfig>
              <tt:X.509Token>true</tt:X.509Token>
              <tt:SAMLToken>true</tt:SAMLToken>
              <tt:KerberosToken>true</tt:KerberosToken>
              <tt:RELToken>true</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>true</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>true</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>true</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.CAP.1_1_15.09" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>All elements are true in GetServiceCapabilities and false in GetCapabilities</Name>
    <Description>
      GetServiceCapabilities(all true)
      GetCapabilities (Device, All false)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 2 - Check that the DUT returned Device capabilities
          STEP PASSED

          STEP 3 - Get service capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 4 - Compare Capabilities
          IPFilter field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          ZeroConfiguration field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          IPVersion6 field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          DynDNS field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          Dot11Configuration field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
          DiscoveryResolve field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          DiscoveryBye field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          RemoteDiscovery field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          SystemBackup field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          SystemLogging field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          FirmwareUpgrade field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          HttpSystemBackup field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
          HttpSystemLogging field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
          HttpFirmwareUpgrade field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
          TLS11 field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          TLS12 field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          OnBoardKeyGeneration field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          AccessPolicyconfig field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          X509Token field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          SAMLToken field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          KerberosToken field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          RELToken field does not match (GetServiceCapabilities: True, GetCapabilities: False)
          TLS10 field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
          Dot1X field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
          SupportedEAPMethod field is empty in the structure got via GetCapabilities
          RemoteUserHandling field does not match (GetServiceCapabilities: True, GetCapabilities: not specified)
          Settings don't match
          STEP FAILED

          TEST FAILED

        </TestSummary>
      </ExpectedResult>

    </Description>
    <!--Features.xml/Feature01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>false</tt:IPFilter>
              <tt:ZeroConfiguration>false</tt:ZeroConfiguration>
              <tt:IPVersion6>false</tt:IPVersion6>
              <tt:DynDNS>false</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>false</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>false</tt:DiscoveryResolve>
              <tt:DiscoveryBye>false</tt:DiscoveryBye>
              <tt:RemoteDiscovery>false</tt:RemoteDiscovery>
              <tt:SystemBackup>false</tt:SystemBackup>
              <tt:SystemLogging>false</tt:SystemLogging>
              <tt:FirmwareUpgrade>false</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>false</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>false</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>false</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>false</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>false</tt:TLS1.1>
              <tt:TLS1.2>false</tt:TLS1.2>
              <tt:OnboardKeyGeneration>false</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>false</tt:AccessPolicyConfig>
              <tt:X.509Token>false</tt:X.509Token>
              <tt:SAMLToken>false</tt:SAMLToken>
              <tt:KerberosToken>false</tt:KerberosToken>
              <tt:RELToken>false</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>false</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>false</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>false</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.CAP.1_1_15.10" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>Fault on GetServiceCapabilities</Name>
    <Description>
      GetServiceCapabilities(fault)
      GetCapabilities (Device)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 2 - Check that the DUT returned Device capabilities
          STEP PASSED

          STEP 3 - Get service capabilities
          Transmit done
          Receive done
          SOAP fault returned
          Code: Sender
          Subcode: ActionNotSupported
          Reason: System.Web.Services.Protocols.SoapException: MESSAGE
          at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
          at DUT.CameraWebService.Device10.DeviceServiceFake.GetServiceCapabilities() in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 862
          STEP FAILED

          TEST FAILED

        </TestSummary>
      </ExpectedResult>

    </Description>
    <!--Features.xml/Feature01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>ActionNotSupported</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>false</tt:IPFilter>
              <tt:ZeroConfiguration>false</tt:ZeroConfiguration>
              <tt:IPVersion6>false</tt:IPVersion6>
              <tt:DynDNS>false</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>false</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>false</tt:DiscoveryResolve>
              <tt:DiscoveryBye>false</tt:DiscoveryBye>
              <tt:RemoteDiscovery>false</tt:RemoteDiscovery>
              <tt:SystemBackup>false</tt:SystemBackup>
              <tt:SystemLogging>false</tt:SystemLogging>
              <tt:FirmwareUpgrade>false</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>false</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>false</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>false</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>false</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>false</tt:TLS1.1>
              <tt:TLS1.2>false</tt:TLS1.2>
              <tt:OnboardKeyGeneration>false</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>false</tt:AccessPolicyConfig>
              <tt:X.509Token>false</tt:X.509Token>
              <tt:SAMLToken>false</tt:SAMLToken>
              <tt:KerberosToken>false</tt:KerberosToken>
              <tt:RELToken>false</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>false</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>false</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>false</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.CAP.1_1_15.11" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>Fault on GetCapabilities</Name>
    <Description>
      GetServiceCapabilities()
      GetCapabilities (Device, fault)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          Receive done
          SOAP fault returned
          Code: Sender
          Subcode: ActionNotSupported
          Reason: System.Web.Services.Protocols.SoapException: MESSAGE
          at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
          at DUT.CameraWebService.Device10.DeviceServiceFake.GetCapabilities(CapabilityCategory[] Category) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 426
          STEP FAILED

          TEST FAILED
        </TestSummary>
      </ExpectedResult>
    </Description>
    <!--Features.xml/Features01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>ActionNotSupported</Subcode>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>false</tt:IPFilter>
              <tt:ZeroConfiguration>false</tt:ZeroConfiguration>
              <tt:IPVersion6>false</tt:IPVersion6>
              <tt:DynDNS>false</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>false</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>false</tt:DiscoveryResolve>
              <tt:DiscoveryBye>false</tt:DiscoveryBye>
              <tt:RemoteDiscovery>false</tt:RemoteDiscovery>
              <tt:SystemBackup>false</tt:SystemBackup>
              <tt:SystemLogging>false</tt:SystemLogging>
              <tt:FirmwareUpgrade>false</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>false</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>false</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>false</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>false</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>false</tt:TLS1.1>
              <tt:TLS1.2>false</tt:TLS1.2>
              <tt:OnboardKeyGeneration>false</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>false</tt:AccessPolicyConfig>
              <tt:X.509Token>false</tt:X.509Token>
              <tt:SAMLToken>false</tt:SAMLToken>
              <tt:KerberosToken>false</tt:KerberosToken>
              <tt:RELToken>false</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>false</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>false</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>false</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.CAP.1_1_15.12" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>No response on GetServiceCapabilities</Name>
    <Description>
      GetServiceCapabilities(no response)
      GetCapabilities (Device)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 2 - Check that the DUT returned Device capabilities
          STEP PASSED

          STEP 3 - Get service capabilities
          Transmit done
          The HTTP request has exceeded the allotted timeout
          STEP FAILED

          TEST FAILED
        </TestSummary>
      </ExpectedResult>
    </Description>
    <!--Features.xml/Features01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>NoResponse</Response>
      <Code>Sender</Code>
      <Subcode>ActionNotSupported</Subcode>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>false</tt:IPFilter>
              <tt:ZeroConfiguration>false</tt:ZeroConfiguration>
              <tt:IPVersion6>false</tt:IPVersion6>
              <tt:DynDNS>false</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>false</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>false</tt:DiscoveryResolve>
              <tt:DiscoveryBye>false</tt:DiscoveryBye>
              <tt:RemoteDiscovery>false</tt:RemoteDiscovery>
              <tt:SystemBackup>false</tt:SystemBackup>
              <tt:SystemLogging>false</tt:SystemLogging>
              <tt:FirmwareUpgrade>false</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>false</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>false</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>false</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>false</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>false</tt:TLS1.1>
              <tt:TLS1.2>false</tt:TLS1.2>
              <tt:OnboardKeyGeneration>false</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>false</tt:AccessPolicyConfig>
              <tt:X.509Token>false</tt:X.509Token>
              <tt:SAMLToken>false</tt:SAMLToken>
              <tt:KerberosToken>false</tt:KerberosToken>
              <tt:RELToken>false</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>false</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>false</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>false</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.CAP.1_1_15.13" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>No response on GetCapabilities</Name>
    <Description>
      GetServiceCapabilities()
      GetCapabilities (Device, no response)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          The HTTP request has exceeded the allotted timeout
          STEP FAILED

          TEST FAILED
        </TestSummary>
      </ExpectedResult>
    </Description>
    <!--Features.xml/Feature01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>NoResponse</Response>
      <Code>Sender</Code>
      <Subcode>ActionNotSupported</Subcode>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Device>
            <tt:XAddr>http://CAMERA_IP/onvif/device_service</tt:XAddr>
            <tt:Network>
              <tt:IPFilter>false</tt:IPFilter>
              <tt:ZeroConfiguration>false</tt:ZeroConfiguration>
              <tt:IPVersion6>false</tt:IPVersion6>
              <tt:DynDNS>false</tt:DynDNS>
              <tt:Extension>
                <tt:Dot11Configuration>false</tt:Dot11Configuration>
              </tt:Extension>
            </tt:Network>
            <tt:System>
              <tt:DiscoveryResolve>false</tt:DiscoveryResolve>
              <tt:DiscoveryBye>false</tt:DiscoveryBye>
              <tt:RemoteDiscovery>false</tt:RemoteDiscovery>
              <tt:SystemBackup>false</tt:SystemBackup>
              <tt:SystemLogging>false</tt:SystemLogging>
              <tt:FirmwareUpgrade>false</tt:FirmwareUpgrade>
              <tt:SupportedVersions>
                <tt:Major>1</tt:Major>
                <tt:Minor>1</tt:Minor>
              </tt:SupportedVersions>
              <tt:Extension>
                <tt:HttpFirmwareUpgrade>false</tt:HttpFirmwareUpgrade>
                <tt:HttpSystemBackup>false</tt:HttpSystemBackup>
                <tt:HttpSystemLogging>false</tt:HttpSystemLogging>
                <tt:HttpSupportInformation>false</tt:HttpSupportInformation>
              </tt:Extension>
            </tt:System>
            <tt:IO>
              <tt:InputConnectors>0</tt:InputConnectors>
              <tt:RelayOutputs>0</tt:RelayOutputs>
            </tt:IO>
            <tt:Security>
              <tt:TLS1.1>false</tt:TLS1.1>
              <tt:TLS1.2>false</tt:TLS1.2>
              <tt:OnboardKeyGeneration>false</tt:OnboardKeyGeneration>
              <tt:AccessPolicyConfig>false</tt:AccessPolicyConfig>
              <tt:X.509Token>false</tt:X.509Token>
              <tt:SAMLToken>false</tt:SAMLToken>
              <tt:KerberosToken>false</tt:KerberosToken>
              <tt:RELToken>false</tt:RELToken>
              <tt:Extension>
                <tt:TLS1.0>false</tt:TLS1.0>
                <tt:Extension>
                  <tt:Dot1X>false</tt:Dot1X>
                  <tt:SupportedEAPMethod>1</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>2</tt:SupportedEAPMethod>
                  <tt:SupportedEAPMethod>3</tt:SupportedEAPMethod>
                  <tt:RemoteUserHandling>false</tt:RemoteUserHandling>
                </tt:Extension>
              </tt:Extension>
            </tt:Security>
          </tt:Device>
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.CAP.1_1_15.14" ONVIFTestID="1.1.15" Enabled="true">
    <TestName>CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY</TestName>
    <Name>No Device in GetCapabilities</Name>
    <Description>
      GetServiceCapabilities(all true)
      GetCapabilities (Device, no device in response)
      <ExpectedResult>
        <TestSummary>
          DEVICE-1-1-15 CAPABILITIES AND DEVICE SERVICE CAPABILITIES CONSISTENCY

          STEP 1 - Get capabilities
          Transmit done
          Receive done
          STEP PASSED

          STEP 2 - Check that the DUT returned Device capabilities
          Device field is empty
          STEP FAILED

          TEST FAILED

        </TestSummary>
      </ExpectedResult>

    </Description>
    <!--Features.xml/Feature01-->
    <!--Test-->
    <Step id ="1">
      <Command>Device10.GetServiceCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
        <DeviceServiceCapabilities xmlns:tds="http://www.onvif.org/ver10/device/wsdl">
          <tds:Network IPFilter="true" ZeroConfiguration="true" IPVersion6="true" DynDNS="true" Dot11Configuration="true" HostnameFromDHCP="true" NTP="0"/>
          <tds:Security TLS1.0="true" TLS1.1="true" TLS1.2="true" OnboardKeyGeneration="true" AccessPolicyConfig="true" Dot1X="true" RemoteUserHandling="true" X.509Token="true" SAMLToken="true" KerberosToken="true" UsernameToken="true" HttpDigest="true" RELToken="true" SupportedEAPMethods="1 2 3"/>
          <tds:System DiscoveryResolve="true" DiscoveryBye="true" RemoteDiscovery="true" SystemBackup="true" SystemLogging="true" FirmwareUpgrade="true" HttpFirmwareUpgrade="true" HttpSystemBackup="true" HttpSystemLogging="true" HttpSupportInformation="true"/>
        </DeviceServiceCapabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Device</Category>
      </RequestParameters>
      <ResponseParameters>
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
        </Capabilities>
      </ResponseParameters>
    </Step>
  </Test>
</TestSuit>

