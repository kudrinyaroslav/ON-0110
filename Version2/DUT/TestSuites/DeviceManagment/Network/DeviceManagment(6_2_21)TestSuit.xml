<?xml version="1.0" encoding="utf-8"?>
<TestSuit Name="Device Managment" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>6.2.21 NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</Name>
    <Description>
 
    </Description>
  </Parameters>
  <Test ID = "TC.DM.NET.6_2_21.01" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Correct response: one interface</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6 test
      when DUT return correct response (one interface).
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal
        Subcode: InvalidIPv6Address
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        STEP PASSED

        STEP 8 - Check that interface with token 'eth0' has not been changed
        STEP PASSED

        TEST PASSED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>
  
  <Test ID = "TC.DM.NET.6_2_21.02" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Bug 5661</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
        
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.NET.6_2_21.03" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Bug 5661</Name>
    <Description>
    </Description>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>false</tt:Enabled>
              <tt:Config>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>false</tt:Enabled>
              <tt:Config>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.04" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Fault for the first request</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface (fault)
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: ActionNotSupported
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.GetNetworkInterfaces() in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 534
        STEP FAILED

        TEST FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>ActionNotSupported</Subcode>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.NET.6_2_21.05" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Fault for the third request</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface
      SetNetworkInterface
      GetNetworkInterface(fault)
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal
        Subcode: InvalidIPv6Address
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: ActionNotSupported
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.GetNetworkInterfaces() in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 534
        STEP FAILED

        TEST FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>ActionNotSupported</Subcode>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.NET.6_2_21.06" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>No response for the first request</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface(no response)
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        The HTTP request has exceeded the allotted timeout
        STEP FAILED

        TEST FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>NoResponse</Response>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.07" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name> No Response for the second request</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface
      SetNetworkInterface (no response)
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        The HTTP request has exceeded the allotted timeout
        STEP FAILED

        TEST FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>NoResponse</Response>
      <ResponseParameters>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.08" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>NoResponse for the third request</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface
      SetNetworkInterface(fault)
      GetNetworkInteface (no response)
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal
        Subcode: InvalidIPv6Address
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        The HTTP request has exceeded the allotted timeout
        STEP FAILED

        TEST FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>NoResponse</Response>
      <ResponseParameters>

      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.09" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Correct response instead fault</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface
      SetNetworkInterface (Normal Response)
      GetNetworkInterface
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        "Sender/InvalidArgVal/InvalidIPv6Address" fault is expected, but no SOAP fault returned
        STEP FAILED

        TEST FAILED


      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.10" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Wrong fault(wrong Code\Subcode\Subcode1)</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface
      SetNetworkInterface (fault: Sender\InvalidArgVal\InvalidIPv4Val1)
      GetNetworkInterface
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal
        Subcode: InvalidIPv6Address1
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        WARNING: The SOAP FAULT returned from the DUT is not as expected: fault subcodes sequence is incorrect. Expected: env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address, actual: env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address1
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        STEP PASSED

        STEP 8 - Check that interface with token 'eth0' has not been changed
        STEP PASSED

        TEST PASSED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address1</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.NET.6_2_21.11" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Wrong fault (Code\Subcode1\Subcode)</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface
      SetNetworkInterface(fault: Sender\InvalidArgVal1\InvalidIPv4Val)
      GetNetworkInterface
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal1
        Subcode: InvalidIPv6Address
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        WARNING: The SOAP FAULT returned from the DUT is not as expected: fault subcodes sequence is incorrect. Expected: env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address, actual: env:Sender/ter:InvalidArgVal1/ter:InvalidIPv6Address
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        STEP PASSED

        STEP 8 - Check that interface with token 'eth0' has not been changed
        STEP PASSED

        TEST PASSED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal1</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.12" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Wrong fault (Reciever)</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      when DUT return correct response (one interface).
      GetNetworkInterface
      SetNetworkInterface(fault is Reciever\InvalidArgVal\InvalidIPv4Address)
      GetNetworkInterface
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Receiver
        Subcode: InvalidArgVal
        Subcode: InvalidIPv6Address
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        WARNING: The SOAP FAULT returned from the DUT is not as expected: fault subcodes sequence is incorrect. Expected: env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address, actual: env:Receiver/ter:InvalidArgVal/ter:InvalidIPv6Address
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        STEP PASSED

        STEP 8 - Check that interface with token 'eth0' has not been changed
        STEP PASSED

        TEST PASSED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Resiever</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>EE02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.13" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Wrong fault (Code\Subcode)</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      when DUT return correct response (one interface).
      GetNetworkInterface
      SetNetworkInterface (fault: Sender\InvalidArgVal)
      GetNetworkInterface
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        WARNING: The SOAP FAULT returned from the DUT is not as expected: fault subcodes sequence is incorrect. Expected: env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address, actual: env:Sender/ter:InvalidArgVal
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        STEP PASSED

        STEP 8 - Check that interface with token 'eth0' has not been changed
        STEP PASSED

        TEST PASSED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.14" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Wrong fault (Code)</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      when DUT return correct response (one interface).
      GetNetworkInterface
      SetNetwork Interface (fault: Sender, without subcode)
      GetNetworkInterface
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        WARNING: The SOAP FAULT returned from the DUT is not as expected: fault subcodes sequence is incorrect. Expected: env:Sender/ter:InvalidArgVal/ter:InvalidIPv6Address, actual: env:Sender
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        STEP PASSED

        STEP 8 - Check that interface with token 'eth0' has not been changed
        STEP PASSED

        TEST PASSED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.15" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Ip6Address value is changed after step2 </Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      GetNetworkInterface (192.168.10.202)
      SetNetworkInterface (10.1.1)
      GetNetworkInterface (192.168.10.202)
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal
        Subcode: InvalidIPv6Address
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        STEP PASSED

        STEP 8 - Check that interface with token 'eth0' has not been changed
        Invalid IP address FF02:1 is present in the interface configuration
        Interface has been changed
        STEP FAILED

        TEST FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>false</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:C</tt:HwAddress>
              <tt:MTU>150</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>false</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>10.1.1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>FF02:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.16" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>Correct response: several interfaces</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      when DUT return correct response (several interface).
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal
        Subcode: InvalidIPv6Address
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        STEP PASSED

        STEP 8 - Check that interface with token 'eth0' has not been changed
        STEP PASSED

        TEST PASSED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
          <NetworkInterface token="eth1" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>true</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>


  <Test ID = "TC.DM.NET.6_2_21.17" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>There is no interface with Ipv6</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      when DUT return correct response (one interface).
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        No appropriate interface found
        STEP FAILED

        TEST FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>

  <Test ID = "TC.DM.NET.6_2_21.18" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>There is no eth0 interfase in the response for third request </Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      when DUT return correct response (one interface).
    </Description>
    <ExpectedResult>
      <TestSummary>
        DEVICE-2-1-21 SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6

        STEP 1 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 3 - Check that an interface with IPv6 configuration is presented
        STEP PASSED

        STEP 4 - Set Network Interfaces - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Subcode: InvalidArgVal
        Subcode: InvalidIPv6Address
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Device10.DeviceServiceFake.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 61
        at DUT.CameraWebService.Device10.DeviceServiceFake.SetNetworkInterfaces(String InterfaceToken, NetworkInterfaceSetConfiguration NetworkInterface) in D:\!ONVIF\DUT\Version2\DUT\CameraWebService\ServiceDevice10\DeviceServiceFake.asmx.cs:line 550
        STEP PASSED

        STEP 5 - Get network interfaces
        Transmit done
        Receive done
        STEP PASSED

        STEP 6 - Check that the DUT returned current interfaces
        STEP PASSED

        STEP 7 - Check if an interface with token = 'eth0' is presented
        Interfaces with token = 'eth0' not found
        STEP FAILED

        TEST FAILED

      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv6Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv6>
            <Enabled>false</Enabled>
            <Manual>
              <Address>FF02:1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv6>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth1" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:C</tt:HwAddress>
              <tt:MTU>150</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>false</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>10.1.1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.DM.NET.6_2_21.19" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>There is no Ipv6 in eth0 interface in the response for third request </Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV4 test
      when DUT return correct response (one interface).
    </Description>
    <ExpectedResult>
      <TestSummary>
        
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv4Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv4>
            <Enabled>false</Enabled>
            <Manual>
              <Address>10.1.1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv4>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:C</tt:HwAddress>
              <tt:MTU>150</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>


  <Test ID = "TC.DM.NET.6_2_21.20" ONVIFTestID="6.2.21" Enabled="true">
    <TestName>NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6</TestName>
    <Name>All IPv4 parameters are changed</Name>
    <Description>
      Check NVT SET NETWORK INTERFACE CONFIGURATION - INVALID IPV6 test
      when DUT return correct response (one interface).
    </Description>
    <ExpectedResult>
      <TestSummary>
        ??? is it correct response? There is no such items in Fail criteria from the Spec, but it is strange...
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:CB</tt:HwAddress>
              <tt:MTU>1500</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>192.168.10.202</tt:Address>
                  <tt:PrefixLength>16</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>true</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>2001:1:1:1:1:1:1:1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>SetNetworkInterfaces</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Subcode>InvalidArgVal</Subcode>
      <Subcode>InvalidIPv4Address</Subcode>
      <ResponseParameters>
        <NeedReboot>true</NeedReboot>
      </ResponseParameters>
      <RequestParameters>
        <InterfaceToken>eth0</InterfaceToken>
        <NetworkInterface>
          <IPv4>
            <Enabled>false</Enabled>
            <Manual>
              <Address>10.1.1</Address>
              <PrefixLength>0</PrefixLength>
            </Manual>
          </IPv4>
        </NetworkInterface>
      </RequestParameters>
    </Step>
    <Step id ="3">
      <Command>GetNetworkInterfaces</Command>
      <Response>Normal</Response>
      <ResponseParameters>
        <ArrayOfNetworkInterface>
          <NetworkInterface token="eth0" xmlns:tt="http://www.onvif.org/ver10/schema">
            <tt:Enabled>true</tt:Enabled>
            <tt:Info>
              <tt:Name>eth0</tt:Name>
              <tt:HwAddress>00:40:8C:A6:81:C</tt:HwAddress>
              <tt:MTU>150</tt:MTU>
            </tt:Info>
            <tt:Link>
              <tt:AdminSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:AdminSettings>
              <tt:OperSettings>
                <tt:AutoNegotiation>true</tt:AutoNegotiation>
                <tt:Speed>100</tt:Speed>
                <tt:Duplex>Full</tt:Duplex>
              </tt:OperSettings>
              <tt:InterfaceType>6</tt:InterfaceType>
            </tt:Link>
            <tt:IPv4>
              <tt:Enabled>false</tt:Enabled>
              <tt:Config>
                <tt:Manual>
                  <tt:Address>10.1</tt:Address>
                  <tt:PrefixLength>0</tt:PrefixLength>
                </tt:Manual>
                <tt:DHCP>false</tt:DHCP>
              </tt:Config>
            </tt:IPv4>
            <tt:IPv6>
              <tt:Enabled>false</tt:Enabled>
              <tt:Config>
                <tt:AcceptRouterAdvert>true</tt:AcceptRouterAdvert>
                <tt:DHCP>Auto</tt:DHCP>
                <tt:Manual>
                  <tt:Address>FF02:1:99</tt:Address>
                  <tt:PrefixLength>2</tt:PrefixLength>
                </tt:Manual>
                <tt:LinkLocal>
                  <tt:Address>fe80::240:8cff:fea6:81cb</tt:Address>
                  <tt:PrefixLength>64</tt:PrefixLength>
                </tt:LinkLocal>
              </tt:Config>
            </tt:IPv6>
          </NetworkInterface>
        </ArrayOfNetworkInterface>
      </ResponseParameters>
    </Step>
  </Test>
</TestSuit>
