<?xml version="1.0" encoding="utf-8"?>
<TestSuit Name="Device Managment" Version="0.1">
  <Parameters>
    <TimeOut>100000</TimeOut>
    <Name>EVENT-2-1-19 BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER</Name>
    <Description>
    </Description>
  </Parameters>
  <Test ID = "TC.EVENT-2-1-19.01" ONVIFTestID="EVENT-2-1-19" Enabled="true">
    <TestName>BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER</TestName>
    <Name>Response: empty TopicSet</Name>
    <Description>
      DUT return response: empty TopicSet.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
        EVENT-2-1-19 BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER

        STEP 1 - Get Event service address
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Get Event Properties
        Transmit done
        Receive done
        STEP PASSED

        STEP 3 - Check that TopicSet is not empty
        STEP PASSED

        TEST PASSED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://localhost:1305/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>false</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType xmlns:tns1="http://www.onvif.org/ver10/topics"
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1">
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.EVENT-2-1-19.02" ONVIFTestID="EVENT-2-1-19" Enabled="true">
    <TestName>BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER</TestName>
    <Name>Correct response: InvalidFilterFault</Name>
    <Description>
      DUT return Correct response: InvalidFilterFault.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
        EVENT-2-1-19 BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER

        STEP 1 - Get Event service address
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Get Event Properties
        Transmit done
        Receive done
        STEP PASSED

        STEP 3 - Check if a filter has been created
        STEP PASSED

        STEP 4 - Subscribe - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Events10.EventService.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\ONVIF\DUT\CameraWebService\ServiceEvents10\EventService.asmx.cs:line 101
        at DUT.CameraWebService.Events10.EventService.Subscribe(Subscribe Subscribe1) in D:\ONVIF\DUT\CameraWebService\ServiceEvents10\EventService.asmx.cs:line 320
        Validate fault...
        STEP PASSED

        TEST PASSED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://localhost:1305/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>false</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType xmlns:tns1="http://www.onvif.org/ver10/topics"
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1">
          <tns1:VideoSource wstop:topic="true">
            <tnsaxis:Tampering wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="channel" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="tampering" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:Tampering>
          </tns1:VideoSource>
          <tns1:Device wstop:topic="true">
            <tnsaxis:IO wstop:topic="true">
              <VirtualPort wstop:topic="true">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItem Name="port" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItem Name="state" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Data>
                </tt:MessageDescription>
              </VirtualPort>
              <Port wstop:topic="true">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItem Name="port" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItem Name="state" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Data>
                </tt:MessageDescription>
              </Port>
            </tnsaxis:IO>
          </tns1:Device>
          <tns1:VideoAnalytics wstop:topic="true">
            <tnsaxis:MotionDetection wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="window" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="motion" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:MotionDetection>
          </tns1:VideoAnalytics>
          <tns1:AudioSource wstop:topic="true">
            <tnsaxis:TriggerLevel wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="channel" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="triggered" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:TriggerLevel>
          </tns1:AudioSource>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="3">
      <Command>Subscribe</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Details InvalidFilterFaultTimestamp="now">
        <soap:Detail xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
          <InvalidFilterFault xmlns="http://docs.oasis-open.org/wsn/b-2">
            <Timestamp xmlns="http://docs.oasis-open.org/wsrf/bf-2">1900-01-01T01:01:01+03:00</Timestamp>
            <Originator xmlns="http://docs.oasis-open.org/wsrf/bf-2">
              <Address xmlns="http://www.w3.org/2005/08/addressing">http://uri1</Address>
              <ReferenceParameters xmlns="http://www.w3.org/2005/08/addressing" />
              <Metadata xmlns="http://www.w3.org/2005/08/addressing" />
            </Originator>
            <ErrorCode  dialect="http://uri1" xmlns="http://docs.oasis-open.org/wsrf/bf-2" />
            <Description xml:lang="en" xmlns="http://docs.oasis-open.org/wsrf/bf-2">Description1</Description>
            <Description xml:lang="en" xmlns="http://docs.oasis-open.org/wsrf/bf-2">Description2</Description>
            <Description xml:lang="fr" xmlns="http://docs.oasis-open.org/wsrf/bf-2">Description3</Description>
            <UnknownFilter>qname1</UnknownFilter>
            <UnknownFilter>qname2</UnknownFilter>
            <UnknownFilter>qname3</UnknownFilter>
          </InvalidFilterFault>
        </soap:Detail>
      </Details>
      <RequestParameters>
        <InitialTerminationTime>PT10S</InitialTerminationTime>
        <Address ignore ="1">http://192.168.10.66/onvif_notify_server</Address>
        <Filter nocomp="true">
          <![CDATA[<wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.axis.com/2009/event/topics">tns1:Tampering</wsnt:TopicExpression><wsnt:MessageContent Dialect="http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/schema">boolean(//tns1:SimpleItem[@Name="xyz" and @Value="xyz"] )</wsnt:MessageContent>]]>
        </Filter>
      </RequestParameters>
    </Step>
  </Test>
  <Test ID = "TC.EVENT-2-1-19.03" ONVIFTestID="EVENT-2-1-19" Enabled="true">
    <TestName>BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER</TestName>
    <Name>Correct response: InvalidMessageContentExpressionFault</Name>
    <Description>
      DUT return Correct response: InvalidMessageContentExpressionFault.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>PASSED</ONVIFTestResult>
      <TestSummary>
        EVENT-2-1-19 BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER

        STEP 1 - Get Event service address
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Get Event Properties
        Transmit done
        Receive done
        STEP PASSED

        STEP 3 - Check if a filter has been created
        STEP PASSED

        STEP 4 - Subscribe - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Events10.EventService.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\ONVIF\DUT\CameraWebService\ServiceEvents10\EventService.asmx.cs:line 101
        at DUT.CameraWebService.Events10.EventService.Subscribe(Subscribe Subscribe1) in D:\ONVIF\DUT\CameraWebService\ServiceEvents10\EventService.asmx.cs:line 320
        Validate fault...
        STEP PASSED

        TEST PASSED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://localhost:1305/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>false</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType xmlns:tns1="http://www.onvif.org/ver10/topics"
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1">
          <tns1:VideoSource wstop:topic="true">
            <tnsaxis:Tampering wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="channel" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="tampering" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:Tampering>
          </tns1:VideoSource>
          <tns1:Device wstop:topic="true">
            <tnsaxis:IO wstop:topic="true">
              <VirtualPort wstop:topic="true">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItem Name="port" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItem Name="state" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Data>
                </tt:MessageDescription>
              </VirtualPort>
              <Port wstop:topic="true">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItem Name="port" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItem Name="state" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Data>
                </tt:MessageDescription>
              </Port>
            </tnsaxis:IO>
          </tns1:Device>
          <tns1:VideoAnalytics wstop:topic="true">
            <tnsaxis:MotionDetection wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="window" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="motion" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:MotionDetection>
          </tns1:VideoAnalytics>
          <tns1:AudioSource wstop:topic="true">
            <tnsaxis:TriggerLevel wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="channel" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="triggered" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:TriggerLevel>
          </tns1:AudioSource>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="3">
      <Command>Subscribe</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <Details InvalidMessageContentExpressionFaultTimestamp="now">
        <soap:Detail xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
          <InvalidMessageContentExpressionFault p1:any_Attr="anySimpleType" xmlns:p1="otherNS" xmlns="http://docs.oasis-open.org/wsn/b-2">
            <Timestamp xmlns="http://docs.oasis-open.org/wsrf/bf-2">1900-01-01T01:01:01+03:00</Timestamp>
            <Originator p1:any_Attr="anySimpleType" xmlns="http://docs.oasis-open.org/wsrf/bf-2">
              <Address p1:any_Attr="anySimpleType" xmlns="http://www.w3.org/2005/08/addressing">http://uri1</Address>
              <ReferenceParameters p1:any_Attr="anySimpleType" xmlns="http://www.w3.org/2005/08/addressing" />
              <Metadata p1:any_Attr="anySimpleType" xmlns="http://www.w3.org/2005/08/addressing" />
            </Originator>
            <ErrorCode p3:any_Attr="anySimpleType" dialect="http://uri1" xmlns:p3="http://docs.oasis-open.org/wsn/b-2" xmlns="http://docs.oasis-open.org/wsrf/bf-2" />
            <Description xml:lang="en" xmlns="http://docs.oasis-open.org/wsrf/bf-2">Description1</Description>
            <Description xml:lang="en" xmlns="http://docs.oasis-open.org/wsrf/bf-2">Description2</Description>
            <Description xml:lang="fr" xmlns="http://docs.oasis-open.org/wsrf/bf-2">Description3</Description>
            <FaultCause xmlns="http://docs.oasis-open.org/wsrf/bf-2">
              <p1:any_element>anyType</p1:any_element>
            </FaultCause>
          </InvalidMessageContentExpressionFault>
        </soap:Detail>
      </Details>
      <RequestParameters>
        <InitialTerminationTime>PT10S</InitialTerminationTime>
        <Address ignore="1">http://192.168.10.66/onvif_notify_server</Address>
        <Filter nocomp="true">
          <![CDATA[<wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.axis.com/2009/event/topics">tns1:Tampering</wsnt:TopicExpression><wsnt:MessageContent Dialect="http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/schema">boolean(//tns1:SimpleItem[@Name="xyz" and @Value="xyz"] )</wsnt:MessageContent>]]>
        </Filter>
      </RequestParameters>
    </Step>
  </Test>
  <Test ID = "TC.EVENT-2-1-19.04" ONVIFTestID="EVENT-2-1-19" Enabled="true">
    <TestName>BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER</TestName>
    <Name>Wrong fault: no details</Name>
    <Description>
      DUT return Wrong fault: no details.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
        EVENT-2-1-19 BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER

        STEP 1 - Get Event service address
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Get Event Properties
        Transmit done
        Receive done
        STEP PASSED

        STEP 3 - Check if a filter has been created
        STEP PASSED

        STEP 4 - Subscribe - negative test
        Transmit done
        Receive done
        SOAP fault returned
        Code: Sender
        Reason: System.Web.Services.Protocols.SoapException: MESSAGE
        at DUT.CameraWebService.Events10.EventService.StepTypeProcessing(StepType stepType, SoapException ex, Int32 timeOut) in D:\ONVIF\DUT\CameraWebService\ServiceEvents10\EventService.asmx.cs:line 101
        at DUT.CameraWebService.Events10.EventService.Subscribe(Subscribe Subscribe1) in D:\ONVIF\DUT\CameraWebService\ServiceEvents10\EventService.asmx.cs:line 320
        Validate fault...
        FaultException of unknown type!
        Invalid Action.Expected: http://www.w3.org/2005/08/addressing/soap/fault. Actual: .
        STEP FAILED

        TEST FAILED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://localhost:1305/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>false</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType xmlns:tns1="http://www.onvif.org/ver10/topics"
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1">
          <tns1:VideoSource wstop:topic="true">
            <tnsaxis:Tampering wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="channel" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="tampering" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:Tampering>
          </tns1:VideoSource>
          <tns1:Device wstop:topic="true">
            <tnsaxis:IO wstop:topic="true">
              <VirtualPort wstop:topic="true">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItem Name="port" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItem Name="state" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Data>
                </tt:MessageDescription>
              </VirtualPort>
              <Port wstop:topic="true">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItem Name="port" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItem Name="state" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Data>
                </tt:MessageDescription>
              </Port>
            </tnsaxis:IO>
          </tns1:Device>
          <tns1:VideoAnalytics wstop:topic="true">
            <tnsaxis:MotionDetection wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="window" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="motion" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:MotionDetection>
          </tns1:VideoAnalytics>
          <tns1:AudioSource wstop:topic="true">
            <tnsaxis:TriggerLevel wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="channel" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="triggered" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:TriggerLevel>
          </tns1:AudioSource>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="3">
      <Command>Subscribe</Command>
      <Response>Fault</Response>
      <Code>Sender</Code>
      <RequestParameters>
        <InitialTerminationTime>PT10S</InitialTerminationTime>
        <Address ignore="1">http://192.168.10.66/onvif_notify_server</Address>
        <Filter nocomp="true">
          <![CDATA[<wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.axis.com/2009/event/topics">tns1:Tampering</wsnt:TopicExpression><wsnt:MessageContent Dialect="http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/schema">boolean(//tns1:SimpleItem[@Name="xyz" and @Value="xyz"] )</wsnt:MessageContent>]]>
        </Filter>
      </RequestParameters>
    </Step>
  </Test>
  <Test ID = "TC.EVENT-2-1-19.05" ONVIFTestID="EVENT-2-1-19" Enabled="true">
    <TestName>BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER</TestName>
    <Name>Normal response instead of fault</Name>
    <Description>
      DUT return Normal response instead of fault.
    </Description>
    <ExpectedResult>
      <ONVIFTestResult>FAILED</ONVIFTestResult>
      <TestSummary>
        EVENT-2-1-19 BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER

        STEP 1 - Get Event service address
        Transmit done
        Receive done
        STEP PASSED

        STEP 2 - Get Event Properties
        Transmit done
        Receive done
        STEP PASSED

        STEP 3 - Check if a filter has been created
        STEP PASSED

        STEP 4 - Subscribe - negative test
        Transmit done
        Receive done
        No SOAP fault received.
        STEP FAILED

        STEP 5 - Delete Subscription Manager
        Send unsubscribe request
        Transmit done
        Receive done
        STEP PASSED

        TEST FAILED
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://localhost:1305/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>false</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType xmlns:tns1="http://www.onvif.org/ver10/topics"
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1">
          <tns1:VideoSource wstop:topic="true">
            <tnsaxis:Tampering wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="channel" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="tampering" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:Tampering>
          </tns1:VideoSource>
          <tns1:Device wstop:topic="true">
            <tnsaxis:IO wstop:topic="true">
              <VirtualPort wstop:topic="true">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItem Name="port" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItem Name="state" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Data>
                </tt:MessageDescription>
              </VirtualPort>
              <Port wstop:topic="true">
                <tt:MessageDescription>
                  <tt:Source>
                    <tt:SimpleItem Name="port" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Source>
                  <tt:Data>
                    <tt:SimpleItem Name="state" Type="xsd:int">
                    </tt:SimpleItem>
                  </tt:Data>
                </tt:MessageDescription>
              </Port>
            </tnsaxis:IO>
          </tns1:Device>
          <tns1:VideoAnalytics wstop:topic="true">
            <tnsaxis:MotionDetection wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="window" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="motion" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:MotionDetection>
          </tns1:VideoAnalytics>
          <tns1:AudioSource wstop:topic="true">
            <tnsaxis:TriggerLevel wstop:topic="true">
              <tt:MessageDescription>
                <tt:Source>
                  <tt:SimpleItem Name="channel" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Source>
                <tt:Data>
                  <tt:SimpleItem Name="triggered" Type="xsd:int">
                  </tt:SimpleItem>
                </tt:Data>
              </tt:MessageDescription>
            </tnsaxis:TriggerLevel>
          </tns1:AudioSource>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
    <Step id ="3">
      <Command>Subscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <InitialTerminationTime>PT10S</InitialTerminationTime>
        <Address ignore="1">http://192.168.10.66/onvif_notify_server</Address>
        <Filter nocomp="true">
          <![CDATA[<wsnt:TopicExpression Dialect="http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.axis.com/2009/event/topics">tns1:Tampering</wsnt:TopicExpression><wsnt:MessageContent Dialect="http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter" xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:tns1="http://www.onvif.org/ver10/schema">boolean(//tns1:SimpleItem[@Name="xyz" and @Value="xyz"] )</wsnt:MessageContent>]]>
        </Filter>
      </RequestParameters>
      <ResponseParameters special="1">
        <SubscribeResponse xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2" xmlns:wsa5="http://www.w3.org/2005/08/addressing" >
          <wsnt:SubscriptionReference>
            <wsa5:Address>http://192.168.10.209/Web_Service?Idx=0</wsa5:Address>
          </wsnt:SubscriptionReference>
          <wsnt:CurrentTime>2010-09-07T13:32:51</wsnt:CurrentTime>
          <wsnt:TerminationTime>2010-09-07T13:33:01</wsnt:TerminationTime>
        </SubscribeResponse>
      </ResponseParameters>
      <ResponseParametersAdditional>
        <CurrentTime type="now"></CurrentTime>
        <TerminationTime differance="true">10</TerminationTime>
      </ResponseParametersAdditional>
    </Step>
    <Step id ="4">
      <Command>SMSUnsubscribe</Command>
      <Response>Normal</Response>
      <RequestParameters>
      </RequestParameters>
      <ResponseParameters>
      </ResponseParameters>
    </Step>
  </Test>
  <Test ID = "TC.EVENT-2-1-19.06" ONVIFTestID="EVENT-2-1-19" Enabled="true">
    <TestName>BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER</TestName>
    <Name>Bug 5642</Name>
    <Description>
    </Description>
    <ExpectedResult>
      <TestSummary>
        <![CDATA[
        EVENT-2-1-19 BASIC NOTIFICATION INTERFACE - INVALID MESSAGE CONTENT FILTER

   STEP 1 - Get Event service address
      Transmit done
      Receive done
   STEP PASSED

   STEP 2 - Get Event Properties
      Transmit done
      Receive done
   STEP PASSED

   STEP 3 - Check if a filter has been created
   STEP PASSED

   STEP 4 - Subscribe - negative test
      Transmit done
      Receive done
      SOAP fault returned
      Code: Receiver
      Reason: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.NullReferenceException: Object reference not set to an instance of an object.
         at DUT.CameraWebService.CommonCompare.StringCompare(String requestXPath, String TargetName, String TargetString, String& logMessage, Boolean& passed, XmlNode test) in D:\PROJECTS\ONVIF4\Sources\ON-0110\Version2\DUT\CameraWebService\CommonCompare.cs:line 15
         at DUT.CameraWebService.Events10.EventServiceTest.SubscribeTest(SubscribeResponse& target, SoapException& ex, Int32& timeOut, Subscribe Subscribe1) in D:\PROJECTS\ONVIF4\Sources\ON-0110\Version2\DUT\CameraWebService\ServiceEvents10\EventServiceTest.cs:line 614
         at DUT.CameraWebService.Events10.EventService.Subscribe(Subscribe Subscribe1) in D:\PROJECTS\ONVIF4\Sources\ON-0110\Version2\DUT\CameraWebService\ServiceEvents10\EventService.asmx.cs:line 286
         --- End of inner exception stack trace ---
      Validate fault...
      Warning: Fault received is neither  FaultException<InvalidFilterFaultType> nor FaultException<InvalidMessageContentExpressionFaultType>
   STEP PASSED

TEST PASSED
        ]]>
      </TestSummary>
    </ExpectedResult>
    <Step id ="1">
      <Command>Device10.GetCapabilities</Command>
      <Response>Normal</Response>
      <RequestParameters>
        <Category>Events</Category>
      </RequestParameters>
      <ResponseParameters special="1">
        <Capabilities xmlns:tt="http://www.onvif.org/ver10/schema">
          <tt:Events>
            <tt:XAddr>http://localhost:1305/EventService.asmx</tt:XAddr>
            <tt:WSSubscriptionPolicySupport>false</tt:WSSubscriptionPolicySupport>
            <tt:WSPullPointSupport>false</tt:WSPullPointSupport>
            <tt:WSPausableSubscriptionManagerInterfaceSupport>false</tt:WSPausableSubscriptionManagerInterfaceSupport>
          </tt:Events>
        </Capabilities>
      </ResponseParameters>
    </Step>
    <Step id ="2">
      <Command>GetEventProperties</Command>
      <Response>Normal</Response>
      <ResponseParameters name="TopicNamespaceLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/topics/topicns.xml</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="FixedTopicSet">
        <boolean>true</boolean>
      </ResponseParameters>
      <ResponseParameters name="TopicSet">
        <TopicSetType xmlns:tns1="http://www.onvif.org/ver10/topics"
                      xmlns:tnsaxis="http://www.axis.com/2009/event/topics"
                      xmlns:tt="http://www.onvif.org/ver10/schema"
                      xmlns:wstop="http://docs.oasis-open.org/wsn/t-1">
          <tns1:UserAlarm>
            <Sensor>
              <Input>
                <AlarmOn wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="Sensor">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                  </tt:MessageDescription>
                </AlarmOn>
                <AlarmOff wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="Sensor">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                  </tt:MessageDescription>
                </AlarmOff>
              </Input>
            </Sensor>
            <Detection>
              <Video>
                <Motion>
                  <AlarmOn wstop:topic="true">
                    <tt:MessageDescription IsProperty="false">
                      <tt:Source>
                        <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                        </tt:SimpleItemDescription>
                        <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="DetectionWindow">
                        </tt:SimpleItemDescription>
                      </tt:Source>
                    </tt:MessageDescription>
                  </AlarmOn>
                  <AlarmOff wstop:topic="true">
                    <tt:MessageDescription IsProperty="false">
                      <tt:Source>
                        <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                        </tt:SimpleItemDescription>
                        <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="DetectionWindow">
                        </tt:SimpleItemDescription>
                      </tt:Source>
                    </tt:MessageDescription>
                  </AlarmOff>
                  <Filter>
                    <AlarmOn wstop:topic="true">
                      <tt:MessageDescription IsProperty="false">
                        <tt:Source>
                          <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                          </tt:SimpleItemDescription>
                        </tt:Source>
                      </tt:MessageDescription>
                    </AlarmOn>
                    <AlarmOff wstop:topic="true">
                      <tt:MessageDescription IsProperty="false">
                        <tt:Source>
                          <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                          </tt:SimpleItemDescription>
                        </tt:Source>
                      </tt:MessageDescription>
                    </AlarmOff>
                  </Filter>
                </Motion>
              </Video>
              <Tampering>
                <AlarmOn wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                  </tt:MessageDescription>
                </AlarmOn>
                <AlarmOff wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                  </tt:MessageDescription>
                </AlarmOff>
              </Tampering>
            </Detection>
            <Failure>
              <Imaging>
                <NoVideo wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                  </tt:MessageDescription>
                </NoVideo>
              </Imaging>
              <Authentication>
                <UsernameToken wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="xs:QName" Name="Command">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                    <tt:Data>
                      <tt:SimpleItemDescription Type="xs:string" Name="Username">
                      </tt:SimpleItemDescription>
                    </tt:Data>
                  </tt:MessageDescription>
                </UsernameToken>
              </Authentication>
              <Media>
                <ActionFail wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="xs:string" Name="Command">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                    <tt:Data>
                      <tt:SimpleItemDescription Type="xs:string" Name="ErrorType">
                      </tt:SimpleItemDescription>
                    </tt:Data>
                  </tt:MessageDescription>
                </ActionFail>
              </Media>
              <Streaming>
                <Session>
                  <Disconnected>
                    <Timeout wstop:topic="true">
                      <tt:MessageDescription IsProperty="false">
                        <tt:Source>
                          <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="ProfileToken">
                          </tt:SimpleItemDescription>
                          <tt:SimpleItemDescription Type="xs:string" Name="Session">
                          </tt:SimpleItemDescription>
                        </tt:Source>
                      </tt:MessageDescription>
                    </Timeout>
                  </Disconnected>
                </Session>
              </Streaming>
            </Failure>
            <ModeChange>
              <DayNight>
                <On wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                  </tt:MessageDescription>
                </On>
                <Off wstop:topic="true">
                  <tt:MessageDescription IsProperty="false">
                    <tt:Source>
                      <tt:SimpleItemDescription Type="tt:ReferenceToken" Name="VideoSourceConfigurationToken">
                      </tt:SimpleItemDescription>
                    </tt:Source>
                  </tt:MessageDescription>
                </Off>
              </DayNight>
            </ModeChange>
          </tns1:UserAlarm>
        </TopicSetType>
      </ResponseParameters>
      <ResponseParameters name="TopicExpressionDialect">
        <ArrayOfString>
          <string>http://docs.oasis-open.org/wsn/t-1/TopicExpression/Concrete</string>
          <string>http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentFilterDialect">
        <ArrayOfString>
          <string>http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter</string>
        </ArrayOfString>
      </ResponseParameters>
      <ResponseParameters name="MessageContentSchemaLocation">
        <ArrayOfString>
          <string>http://www.onvif.org/onvif/ver10/schema/onvif.xsd</string>
        </ArrayOfString>
      </ResponseParameters>
    </Step>
  </Test>
</TestSuit>
